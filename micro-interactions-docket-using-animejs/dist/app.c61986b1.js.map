{"version":3,"sources":["../node_modules/xstate/es/_virtual/_tslib.js","../node_modules/xstate/es/constants.js","../node_modules/xstate/es/environment.js","../node_modules/xstate/es/utils.js","../node_modules/xstate/es/mapState.js","../node_modules/xstate/es/types.js","../node_modules/xstate/es/actionTypes.js","../node_modules/xstate/es/actions.js","../node_modules/xstate/es/stateUtils.js","../node_modules/xstate/es/State.js","../node_modules/xstate/es/serviceScope.js","../node_modules/xstate/es/Actor.js","../node_modules/xstate/es/invokeUtils.js","../node_modules/xstate/es/StateNode.js","../node_modules/xstate/es/Machine.js","../node_modules/xstate/es/scheduler.js","../node_modules/xstate/es/registry.js","../node_modules/xstate/es/devTools.js","../node_modules/xstate/es/behaviors.js","../node_modules/xstate/es/interpreter.js","../node_modules/xstate/es/match.js","../node_modules/xstate/es/schema.js","../node_modules/xstate/es/index.js","scripts/state.ts","../node_modules/animejs/lib/anime.es.js","app.ts","../node_modules/parcel-bundler/src/builtins/hmr-runtime.js"],"names":["__assign","Object","assign","t","s","i","n","arguments","length","p","prototype","hasOwnProperty","call","apply","__rest","e","indexOf","getOwnPropertySymbols","propertyIsEnumerable","__values","o","Symbol","iterator","m","next","value","done","TypeError","__read","r","ar","push","error","__spreadArray","to","from","il","j","STATE_DELIMITER","EMPTY_ACTIVITY_MAP","DEFAULT_GUARD_TYPE","TARGETLESS_KEY","IS_PRODUCTION","keys","matchesState","parentStateId","childStateId","delimiter","parentStateValue","toStateValue","childStateValue","isString","every","key","getEventType","event","type","Error","toStatePath","stateId","isArray","toString","split","isStateLike","state","stateValue","pathToStateValue","statePath","marker","mapValues","collection","iteratee","result","collectionKeys","mapFilterValues","predicate","e_1","_a","_b","_c","item","e_1_1","return","path","props","object","e_2","props_1","props_1_1","prop","e_2_1","nestedPath","accessorProp","e_3","props_2","props_2_1","e_3_1","toStatePaths","flatten","map","subStateValue","subPath","concat","array","toArrayStrict","toArray","undefined","mapContext","mapper","context","_event","e_5","isFunction","data","subMapper","e_5_1","isBuiltInEvent","eventType","test","isPromiseLike","Promise","then","isBehavior","transition","partition","items","e_6","truthy","falsy","items_1","items_1_1","e_6_1","updateHistoryStates","hist","states","subHist","current","updateHistoryValue","updateContext","assignActions","warn","updatedContext","reduce","acc","assignAction","e_7","assignment","meta","action","partialUpdate","propAssignment","e_7_1","condition","message","console","args","Array","toGuard","guardMap","name","isObservable","subscribe","symbolObservable","observable","isMachine","isActor","send","uniqueId","currentId","toEventObject","payload","toSCXMLEvent","scxmlEvent","$$type","eventObject","toTransitionConfigArray","configLike","transitions","transitionLike","target","normalizeTarget","reportUnhandledExceptionOnInvocation","originalError","currentError","id","originalStackTrace","stack","stackTrace","evaluateGuard","machine","guard","guards","options","guardMeta","cond","condFn","toInvokeSource","src","toObserver","nextHandler","errorHandler","completionHandler","noop","complete","mapState","stateMap","foundStateId","mappedStateId","ActionTypes","SpecialTargets","start","Start","stop","Stop","raise","Raise","Send","cancel","Cancel","nullEvent","NullEvent","Assign","after","After","doneState","DoneState","log","Log","init","Init","invoke","Invoke","errorExecution","ErrorExecution","errorPlatform","ErrorPlatform","ErrorCustom","update","Update","choose","Choose","pure","Pure","initEvent","getActionFunction","actionType","actionFunctionMap","toActionObject","actionObject","exec","toActionObjects","actions","subAction","toActivityDefinition","Internal","raise$1","resolveRaise","send$1","delay","resolveSend","ctx","delaysMap","resolvedEvent","resolvedDelay","configDelay","resolvedTarget","sendParent","Parent","sendUpdate","respond","_","__","origin","defaultLogExpr","expr","label","log$1","resolveLog","sendId","cancel$1","activity","activityDef","actorRef","resolveStop","actorRefOrString","resolvedActorRef","assign$1","delayRef","idSuffix","doneInvoke","DoneInvoke","getActions","get","forwardTo","escalate","errorData","error$1","conds","resolveActions","currentState","currentContext","preserveActionOrder","otherActions","preservedContexts","resolvedActions","sendAction","delays","choose$1","chooseAction","matchedActions","find","resolvedActionsFromChoose","resolvedContextFromChoose","pure$1","resolvedActionsFromPure","resolvedContext","stop$1","resolvedActionObject","exec_1","contextIndex_1","_ctx","_i","filter","a","isLeafNode","stateNode","getChildren","getAllStateNodes","stateNodes","getConfiguration","prevStateNodes","e_4","_d","prevConfiguration","Set","prevAdjList","getAdjList","configuration","configuration_1","configuration_1_1","parent","has","add","adjList","configuration_2","configuration_2_1","forEach","sn","initialStateNodes","_e","_f","child","configuration_3","configuration_3_1","e_4_1","getValueFromAdj","baseNode","childStateNodes","childStateNode","csn","Map","configuration_4","configuration_4_1","set","getValue","rootNode","config","iterable","some","member","nextEvents","ownEvents","isInFinalState","getMeta","stateValuesEqual","b","aKeys","bKeys","isState","bindActionToState","boundAction","State","_this","activities","events","_sessionid","historyValue","history","matches","bind","toStrings","children","tags","defineProperty","create","inert","valueKeys","toJSON","jsonValues","hasTag","tag","can","changed","serviceStack","provide","service","fn","pop","consume","createNullActor","unsubscribe","getSnapshot","createInvocableActor","invokeDefinition","invokeSrc","serviceCreator","services","resolvedData","tempActor","createDeferredActor","entity","deferred","initialState_1","withContext","initialState","isSpawnedActor","toActorRef","actorRefLike","simpleSrc","toInvokeDefinition","invokeConfig","onDone","onError","invokeDef","NULL_EVENT","STATE_IDENTIFIER","WILDCARD","EMPTY_OBJECT","isStateId","str","createDefaultOptions","validateArrayifiedTransitions","hasNonLastUnguardedTarget","slice","eventText","StateNode","_context","order","__xstatenode","__cache","relativeValue","initialStateValue","on","candidates","delayedTransitions","idMap","_parent","_key","join","version","parallel","schema","initial","stateConfig","dfs","_transient","always","strict","onEntry","entry","onExit","exit","doneData","invokeSource","_init","withConfig","enumerable","configurable","definition","getDelayedTransitions","formatTransitions","getCandidates","eventName","transient","sameEventType","afterConfig","mutateEntryExit","configTransition","resolvedTransition","isNaN","delayedTransition","formatTransition","getStateNodes","getStateNode","subStateKeys","subStateNodes","subStateKey","allSubStateNodes","subStateNode","handles","includes","resolveState","resolve","transitionLeafNode","transitionCompoundNode","_transition","transitionParallelNode","transitionMap","stateTransitions","enabledTransitions","st","willTransition","entryNodes","entrySet","exitSet","source","nextStateNodes","selectedTransition","candidate","stateIn","in","isInState","getStateNodeById","guardPassed","err","allNextStateNodes","getRelativeStateNodes","isInternal","internal","reentryNodes","nodesFromChild","escapes","nodes","prevState","prevConfig","resolvedConfig","resolvedConfig_1","resolvedConfig_1_1","prevConfig_1","prevConfig_1_1","doneEvents","grandparent","parentNode","sort","entryStates","exitStates","entryActions","exitActions","resolvedStateValue","getResolvedPath","stateTransition","resolveTransition","resolveRaisedTransition","originalEvent","currentActions","unshift","actions_1","actions_1_1","start$1","raisedEvents","nonRaisedActions","invokeActions","resolvedConfiguration","isDone","nextState","didUpdateContext","isTransient","maybeNextState","raisedEvent","shift","stateKey","resolvedStateId","getStateNodeByPath","arrayStatePath","currentStateNode","stateIdentifier","getInitialState","historyConfig","relativeStateId","resolveHistory","initialStateNodePaths","initialPath","getFromRelativePath","relativePath","childStatePath","relativeStateValue","historyTarget","relativeChildPath","subHistoryValue","subStatePath","childStateIds","stateIds","e_8","event_1","e_8_1","resolveTarget","_target","isInternalTarget","targetStateNode","transitionConfig","normalizedTarget","e_9","onConfig","wildcardConfigs","strictTransitionConfigs_1","transitionConfigArray","eventlessConfig","doneConfig","String","settleTransitions","formattedTransitions","delayedTransitions_1","delayedTransitions_1_1","e_9_1","Machine","initialContext","createMachine","defaultOptions","deferEvents","Scheduler","processingEvent","queue","initialized","initialize","callback","schedule","process","flushEvents","task","clear","nextCallback","sessionIdIndex","registry","bookId","register","actor","free","delete","getGlobal","self","window","global","getDevTools","__xstate__","registerService","devTools","spawnBehavior","behavior","observers","mailbox","flushing","flush","actorCtx","observer","handleError","DEFAULT_SPAWN_OPTIONS","sync","autoForward","InterpreterStatus","Interpreter","scheduler","delayedEventsMap","listeners","contextListeners","stopListeners","doneListeners","eventListeners","sendListeners","status","NotStarted","batch","Stopped","JSON","stringify","Running","forward","_state","sendTo","isParent","sessionId","resolvedOptions","clock","logger","resolvedId","_initialState","execute","actionsConfig","listener","_g","_h","_j","_k","contextListener","finalChildStateNode","_l","_m","onTransition","nextListenerOrObserver","completeListener","resolvedCompleteListener","onEvent","onSend","onChange","onStop","off","resolvedState","attachDev","e_10","_o","e_11","e_11_1","_p","_q","clearTimeout","e_10_1","e_12","batchChanged","batchedActions","_loop_1","events_1","events_1_1","e_12_1","sender","nextEvent","e_13","e_13_1","defer","setTimeout","actionOrExec","spawn","spawnActivity","stopChild","removeChild","childId","spawnPromise","spawnCallback","spawnActor","spawnObservable","spawnMachine","childService","doneEvent","promise","canceled","response","errorEvent","unsubscribed","receivers","emitted","receive","callbackStop","newListener","receiver","subscription","implementation","dispose","spawnEffect","__REDUX_DEVTOOLS_EXTENSION__","devToolsOptions","connect","autoPause","stateSanitizer","features","jump","skip","ms","interpret","resolveSpawnOptions","nameOrOptions","isLazyEntity","interpreter","matchState","patterns","defaultValue","patterns_1","patterns_1_1","createSchema","defaultInstanceSettings","begin","loopBegin","changeBegin","change","changeComplete","loopComplete","loop","direction","autoplay","timelineOffset","defaultTweenSettings","duration","endDelay","easing","round","validTransforms","cache","CSS","springs","minMax","val","min","max","Math","stringContains","text","applyArguments","func","is","arr","obj","pth","svg","SVGElement","inp","HTMLInputElement","dom","nodeType","fnc","und","nil","hex","rgb","hsl","col","parseEasingParameters","string","match","parseFloat","spring","params","mass","stiffness","damping","velocity","w0","sqrt","zeta","wd","solver","progress","exp","cos","sin","getDuration","cached","frame","elapsed","rest","steps","ceil","bezier","kSplineTableSize","kSampleStepSize","A","aA1","aA2","B","C","calcBezier","aT","getSlope","binarySubdivide","aX","aA","aB","mX1","mX2","currentX","currentT","abs","newtonRaphsonIterate","aGuessT","currentSlope","mY1","mY2","sampleValues","Float32Array","getTForX","intervalStart","currentSample","lastSample","dist","guessForT","initialSlope","x","penner","eases","linear","functionEasings","Sine","PI","Circ","Back","Bounce","pow2","pow","Elastic","amplitude","period","asin","baseEasings","easeIn","parseEasings","ease","selectString","document","querySelectorAll","filterArray","len","thisArg","flattenArray","NodeList","HTMLCollection","arrayContains","cloneObject","clone","replaceObjectProps","o1","o2","mergeObjects","rgbToRgba","rgbValue","hexToRgba","hexValue","rgx","replace","g","parseInt","hslToRgba","hslValue","h","l","hue2rgb","q","colorToRgb","getUnit","getTransformUnit","propName","getFunctionValue","animatable","total","getAttribute","el","convertPxToUnit","unit","valueUnit","baseline","tempEl","createElement","tagName","parentEl","body","appendChild","style","position","width","factor","offsetWidth","convertedUnit","getCSSValue","uppercasePropName","toLowerCase","getComputedStyle","getPropertyValue","getAnimationType","getElementTransforms","transform","reg","transforms","getTransformValue","defaultVal","list","getOriginalTargetValue","getRelativeValue","operator","u","y","validateValue","originalUnit","unitLess","substr","getDistance","p1","p2","getCircleLength","getRectLength","getLineLength","getPolylineLength","points","totalLength","previousPos","numberOfItems","currentPos","getItem","getPolygonLength","getTotalLength","setDashoffset","pathLength","setAttribute","getParentSvgEl","getParentSvg","pathEl","svgData","parentSvgEl","rect","getBoundingClientRect","viewBoxAttr","height","viewBox","w","vW","vH","getPath","percent","property","getPathProgress","isPathTargetInsideSVG","point","offset","getPointAtLength","p0","scaleX","scaleY","atan2","decomposeValue","original","numbers","Number","strings","parseTargets","targets","targetsArray","pos","getAnimatables","parsed","normalizePropertyTweens","tweenSettings","settings","isFromTo","propArray","v","k","flattenKeyframes","keyframes","propertyNames","properties","newKey","getProperties","tweens","normalizeTweenValues","tween","normalizeTweens","previousTween","tweenValue","toUnit","originalValue","previousValue","fromUnit","end","isPath","isColor","setProgressValue","css","attribute","manual","last","setTargetsValue","animatables","animType","createAnimation","lastTween","getAnimations","getInstanceTimings","animations","animLength","getTlOffset","anim","timings","instanceID","createNewInstance","instanceSettings","activeInstances","engine","raf","play","isDocumentHidden","anime","suspendWhenDocumentHidden","requestAnimationFrame","step","activeInstancesLength","activeInstance","paused","tick","splice","handleVisibilityChange","cancelAnimationFrame","instance","_onDocumentVisibility","addEventListener","hidden","startTime","lastTime","now","childrenLength","makePromise","_resolve","finished","toggleInstanceDirection","reversed","adjustTime","time","resetTime","currentTime","speed","seekChild","seek","syncInstanceChildren","reversePlayback","i$1","setAnimationsProgress","insTime","animationsLength","tweenLength","eased","toNumbersLength","toNumber","fromNumber","stringsLength","n$1","currentValue","setCallback","cb","passThrough","countIteration","remaining","setInstanceProgress","engineTime","insDuration","insDelay","insEndDelay","began","loopBegan","changeBegan","changeCompleted","completed","reset","pause","reverse","restart","remove","removeTargetsFromInstance","removeTargetsFromAnimations","c","childAnimations","removeTargetsFromActiveInstances","stagger","grid","axis","fromIndex","fromFirst","fromCenter","fromLast","isRange","val1","val2","values","maxValue","index","fromX","fromY","floor","toX","toY","distanceX","distanceY","spacing","timeline","tl","instanceParams","tlIndex","ins","insParams","tlDuration","running","convertPx","random","OVERLAY_ID","OldModule","module","bundle","Module","moduleName","hot","hotData","_acceptCallbacks","_disposeCallbacks","accept","checkedAssets","assetsToAccept","isParcelRequire","WebSocket","hostname","location","protocol","ws","onmessage","parse","handled","assets","asset","isNew","didAccept","hmrAcceptCheck","parcelRequire","generated","js","hmrApply","hmrAcceptRun","reload","close","onclose","removeErrorOverlay","overlay","createErrorOverlay","getElementById","innerText","innerHTML","getParents","modules","parents","d","dep","Function","deps"],"mappings":"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","file":"app.c61986b1.js","sourceRoot":"../src","sourcesContent":["/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation.\r\n\r\nPermission to use, copy, modify, and/or distribute this software for any\r\npurpose with or without fee is hereby granted.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\r\nREGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\r\nAND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\r\nINDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\r\nLOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\r\nOTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\r\nPERFORMANCE OF THIS SOFTWARE.\r\n***************************************************************************** */\r\n\r\nvar __assign = function() {\r\n    __assign = Object.assign || function __assign(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\r\n        }\r\n        return t;\r\n    };\r\n    return __assign.apply(this, arguments);\r\n};\r\n\r\nfunction __rest(s, e) {\r\n    var t = {};\r\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\r\n        t[p] = s[p];\r\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\r\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\r\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\r\n                t[p[i]] = s[p[i]];\r\n        }\r\n    return t;\r\n}\r\n\r\nfunction __values(o) {\r\n    var s = typeof Symbol === \"function\" && Symbol.iterator, m = s && o[s], i = 0;\r\n    if (m) return m.call(o);\r\n    if (o && typeof o.length === \"number\") return {\r\n        next: function () {\r\n            if (o && i >= o.length) o = void 0;\r\n            return { value: o && o[i++], done: !o };\r\n        }\r\n    };\r\n    throw new TypeError(s ? \"Object is not iterable.\" : \"Symbol.iterator is not defined.\");\r\n}\r\n\r\nfunction __read(o, n) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\r\n    if (!m) return o;\r\n    var i = m.call(o), r, ar = [], e;\r\n    try {\r\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\r\n    }\r\n    catch (error) { e = { error: error }; }\r\n    finally {\r\n        try {\r\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\r\n        }\r\n        finally { if (e) throw e.error; }\r\n    }\r\n    return ar;\r\n}\r\n\r\nfunction __spreadArray(to, from) {\r\n    for (var i = 0, il = from.length, j = to.length; i < il; i++, j++)\r\n        to[j] = from[i];\r\n    return to;\r\n}\n\nexport { __assign, __read, __rest, __spreadArray, __values };\n","var STATE_DELIMITER = '.';\nvar EMPTY_ACTIVITY_MAP = {};\nvar DEFAULT_GUARD_TYPE = 'xstate.guard';\nvar TARGETLESS_KEY = '';\n\nexport { DEFAULT_GUARD_TYPE, EMPTY_ACTIVITY_MAP, STATE_DELIMITER, TARGETLESS_KEY };\n","var IS_PRODUCTION = process.env.NODE_ENV === 'production';\n\nexport { IS_PRODUCTION };\n","import { __spreadArray, __read, __values, __assign } from './_virtual/_tslib.js';\nimport { DEFAULT_GUARD_TYPE, TARGETLESS_KEY, STATE_DELIMITER } from './constants.js';\nimport { IS_PRODUCTION } from './environment.js';\n\nfunction keys(value) {\n  return Object.keys(value);\n}\nfunction matchesState(parentStateId, childStateId, delimiter) {\n  if (delimiter === void 0) {\n    delimiter = STATE_DELIMITER;\n  }\n\n  var parentStateValue = toStateValue(parentStateId, delimiter);\n  var childStateValue = toStateValue(childStateId, delimiter);\n\n  if (isString(childStateValue)) {\n    if (isString(parentStateValue)) {\n      return childStateValue === parentStateValue;\n    } // Parent more specific than child\n\n\n    return false;\n  }\n\n  if (isString(parentStateValue)) {\n    return parentStateValue in childStateValue;\n  }\n\n  return keys(parentStateValue).every(function (key) {\n    if (!(key in childStateValue)) {\n      return false;\n    }\n\n    return matchesState(parentStateValue[key], childStateValue[key]);\n  });\n}\nfunction getEventType(event) {\n  try {\n    return isString(event) || typeof event === 'number' ? \"\" + event : event.type;\n  } catch (e) {\n    throw new Error('Events must be strings or objects with a string event.type property.');\n  }\n}\nfunction toStatePath(stateId, delimiter) {\n  try {\n    if (isArray(stateId)) {\n      return stateId;\n    }\n\n    return stateId.toString().split(delimiter);\n  } catch (e) {\n    throw new Error(\"'\" + stateId + \"' is not a valid state path.\");\n  }\n}\nfunction isStateLike(state) {\n  return typeof state === 'object' && 'value' in state && 'context' in state && 'event' in state && '_event' in state;\n}\nfunction toStateValue(stateValue, delimiter) {\n  if (isStateLike(stateValue)) {\n    return stateValue.value;\n  }\n\n  if (isArray(stateValue)) {\n    return pathToStateValue(stateValue);\n  }\n\n  if (typeof stateValue !== 'string') {\n    return stateValue;\n  }\n\n  var statePath = toStatePath(stateValue, delimiter);\n  return pathToStateValue(statePath);\n}\nfunction pathToStateValue(statePath) {\n  if (statePath.length === 1) {\n    return statePath[0];\n  }\n\n  var value = {};\n  var marker = value;\n\n  for (var i = 0; i < statePath.length - 1; i++) {\n    if (i === statePath.length - 2) {\n      marker[statePath[i]] = statePath[i + 1];\n    } else {\n      marker[statePath[i]] = {};\n      marker = marker[statePath[i]];\n    }\n  }\n\n  return value;\n}\nfunction mapValues(collection, iteratee) {\n  var result = {};\n  var collectionKeys = keys(collection);\n\n  for (var i = 0; i < collectionKeys.length; i++) {\n    var key = collectionKeys[i];\n    result[key] = iteratee(collection[key], key, collection, i);\n  }\n\n  return result;\n}\nfunction mapFilterValues(collection, iteratee, predicate) {\n  var e_1, _a;\n\n  var result = {};\n\n  try {\n    for (var _b = __values(keys(collection)), _c = _b.next(); !_c.done; _c = _b.next()) {\n      var key = _c.value;\n      var item = collection[key];\n\n      if (!predicate(item)) {\n        continue;\n      }\n\n      result[key] = iteratee(item, key, collection);\n    }\n  } catch (e_1_1) {\n    e_1 = {\n      error: e_1_1\n    };\n  } finally {\n    try {\n      if (_c && !_c.done && (_a = _b.return)) _a.call(_b);\n    } finally {\n      if (e_1) throw e_1.error;\n    }\n  }\n\n  return result;\n}\n/**\r\n * Retrieves a value at the given path.\r\n * @param props The deep path to the prop of the desired value\r\n */\n\nvar path = function (props) {\n  return function (object) {\n    var e_2, _a;\n\n    var result = object;\n\n    try {\n      for (var props_1 = __values(props), props_1_1 = props_1.next(); !props_1_1.done; props_1_1 = props_1.next()) {\n        var prop = props_1_1.value;\n        result = result[prop];\n      }\n    } catch (e_2_1) {\n      e_2 = {\n        error: e_2_1\n      };\n    } finally {\n      try {\n        if (props_1_1 && !props_1_1.done && (_a = props_1.return)) _a.call(props_1);\n      } finally {\n        if (e_2) throw e_2.error;\n      }\n    }\n\n    return result;\n  };\n};\n/**\r\n * Retrieves a value at the given path via the nested accessor prop.\r\n * @param props The deep path to the prop of the desired value\r\n */\n\nfunction nestedPath(props, accessorProp) {\n  return function (object) {\n    var e_3, _a;\n\n    var result = object;\n\n    try {\n      for (var props_2 = __values(props), props_2_1 = props_2.next(); !props_2_1.done; props_2_1 = props_2.next()) {\n        var prop = props_2_1.value;\n        result = result[accessorProp][prop];\n      }\n    } catch (e_3_1) {\n      e_3 = {\n        error: e_3_1\n      };\n    } finally {\n      try {\n        if (props_2_1 && !props_2_1.done && (_a = props_2.return)) _a.call(props_2);\n      } finally {\n        if (e_3) throw e_3.error;\n      }\n    }\n\n    return result;\n  };\n}\nfunction toStatePaths(stateValue) {\n  if (!stateValue) {\n    return [[]];\n  }\n\n  if (isString(stateValue)) {\n    return [[stateValue]];\n  }\n\n  var result = flatten(keys(stateValue).map(function (key) {\n    var subStateValue = stateValue[key];\n\n    if (typeof subStateValue !== 'string' && (!subStateValue || !Object.keys(subStateValue).length)) {\n      return [[key]];\n    }\n\n    return toStatePaths(stateValue[key]).map(function (subPath) {\n      return [key].concat(subPath);\n    });\n  }));\n  return result;\n}\nfunction flatten(array) {\n  var _a;\n\n  return (_a = []).concat.apply(_a, __spreadArray([], __read(array)));\n}\nfunction toArrayStrict(value) {\n  if (isArray(value)) {\n    return value;\n  }\n\n  return [value];\n}\nfunction toArray(value) {\n  if (value === undefined) {\n    return [];\n  }\n\n  return toArrayStrict(value);\n}\nfunction mapContext(mapper, context, _event) {\n  var e_5, _a;\n\n  if (isFunction(mapper)) {\n    return mapper(context, _event.data);\n  }\n\n  var result = {};\n\n  try {\n    for (var _b = __values(Object.keys(mapper)), _c = _b.next(); !_c.done; _c = _b.next()) {\n      var key = _c.value;\n      var subMapper = mapper[key];\n\n      if (isFunction(subMapper)) {\n        result[key] = subMapper(context, _event.data);\n      } else {\n        result[key] = subMapper;\n      }\n    }\n  } catch (e_5_1) {\n    e_5 = {\n      error: e_5_1\n    };\n  } finally {\n    try {\n      if (_c && !_c.done && (_a = _b.return)) _a.call(_b);\n    } finally {\n      if (e_5) throw e_5.error;\n    }\n  }\n\n  return result;\n}\nfunction isBuiltInEvent(eventType) {\n  return /^(done|error)\\./.test(eventType);\n}\nfunction isPromiseLike(value) {\n  if (value instanceof Promise) {\n    return true;\n  } // Check if shape matches the Promise/A+ specification for a \"thenable\".\n\n\n  if (value !== null && (isFunction(value) || typeof value === 'object') && isFunction(value.then)) {\n    return true;\n  }\n\n  return false;\n}\nfunction isBehavior(value) {\n  return value !== null && typeof value === 'object' && 'transition' in value && typeof value.transition === 'function';\n}\nfunction partition(items, predicate) {\n  var e_6, _a;\n\n  var _b = __read([[], []], 2),\n      truthy = _b[0],\n      falsy = _b[1];\n\n  try {\n    for (var items_1 = __values(items), items_1_1 = items_1.next(); !items_1_1.done; items_1_1 = items_1.next()) {\n      var item = items_1_1.value;\n\n      if (predicate(item)) {\n        truthy.push(item);\n      } else {\n        falsy.push(item);\n      }\n    }\n  } catch (e_6_1) {\n    e_6 = {\n      error: e_6_1\n    };\n  } finally {\n    try {\n      if (items_1_1 && !items_1_1.done && (_a = items_1.return)) _a.call(items_1);\n    } finally {\n      if (e_6) throw e_6.error;\n    }\n  }\n\n  return [truthy, falsy];\n}\nfunction updateHistoryStates(hist, stateValue) {\n  return mapValues(hist.states, function (subHist, key) {\n    if (!subHist) {\n      return undefined;\n    }\n\n    var subStateValue = (isString(stateValue) ? undefined : stateValue[key]) || (subHist ? subHist.current : undefined);\n\n    if (!subStateValue) {\n      return undefined;\n    }\n\n    return {\n      current: subStateValue,\n      states: updateHistoryStates(subHist, subStateValue)\n    };\n  });\n}\nfunction updateHistoryValue(hist, stateValue) {\n  return {\n    current: stateValue,\n    states: updateHistoryStates(hist, stateValue)\n  };\n}\nfunction updateContext(context, _event, assignActions, state) {\n  if (!IS_PRODUCTION) {\n    warn(!!context, 'Attempting to update undefined context');\n  }\n\n  var updatedContext = context ? assignActions.reduce(function (acc, assignAction) {\n    var e_7, _a;\n\n    var assignment = assignAction.assignment;\n    var meta = {\n      state: state,\n      action: assignAction,\n      _event: _event\n    };\n    var partialUpdate = {};\n\n    if (isFunction(assignment)) {\n      partialUpdate = assignment(acc, _event.data, meta);\n    } else {\n      try {\n        for (var _b = __values(keys(assignment)), _c = _b.next(); !_c.done; _c = _b.next()) {\n          var key = _c.value;\n          var propAssignment = assignment[key];\n          partialUpdate[key] = isFunction(propAssignment) ? propAssignment(acc, _event.data, meta) : propAssignment;\n        }\n      } catch (e_7_1) {\n        e_7 = {\n          error: e_7_1\n        };\n      } finally {\n        try {\n          if (_c && !_c.done && (_a = _b.return)) _a.call(_b);\n        } finally {\n          if (e_7) throw e_7.error;\n        }\n      }\n    }\n\n    return Object.assign({}, acc, partialUpdate);\n  }, context) : context;\n  return updatedContext;\n} // tslint:disable-next-line:no-empty\n\nvar warn = function () {};\n\nif (!IS_PRODUCTION) {\n  warn = function (condition, message) {\n    var error = condition instanceof Error ? condition : undefined;\n\n    if (!error && condition) {\n      return;\n    }\n\n    if (console !== undefined) {\n      var args = [\"Warning: \" + message];\n\n      if (error) {\n        args.push(error);\n      } // tslint:disable-next-line:no-console\n\n\n      console.warn.apply(console, args);\n    }\n  };\n}\nfunction isArray(value) {\n  return Array.isArray(value);\n} // tslint:disable-next-line:ban-types\n\nfunction isFunction(value) {\n  return typeof value === 'function';\n}\nfunction isString(value) {\n  return typeof value === 'string';\n} // export function memoizedGetter<T, TP extends { prototype: object }>(\n//   o: TP,\n//   property: string,\n//   getter: () => T\n// ): void {\n//   Object.defineProperty(o.prototype, property, {\n//     get: getter,\n//     enumerable: false,\n//     configurable: false\n//   });\n// }\n\nfunction toGuard(condition, guardMap) {\n  if (!condition) {\n    return undefined;\n  }\n\n  if (isString(condition)) {\n    return {\n      type: DEFAULT_GUARD_TYPE,\n      name: condition,\n      predicate: guardMap ? guardMap[condition] : undefined\n    };\n  }\n\n  if (isFunction(condition)) {\n    return {\n      type: DEFAULT_GUARD_TYPE,\n      name: condition.name,\n      predicate: condition\n    };\n  }\n\n  return condition;\n}\nfunction isObservable(value) {\n  try {\n    return 'subscribe' in value && isFunction(value.subscribe);\n  } catch (e) {\n    return false;\n  }\n}\nvar symbolObservable = /*#__PURE__*/function () {\n  return typeof Symbol === 'function' && Symbol.observable || '@@observable';\n}();\nfunction isMachine(value) {\n  try {\n    return '__xstatenode' in value;\n  } catch (e) {\n    return false;\n  }\n}\nfunction isActor(value) {\n  return !!value && typeof value.send === 'function';\n}\nvar uniqueId = /*#__PURE__*/function () {\n  var currentId = 0;\n  return function () {\n    currentId++;\n    return currentId.toString(16);\n  };\n}();\nfunction toEventObject(event, payload // id?: TEvent['type']\n) {\n  if (isString(event) || typeof event === 'number') {\n    return __assign({\n      type: event\n    }, payload);\n  }\n\n  return event;\n}\nfunction toSCXMLEvent(event, scxmlEvent) {\n  if (!isString(event) && '$$type' in event && event.$$type === 'scxml') {\n    return event;\n  }\n\n  var eventObject = toEventObject(event);\n  return __assign({\n    name: eventObject.type,\n    data: eventObject,\n    $$type: 'scxml',\n    type: 'external'\n  }, scxmlEvent);\n}\nfunction toTransitionConfigArray(event, configLike) {\n  var transitions = toArrayStrict(configLike).map(function (transitionLike) {\n    if (typeof transitionLike === 'undefined' || typeof transitionLike === 'string' || isMachine(transitionLike)) {\n      return {\n        target: transitionLike,\n        event: event\n      };\n    }\n\n    return __assign(__assign({}, transitionLike), {\n      event: event\n    });\n  });\n  return transitions;\n}\nfunction normalizeTarget(target) {\n  if (target === undefined || target === TARGETLESS_KEY) {\n    return undefined;\n  }\n\n  return toArray(target);\n}\nfunction reportUnhandledExceptionOnInvocation(originalError, currentError, id) {\n  if (!IS_PRODUCTION) {\n    var originalStackTrace = originalError.stack ? \" Stacktrace was '\" + originalError.stack + \"'\" : '';\n\n    if (originalError === currentError) {\n      // tslint:disable-next-line:no-console\n      console.error(\"Missing onError handler for invocation '\" + id + \"', error was '\" + originalError + \"'.\" + originalStackTrace);\n    } else {\n      var stackTrace = currentError.stack ? \" Stacktrace was '\" + currentError.stack + \"'\" : ''; // tslint:disable-next-line:no-console\n\n      console.error(\"Missing onError handler and/or unhandled exception/promise rejection for invocation '\" + id + \"'. \" + (\"Original error: '\" + originalError + \"'. \" + originalStackTrace + \" Current error is '\" + currentError + \"'.\" + stackTrace));\n    }\n  }\n}\nfunction evaluateGuard(machine, guard, context, _event, state) {\n  var guards = machine.options.guards;\n  var guardMeta = {\n    state: state,\n    cond: guard,\n    _event: _event\n  }; // TODO: do not hardcode!\n\n  if (guard.type === DEFAULT_GUARD_TYPE) {\n    return ((guards === null || guards === void 0 ? void 0 : guards[guard.name]) || guard.predicate)(context, _event.data, guardMeta);\n  }\n\n  var condFn = guards[guard.type];\n\n  if (!condFn) {\n    throw new Error(\"Guard '\" + guard.type + \"' is not implemented on machine '\" + machine.id + \"'.\");\n  }\n\n  return condFn(context, _event.data, guardMeta);\n}\nfunction toInvokeSource(src) {\n  if (typeof src === 'string') {\n    return {\n      type: src\n    };\n  }\n\n  return src;\n}\nfunction toObserver(nextHandler, errorHandler, completionHandler) {\n  if (typeof nextHandler === 'object') {\n    return nextHandler;\n  }\n\n  var noop = function () {\n    return void 0;\n  };\n\n  return {\n    next: nextHandler,\n    error: errorHandler || noop,\n    complete: completionHandler || noop\n  };\n}\n\nexport { evaluateGuard, flatten, getEventType, isActor, isArray, isBehavior, isBuiltInEvent, isFunction, isMachine, isObservable, isPromiseLike, isStateLike, isString, keys, mapContext, mapFilterValues, mapValues, matchesState, nestedPath, normalizeTarget, partition, path, pathToStateValue, reportUnhandledExceptionOnInvocation, symbolObservable, toArray, toArrayStrict, toEventObject, toGuard, toInvokeSource, toObserver, toSCXMLEvent, toStatePath, toStatePaths, toStateValue, toTransitionConfigArray, uniqueId, updateContext, updateHistoryStates, updateHistoryValue, warn };\n","import { __values } from './_virtual/_tslib.js';\nimport { keys, matchesState } from './utils.js';\n\nfunction mapState(stateMap, stateId) {\n  var e_1, _a;\n\n  var foundStateId;\n\n  try {\n    for (var _b = __values(keys(stateMap)), _c = _b.next(); !_c.done; _c = _b.next()) {\n      var mappedStateId = _c.value;\n\n      if (matchesState(mappedStateId, stateId) && (!foundStateId || stateId.length > foundStateId.length)) {\n        foundStateId = mappedStateId;\n      }\n    }\n  } catch (e_1_1) {\n    e_1 = {\n      error: e_1_1\n    };\n  } finally {\n    try {\n      if (_c && !_c.done && (_a = _b.return)) _a.call(_b);\n    } finally {\n      if (e_1) throw e_1.error;\n    }\n  }\n\n  return stateMap[foundStateId];\n}\n\nexport { mapState };\n","var ActionTypes;\n\n(function (ActionTypes) {\n  ActionTypes[\"Start\"] = \"xstate.start\";\n  ActionTypes[\"Stop\"] = \"xstate.stop\";\n  ActionTypes[\"Raise\"] = \"xstate.raise\";\n  ActionTypes[\"Send\"] = \"xstate.send\";\n  ActionTypes[\"Cancel\"] = \"xstate.cancel\";\n  ActionTypes[\"NullEvent\"] = \"\";\n  ActionTypes[\"Assign\"] = \"xstate.assign\";\n  ActionTypes[\"After\"] = \"xstate.after\";\n  ActionTypes[\"DoneState\"] = \"done.state\";\n  ActionTypes[\"DoneInvoke\"] = \"done.invoke\";\n  ActionTypes[\"Log\"] = \"xstate.log\";\n  ActionTypes[\"Init\"] = \"xstate.init\";\n  ActionTypes[\"Invoke\"] = \"xstate.invoke\";\n  ActionTypes[\"ErrorExecution\"] = \"error.execution\";\n  ActionTypes[\"ErrorCommunication\"] = \"error.communication\";\n  ActionTypes[\"ErrorPlatform\"] = \"error.platform\";\n  ActionTypes[\"ErrorCustom\"] = \"xstate.error\";\n  ActionTypes[\"Update\"] = \"xstate.update\";\n  ActionTypes[\"Pure\"] = \"xstate.pure\";\n  ActionTypes[\"Choose\"] = \"xstate.choose\";\n})(ActionTypes || (ActionTypes = {}));\n\nvar SpecialTargets;\n\n(function (SpecialTargets) {\n  SpecialTargets[\"Parent\"] = \"#_parent\";\n  SpecialTargets[\"Internal\"] = \"#_internal\";\n})(SpecialTargets || (SpecialTargets = {}));\n\nexport { ActionTypes, SpecialTargets };\n","import { ActionTypes } from './types.js';\n\nvar start = ActionTypes.Start;\nvar stop = ActionTypes.Stop;\nvar raise = ActionTypes.Raise;\nvar send = ActionTypes.Send;\nvar cancel = ActionTypes.Cancel;\nvar nullEvent = ActionTypes.NullEvent;\nvar assign = ActionTypes.Assign;\nvar after = ActionTypes.After;\nvar doneState = ActionTypes.DoneState;\nvar log = ActionTypes.Log;\nvar init = ActionTypes.Init;\nvar invoke = ActionTypes.Invoke;\nvar errorExecution = ActionTypes.ErrorExecution;\nvar errorPlatform = ActionTypes.ErrorPlatform;\nvar error = ActionTypes.ErrorCustom;\nvar update = ActionTypes.Update;\nvar choose = ActionTypes.Choose;\nvar pure = ActionTypes.Pure;\n\nexport { after, assign, cancel, choose, doneState, error, errorExecution, errorPlatform, init, invoke, log, nullEvent, pure, raise, send, start, stop, update };\n","import { __assign, __read, __spreadArray } from './_virtual/_tslib.js';\nimport { IS_PRODUCTION } from './environment.js';\nimport { isFunction, toEventObject, getEventType, toSCXMLEvent, isString, partition, updateContext, flatten, toArray, toGuard, evaluateGuard, warn, isArray } from './utils.js';\nimport { SpecialTargets, ActionTypes } from './types.js';\nimport { send as send$1, update, assign as assign$1, init, raise as raise$1, log as log$1, cancel as cancel$1, error as error$1, stop as stop$1, pure as pure$1, choose as choose$1 } from './actionTypes.js';\n\nvar initEvent = /*#__PURE__*/toSCXMLEvent({\n  type: init\n});\nfunction getActionFunction(actionType, actionFunctionMap) {\n  return actionFunctionMap ? actionFunctionMap[actionType] || undefined : undefined;\n}\nfunction toActionObject(action, actionFunctionMap) {\n  var actionObject;\n\n  if (isString(action) || typeof action === 'number') {\n    var exec = getActionFunction(action, actionFunctionMap);\n\n    if (isFunction(exec)) {\n      actionObject = {\n        type: action,\n        exec: exec\n      };\n    } else if (exec) {\n      actionObject = exec;\n    } else {\n      actionObject = {\n        type: action,\n        exec: undefined\n      };\n    }\n  } else if (isFunction(action)) {\n    actionObject = {\n      // Convert action to string if unnamed\n      type: action.name || action.toString(),\n      exec: action\n    };\n  } else {\n    var exec = getActionFunction(action.type, actionFunctionMap);\n\n    if (isFunction(exec)) {\n      actionObject = __assign(__assign({}, action), {\n        exec: exec\n      });\n    } else if (exec) {\n      var actionType = exec.type || action.type;\n      actionObject = __assign(__assign(__assign({}, exec), action), {\n        type: actionType\n      });\n    } else {\n      actionObject = action;\n    }\n  }\n\n  return actionObject;\n}\nvar toActionObjects = function (action, actionFunctionMap) {\n  if (!action) {\n    return [];\n  }\n\n  var actions = isArray(action) ? action : [action];\n  return actions.map(function (subAction) {\n    return toActionObject(subAction, actionFunctionMap);\n  });\n};\nfunction toActivityDefinition(action) {\n  var actionObject = toActionObject(action);\n  return __assign(__assign({\n    id: isString(action) ? action : actionObject.id\n  }, actionObject), {\n    type: actionObject.type\n  });\n}\n/**\r\n * Raises an event. This places the event in the internal event queue, so that\r\n * the event is immediately consumed by the machine in the current step.\r\n *\r\n * @param eventType The event to raise.\r\n */\n\nfunction raise(event) {\n  if (!isString(event)) {\n    return send(event, {\n      to: SpecialTargets.Internal\n    });\n  }\n\n  return {\n    type: raise$1,\n    event: event\n  };\n}\nfunction resolveRaise(action) {\n  return {\n    type: raise$1,\n    _event: toSCXMLEvent(action.event)\n  };\n}\n/**\r\n * Sends an event. This returns an action that will be read by an interpreter to\r\n * send the event in the next step, after the current step is finished executing.\r\n *\r\n * @param event The event to send.\r\n * @param options Options to pass into the send event:\r\n *  - `id` - The unique send event identifier (used with `cancel()`).\r\n *  - `delay` - The number of milliseconds to delay the sending of the event.\r\n *  - `to` - The target of this event (by default, the machine the event was sent from).\r\n */\n\nfunction send(event, options) {\n  return {\n    to: options ? options.to : undefined,\n    type: send$1,\n    event: isFunction(event) ? event : toEventObject(event),\n    delay: options ? options.delay : undefined,\n    id: options && options.id !== undefined ? options.id : isFunction(event) ? event.name : getEventType(event)\n  };\n}\nfunction resolveSend(action, ctx, _event, delaysMap) {\n  var meta = {\n    _event: _event\n  }; // TODO: helper function for resolving Expr\n\n  var resolvedEvent = toSCXMLEvent(isFunction(action.event) ? action.event(ctx, _event.data, meta) : action.event);\n  var resolvedDelay;\n\n  if (isString(action.delay)) {\n    var configDelay = delaysMap && delaysMap[action.delay];\n    resolvedDelay = isFunction(configDelay) ? configDelay(ctx, _event.data, meta) : configDelay;\n  } else {\n    resolvedDelay = isFunction(action.delay) ? action.delay(ctx, _event.data, meta) : action.delay;\n  }\n\n  var resolvedTarget = isFunction(action.to) ? action.to(ctx, _event.data, meta) : action.to;\n  return __assign(__assign({}, action), {\n    to: resolvedTarget,\n    _event: resolvedEvent,\n    event: resolvedEvent.data,\n    delay: resolvedDelay\n  });\n}\n/**\r\n * Sends an event to this machine's parent.\r\n *\r\n * @param event The event to send to the parent machine.\r\n * @param options Options to pass into the send event.\r\n */\n\nfunction sendParent(event, options) {\n  return send(event, __assign(__assign({}, options), {\n    to: SpecialTargets.Parent\n  }));\n}\n/**\r\n * Sends an update event to this machine's parent.\r\n */\n\nfunction sendUpdate() {\n  return sendParent(update);\n}\n/**\r\n * Sends an event back to the sender of the original event.\r\n *\r\n * @param event The event to send back to the sender\r\n * @param options Options to pass into the send event\r\n */\n\nfunction respond(event, options) {\n  return send(event, __assign(__assign({}, options), {\n    to: function (_, __, _a) {\n      var _event = _a._event;\n      return _event.origin; // TODO: handle when _event.origin is undefined\n    }\n  }));\n}\n\nvar defaultLogExpr = function (context, event) {\n  return {\n    context: context,\n    event: event\n  };\n};\n/**\r\n *\r\n * @param expr The expression function to evaluate which will be logged.\r\n *  Takes in 2 arguments:\r\n *  - `ctx` - the current state context\r\n *  - `event` - the event that caused this action to be executed.\r\n * @param label The label to give to the logged expression.\r\n */\n\n\nfunction log(expr, label) {\n  if (expr === void 0) {\n    expr = defaultLogExpr;\n  }\n\n  return {\n    type: log$1,\n    label: label,\n    expr: expr\n  };\n}\nvar resolveLog = function (action, ctx, _event) {\n  return __assign(__assign({}, action), {\n    value: isString(action.expr) ? action.expr : action.expr(ctx, _event.data, {\n      _event: _event\n    })\n  });\n};\n/**\r\n * Cancels an in-flight `send(...)` action. A canceled sent action will not\r\n * be executed, nor will its event be sent, unless it has already been sent\r\n * (e.g., if `cancel(...)` is called after the `send(...)` action's `delay`).\r\n *\r\n * @param sendId The `id` of the `send(...)` action to cancel.\r\n */\n\nvar cancel = function (sendId) {\n  return {\n    type: cancel$1,\n    sendId: sendId\n  };\n};\n/**\r\n * Starts an activity.\r\n *\r\n * @param activity The activity to start.\r\n */\n\nfunction start(activity) {\n  var activityDef = toActivityDefinition(activity);\n  return {\n    type: ActionTypes.Start,\n    activity: activityDef,\n    exec: undefined\n  };\n}\n/**\r\n * Stops an activity.\r\n *\r\n * @param actorRef The activity to stop.\r\n */\n\nfunction stop(actorRef) {\n  var activity = isFunction(actorRef) ? actorRef : toActivityDefinition(actorRef);\n  return {\n    type: ActionTypes.Stop,\n    activity: activity,\n    exec: undefined\n  };\n}\nfunction resolveStop(action, context, _event) {\n  var actorRefOrString = isFunction(action.activity) ? action.activity(context, _event.data) : action.activity;\n  var resolvedActorRef = typeof actorRefOrString === 'string' ? {\n    id: actorRefOrString\n  } : actorRefOrString;\n  var actionObject = {\n    type: ActionTypes.Stop,\n    activity: resolvedActorRef\n  };\n  return actionObject;\n}\n/**\r\n * Updates the current context of the machine.\r\n *\r\n * @param assignment An object that represents the partial context to update.\r\n */\n\nvar assign = function (assignment) {\n  return {\n    type: assign$1,\n    assignment: assignment\n  };\n};\n/**\r\n * Returns an event type that represents an implicit event that\r\n * is sent after the specified `delay`.\r\n *\r\n * @param delayRef The delay in milliseconds\r\n * @param id The state node ID where this event is handled\r\n */\n\nfunction after(delayRef, id) {\n  var idSuffix = id ? \"#\" + id : '';\n  return ActionTypes.After + \"(\" + delayRef + \")\" + idSuffix;\n}\n/**\r\n * Returns an event that represents that a final state node\r\n * has been reached in the parent state node.\r\n *\r\n * @param id The final state node's parent state node `id`\r\n * @param data The data to pass into the event\r\n */\n\nfunction done(id, data) {\n  var type = ActionTypes.DoneState + \".\" + id;\n  var eventObject = {\n    type: type,\n    data: data\n  };\n\n  eventObject.toString = function () {\n    return type;\n  };\n\n  return eventObject;\n}\n/**\r\n * Returns an event that represents that an invoked service has terminated.\r\n *\r\n * An invoked service is terminated when it has reached a top-level final state node,\r\n * but not when it is canceled.\r\n *\r\n * @param id The final state node ID\r\n * @param data The data to pass into the event\r\n */\n\nfunction doneInvoke(id, data) {\n  var type = ActionTypes.DoneInvoke + \".\" + id;\n  var eventObject = {\n    type: type,\n    data: data\n  };\n\n  eventObject.toString = function () {\n    return type;\n  };\n\n  return eventObject;\n}\nfunction error(id, data) {\n  var type = ActionTypes.ErrorPlatform + \".\" + id;\n  var eventObject = {\n    type: type,\n    data: data\n  };\n\n  eventObject.toString = function () {\n    return type;\n  };\n\n  return eventObject;\n}\nfunction pure(getActions) {\n  return {\n    type: ActionTypes.Pure,\n    get: getActions\n  };\n}\n/**\r\n * Forwards (sends) an event to a specified service.\r\n *\r\n * @param target The target service to forward the event to.\r\n * @param options Options to pass into the send action creator.\r\n */\n\nfunction forwardTo(target, options) {\n  return send(function (_, event) {\n    return event;\n  }, __assign(__assign({}, options), {\n    to: target\n  }));\n}\n/**\r\n * Escalates an error by sending it as an event to this machine's parent.\r\n *\r\n * @param errorData The error data to send, or the expression function that\r\n * takes in the `context`, `event`, and `meta`, and returns the error data to send.\r\n * @param options Options to pass into the send action creator.\r\n */\n\nfunction escalate(errorData, options) {\n  return sendParent(function (context, event, meta) {\n    return {\n      type: error$1,\n      data: isFunction(errorData) ? errorData(context, event, meta) : errorData\n    };\n  }, __assign(__assign({}, options), {\n    to: SpecialTargets.Parent\n  }));\n}\nfunction choose(conds) {\n  return {\n    type: ActionTypes.Choose,\n    conds: conds\n  };\n}\nfunction resolveActions(machine, currentState, currentContext, _event, actions, preserveActionOrder) {\n  if (preserveActionOrder === void 0) {\n    preserveActionOrder = false;\n  }\n\n  var _a = __read(preserveActionOrder ? [[], actions] : partition(actions, function (action) {\n    return action.type === assign$1;\n  }), 2),\n      assignActions = _a[0],\n      otherActions = _a[1];\n\n  var updatedContext = assignActions.length ? updateContext(currentContext, _event, assignActions, currentState) : currentContext;\n  var preservedContexts = preserveActionOrder ? [currentContext] : undefined;\n  var resolvedActions = flatten(otherActions.map(function (actionObject) {\n    var _a;\n\n    switch (actionObject.type) {\n      case raise$1:\n        return resolveRaise(actionObject);\n\n      case send$1:\n        var sendAction = resolveSend(actionObject, updatedContext, _event, machine.options.delays); // TODO: fix ActionTypes.Init\n\n        if (!IS_PRODUCTION) {\n          // warn after resolving as we can create better contextual message here\n          warn(!isString(actionObject.delay) || typeof sendAction.delay === 'number', // tslint:disable-next-line:max-line-length\n          \"No delay reference for delay expression '\" + actionObject.delay + \"' was found on machine '\" + machine.id + \"'\");\n        }\n\n        return sendAction;\n\n      case log$1:\n        return resolveLog(actionObject, updatedContext, _event);\n\n      case choose$1:\n        {\n          var chooseAction = actionObject;\n          var matchedActions = (_a = chooseAction.conds.find(function (condition) {\n            var guard = toGuard(condition.cond, machine.options.guards);\n            return !guard || evaluateGuard(machine, guard, updatedContext, _event, currentState);\n          })) === null || _a === void 0 ? void 0 : _a.actions;\n\n          if (!matchedActions) {\n            return [];\n          }\n\n          var _b = __read(resolveActions(machine, currentState, updatedContext, _event, toActionObjects(toArray(matchedActions), machine.options.actions), preserveActionOrder), 2),\n              resolvedActionsFromChoose = _b[0],\n              resolvedContextFromChoose = _b[1];\n\n          updatedContext = resolvedContextFromChoose;\n          preservedContexts === null || preservedContexts === void 0 ? void 0 : preservedContexts.push(updatedContext);\n          return resolvedActionsFromChoose;\n        }\n\n      case pure$1:\n        {\n          var matchedActions = actionObject.get(updatedContext, _event.data);\n\n          if (!matchedActions) {\n            return [];\n          }\n\n          var _c = __read(resolveActions(machine, currentState, updatedContext, _event, toActionObjects(toArray(matchedActions), machine.options.actions), preserveActionOrder), 2),\n              resolvedActionsFromPure = _c[0],\n              resolvedContext = _c[1];\n\n          updatedContext = resolvedContext;\n          preservedContexts === null || preservedContexts === void 0 ? void 0 : preservedContexts.push(updatedContext);\n          return resolvedActionsFromPure;\n        }\n\n      case stop$1:\n        {\n          return resolveStop(actionObject, updatedContext, _event);\n        }\n\n      case assign$1:\n        {\n          updatedContext = updateContext(updatedContext, _event, [actionObject], currentState);\n          preservedContexts === null || preservedContexts === void 0 ? void 0 : preservedContexts.push(updatedContext);\n          break;\n        }\n\n      default:\n        var resolvedActionObject = toActionObject(actionObject, machine.options.actions);\n        var exec_1 = resolvedActionObject.exec;\n\n        if (exec_1 && preservedContexts) {\n          var contextIndex_1 = preservedContexts.length - 1;\n          resolvedActionObject = __assign(__assign({}, resolvedActionObject), {\n            exec: function (_ctx) {\n              var args = [];\n\n              for (var _i = 1; _i < arguments.length; _i++) {\n                args[_i - 1] = arguments[_i];\n              }\n\n              exec_1.apply(void 0, __spreadArray([preservedContexts[contextIndex_1]], __read(args)));\n            }\n          });\n        }\n\n        return resolvedActionObject;\n    }\n  }).filter(function (a) {\n    return !!a;\n  }));\n  return [resolvedActions, updatedContext];\n}\n\nexport { after, assign, cancel, choose, done, doneInvoke, error, escalate, forwardTo, getActionFunction, initEvent, log, pure, raise, resolveActions, resolveLog, resolveRaise, resolveSend, resolveStop, respond, send, sendParent, sendUpdate, start, stop, toActionObject, toActionObjects, toActivityDefinition };\n","import { __values, __spreadArray, __read } from './_virtual/_tslib.js';\nimport { keys, flatten } from './utils.js';\n\nvar isLeafNode = function (stateNode) {\n  return stateNode.type === 'atomic' || stateNode.type === 'final';\n};\nfunction getChildren(stateNode) {\n  return keys(stateNode.states).map(function (key) {\n    return stateNode.states[key];\n  });\n}\nfunction getAllStateNodes(stateNode) {\n  var stateNodes = [stateNode];\n\n  if (isLeafNode(stateNode)) {\n    return stateNodes;\n  }\n\n  return stateNodes.concat(flatten(getChildren(stateNode).map(getAllStateNodes)));\n}\nfunction getConfiguration(prevStateNodes, stateNodes) {\n  var e_1, _a, e_2, _b, e_3, _c, e_4, _d;\n\n  var prevConfiguration = new Set(prevStateNodes);\n  var prevAdjList = getAdjList(prevConfiguration);\n  var configuration = new Set(stateNodes);\n\n  try {\n    // add all ancestors\n    for (var configuration_1 = __values(configuration), configuration_1_1 = configuration_1.next(); !configuration_1_1.done; configuration_1_1 = configuration_1.next()) {\n      var s = configuration_1_1.value;\n      var m = s.parent;\n\n      while (m && !configuration.has(m)) {\n        configuration.add(m);\n        m = m.parent;\n      }\n    }\n  } catch (e_1_1) {\n    e_1 = {\n      error: e_1_1\n    };\n  } finally {\n    try {\n      if (configuration_1_1 && !configuration_1_1.done && (_a = configuration_1.return)) _a.call(configuration_1);\n    } finally {\n      if (e_1) throw e_1.error;\n    }\n  }\n\n  var adjList = getAdjList(configuration);\n\n  try {\n    // add descendants\n    for (var configuration_2 = __values(configuration), configuration_2_1 = configuration_2.next(); !configuration_2_1.done; configuration_2_1 = configuration_2.next()) {\n      var s = configuration_2_1.value; // if previously active, add existing child nodes\n\n      if (s.type === 'compound' && (!adjList.get(s) || !adjList.get(s).length)) {\n        if (prevAdjList.get(s)) {\n          prevAdjList.get(s).forEach(function (sn) {\n            return configuration.add(sn);\n          });\n        } else {\n          s.initialStateNodes.forEach(function (sn) {\n            return configuration.add(sn);\n          });\n        }\n      } else {\n        if (s.type === 'parallel') {\n          try {\n            for (var _e = (e_3 = void 0, __values(getChildren(s))), _f = _e.next(); !_f.done; _f = _e.next()) {\n              var child = _f.value;\n\n              if (child.type === 'history') {\n                continue;\n              }\n\n              if (!configuration.has(child)) {\n                configuration.add(child);\n\n                if (prevAdjList.get(child)) {\n                  prevAdjList.get(child).forEach(function (sn) {\n                    return configuration.add(sn);\n                  });\n                } else {\n                  child.initialStateNodes.forEach(function (sn) {\n                    return configuration.add(sn);\n                  });\n                }\n              }\n            }\n          } catch (e_3_1) {\n            e_3 = {\n              error: e_3_1\n            };\n          } finally {\n            try {\n              if (_f && !_f.done && (_c = _e.return)) _c.call(_e);\n            } finally {\n              if (e_3) throw e_3.error;\n            }\n          }\n        }\n      }\n    }\n  } catch (e_2_1) {\n    e_2 = {\n      error: e_2_1\n    };\n  } finally {\n    try {\n      if (configuration_2_1 && !configuration_2_1.done && (_b = configuration_2.return)) _b.call(configuration_2);\n    } finally {\n      if (e_2) throw e_2.error;\n    }\n  }\n\n  try {\n    // add all ancestors\n    for (var configuration_3 = __values(configuration), configuration_3_1 = configuration_3.next(); !configuration_3_1.done; configuration_3_1 = configuration_3.next()) {\n      var s = configuration_3_1.value;\n      var m = s.parent;\n\n      while (m && !configuration.has(m)) {\n        configuration.add(m);\n        m = m.parent;\n      }\n    }\n  } catch (e_4_1) {\n    e_4 = {\n      error: e_4_1\n    };\n  } finally {\n    try {\n      if (configuration_3_1 && !configuration_3_1.done && (_d = configuration_3.return)) _d.call(configuration_3);\n    } finally {\n      if (e_4) throw e_4.error;\n    }\n  }\n\n  return configuration;\n}\n\nfunction getValueFromAdj(baseNode, adjList) {\n  var childStateNodes = adjList.get(baseNode);\n\n  if (!childStateNodes) {\n    return {}; // todo: fix?\n  }\n\n  if (baseNode.type === 'compound') {\n    var childStateNode = childStateNodes[0];\n\n    if (childStateNode) {\n      if (isLeafNode(childStateNode)) {\n        return childStateNode.key;\n      }\n    } else {\n      return {};\n    }\n  }\n\n  var stateValue = {};\n  childStateNodes.forEach(function (csn) {\n    stateValue[csn.key] = getValueFromAdj(csn, adjList);\n  });\n  return stateValue;\n}\n\nfunction getAdjList(configuration) {\n  var e_5, _a;\n\n  var adjList = new Map();\n\n  try {\n    for (var configuration_4 = __values(configuration), configuration_4_1 = configuration_4.next(); !configuration_4_1.done; configuration_4_1 = configuration_4.next()) {\n      var s = configuration_4_1.value;\n\n      if (!adjList.has(s)) {\n        adjList.set(s, []);\n      }\n\n      if (s.parent) {\n        if (!adjList.has(s.parent)) {\n          adjList.set(s.parent, []);\n        }\n\n        adjList.get(s.parent).push(s);\n      }\n    }\n  } catch (e_5_1) {\n    e_5 = {\n      error: e_5_1\n    };\n  } finally {\n    try {\n      if (configuration_4_1 && !configuration_4_1.done && (_a = configuration_4.return)) _a.call(configuration_4);\n    } finally {\n      if (e_5) throw e_5.error;\n    }\n  }\n\n  return adjList;\n}\nfunction getValue(rootNode, configuration) {\n  var config = getConfiguration([rootNode], configuration);\n  return getValueFromAdj(rootNode, getAdjList(config));\n}\nfunction has(iterable, item) {\n  if (Array.isArray(iterable)) {\n    return iterable.some(function (member) {\n      return member === item;\n    });\n  }\n\n  if (iterable instanceof Set) {\n    return iterable.has(item);\n  }\n\n  return false; // TODO: fix\n}\nfunction nextEvents(configuration) {\n  return __spreadArray([], __read(new Set(flatten(__spreadArray([], __read(configuration.map(function (sn) {\n    return sn.ownEvents;\n  })))))));\n}\nfunction isInFinalState(configuration, stateNode) {\n  if (stateNode.type === 'compound') {\n    return getChildren(stateNode).some(function (s) {\n      return s.type === 'final' && has(configuration, s);\n    });\n  }\n\n  if (stateNode.type === 'parallel') {\n    return getChildren(stateNode).every(function (sn) {\n      return isInFinalState(configuration, sn);\n    });\n  }\n\n  return false;\n}\nfunction getMeta(configuration) {\n  if (configuration === void 0) {\n    configuration = [];\n  }\n\n  return configuration.reduce(function (acc, stateNode) {\n    if (stateNode.meta !== undefined) {\n      acc[stateNode.id] = stateNode.meta;\n    }\n\n    return acc;\n  }, {});\n}\n\nexport { getAdjList, getAllStateNodes, getChildren, getConfiguration, getMeta, getValue, has, isInFinalState, isLeafNode, nextEvents };\n","import { __spreadArray, __read, __rest, __assign } from './_virtual/_tslib.js';\nimport { EMPTY_ACTIVITY_MAP } from './constants.js';\nimport { IS_PRODUCTION } from './environment.js';\nimport { isString, matchesState, warn, keys } from './utils.js';\nimport { getMeta, nextEvents } from './stateUtils.js';\nimport { initEvent } from './actions.js';\n\nfunction stateValuesEqual(a, b) {\n  if (a === b) {\n    return true;\n  }\n\n  if (a === undefined || b === undefined) {\n    return false;\n  }\n\n  if (isString(a) || isString(b)) {\n    return a === b;\n  }\n\n  var aKeys = keys(a);\n  var bKeys = keys(b);\n  return aKeys.length === bKeys.length && aKeys.every(function (key) {\n    return stateValuesEqual(a[key], b[key]);\n  });\n}\nfunction isState(state) {\n  if (isString(state)) {\n    return false;\n  }\n\n  return 'value' in state && 'history' in state;\n}\nfunction bindActionToState(action, state) {\n  var exec = action.exec;\n\n  var boundAction = __assign(__assign({}, action), {\n    exec: exec !== undefined ? function () {\n      return exec(state.context, state.event, {\n        action: action,\n        state: state,\n        _event: state._event\n      });\n    } : undefined\n  });\n\n  return boundAction;\n}\n\nvar State =\n/*#__PURE__*/\n\n/** @class */\nfunction () {\n  /**\r\n   * Creates a new State instance.\r\n   * @param value The state value\r\n   * @param context The extended state\r\n   * @param historyValue The tree representing historical values of the state nodes\r\n   * @param history The previous state\r\n   * @param actions An array of action objects to execute as side-effects\r\n   * @param activities A mapping of activities and whether they are started (`true`) or stopped (`false`).\r\n   * @param meta\r\n   * @param events Internal event queue. Should be empty with run-to-completion semantics.\r\n   * @param configuration\r\n   */\n  function State(config) {\n    var _this = this;\n\n    var _a;\n\n    this.actions = [];\n    this.activities = EMPTY_ACTIVITY_MAP;\n    this.meta = {};\n    this.events = [];\n    this.value = config.value;\n    this.context = config.context;\n    this._event = config._event;\n    this._sessionid = config._sessionid;\n    this.event = this._event.data;\n    this.historyValue = config.historyValue;\n    this.history = config.history;\n    this.actions = config.actions || [];\n    this.activities = config.activities || EMPTY_ACTIVITY_MAP;\n    this.meta = getMeta(config.configuration);\n    this.events = config.events || [];\n    this.matches = this.matches.bind(this);\n    this.toStrings = this.toStrings.bind(this);\n    this.configuration = config.configuration;\n    this.transitions = config.transitions;\n    this.children = config.children;\n    this.done = !!config.done;\n    this.tags = (_a = Array.isArray(config.tags) ? new Set(config.tags) : config.tags) !== null && _a !== void 0 ? _a : new Set();\n    this.machine = config.machine;\n    Object.defineProperty(this, 'nextEvents', {\n      get: function () {\n        return nextEvents(_this.configuration);\n      }\n    });\n  }\n  /**\r\n   * Creates a new State instance for the given `stateValue` and `context`.\r\n   * @param stateValue\r\n   * @param context\r\n   */\n\n\n  State.from = function (stateValue, context) {\n    if (stateValue instanceof State) {\n      if (stateValue.context !== context) {\n        return new State({\n          value: stateValue.value,\n          context: context,\n          _event: stateValue._event,\n          _sessionid: null,\n          historyValue: stateValue.historyValue,\n          history: stateValue.history,\n          actions: [],\n          activities: stateValue.activities,\n          meta: {},\n          events: [],\n          configuration: [],\n          transitions: [],\n          children: {}\n        });\n      }\n\n      return stateValue;\n    }\n\n    var _event = initEvent;\n    return new State({\n      value: stateValue,\n      context: context,\n      _event: _event,\n      _sessionid: null,\n      historyValue: undefined,\n      history: undefined,\n      actions: [],\n      activities: undefined,\n      meta: undefined,\n      events: [],\n      configuration: [],\n      transitions: [],\n      children: {}\n    });\n  };\n  /**\r\n   * Creates a new State instance for the given `config`.\r\n   * @param config The state config\r\n   */\n\n\n  State.create = function (config) {\n    return new State(config);\n  };\n  /**\r\n   * Creates a new `State` instance for the given `stateValue` and `context` with no actions (side-effects).\r\n   * @param stateValue\r\n   * @param context\r\n   */\n\n\n  State.inert = function (stateValue, context) {\n    if (stateValue instanceof State) {\n      if (!stateValue.actions.length) {\n        return stateValue;\n      }\n\n      var _event = initEvent;\n      return new State({\n        value: stateValue.value,\n        context: context,\n        _event: _event,\n        _sessionid: null,\n        historyValue: stateValue.historyValue,\n        history: stateValue.history,\n        activities: stateValue.activities,\n        configuration: stateValue.configuration,\n        transitions: [],\n        children: {}\n      });\n    }\n\n    return State.from(stateValue, context);\n  };\n  /**\r\n   * Returns an array of all the string leaf state node paths.\r\n   * @param stateValue\r\n   * @param delimiter The character(s) that separate each subpath in the string state node path.\r\n   */\n\n\n  State.prototype.toStrings = function (stateValue, delimiter) {\n    var _this = this;\n\n    if (stateValue === void 0) {\n      stateValue = this.value;\n    }\n\n    if (delimiter === void 0) {\n      delimiter = '.';\n    }\n\n    if (isString(stateValue)) {\n      return [stateValue];\n    }\n\n    var valueKeys = keys(stateValue);\n    return valueKeys.concat.apply(valueKeys, __spreadArray([], __read(valueKeys.map(function (key) {\n      return _this.toStrings(stateValue[key], delimiter).map(function (s) {\n        return key + delimiter + s;\n      });\n    }))));\n  };\n\n  State.prototype.toJSON = function () {\n    var _a = this,\n        configuration = _a.configuration,\n        transitions = _a.transitions,\n        tags = _a.tags,\n        machine = _a.machine,\n        jsonValues = __rest(_a, [\"configuration\", \"transitions\", \"tags\", \"machine\"]);\n\n    return __assign(__assign({}, jsonValues), {\n      tags: Array.from(tags)\n    });\n  };\n  /**\r\n   * Whether the current state value is a subset of the given parent state value.\r\n   * @param parentStateValue\r\n   */\n\n\n  State.prototype.matches = function (parentStateValue) {\n    return matchesState(parentStateValue, this.value);\n  };\n  /**\r\n   * Whether the current state configuration has a state node with the specified `tag`.\r\n   * @param tag\r\n   */\n\n\n  State.prototype.hasTag = function (tag) {\n    return this.tags.has(tag);\n  };\n  /**\r\n   * Determines whether sending the `event` will cause a transition.\r\n   * @param event The event to test\r\n   * @returns Whether the event will cause a transition\r\n   */\n\n\n  State.prototype.can = function (event) {\n    var _a;\n\n    if (IS_PRODUCTION) {\n      warn(!!this.machine, \"state.can(...) used outside of a machine-created State object; this will always return false.\");\n    }\n\n    return !!((_a = this.machine) === null || _a === void 0 ? void 0 : _a.transition(this, event).changed);\n  };\n\n  return State;\n}();\n\nexport { State, bindActionToState, isState, stateValuesEqual };\n","/**\r\n * Maintains a stack of the current service in scope.\r\n * This is used to provide the correct service to spawn().\r\n */\nvar serviceStack = [];\nvar provide = function (service, fn) {\n  serviceStack.push(service);\n  var result = fn(service);\n  serviceStack.pop();\n  return result;\n};\nvar consume = function (fn) {\n  return fn(serviceStack[serviceStack.length - 1]);\n};\n\nexport { consume, provide };\n","import { __assign } from './_virtual/_tslib.js';\nimport { toInvokeSource, mapContext, isMachine } from './utils.js';\nimport { provide } from './serviceScope.js';\n\nfunction createNullActor(id) {\n  return {\n    id: id,\n    send: function () {\n      return void 0;\n    },\n    subscribe: function () {\n      return {\n        unsubscribe: function () {\n          return void 0;\n        }\n      };\n    },\n    getSnapshot: function () {\n      return undefined;\n    },\n    toJSON: function () {\n      return {\n        id: id\n      };\n    }\n  };\n}\n/**\r\n * Creates a deferred actor that is able to be invoked given the provided\r\n * invocation information in its `.meta` value.\r\n *\r\n * @param invokeDefinition The meta information needed to invoke the actor.\r\n */\n\nfunction createInvocableActor(invokeDefinition, machine, context, _event) {\n  var _a;\n\n  var invokeSrc = toInvokeSource(invokeDefinition.src);\n  var serviceCreator = (_a = machine === null || machine === void 0 ? void 0 : machine.options.services) === null || _a === void 0 ? void 0 : _a[invokeSrc.type];\n  var resolvedData = invokeDefinition.data ? mapContext(invokeDefinition.data, context, _event) : undefined;\n  var tempActor = serviceCreator ? createDeferredActor(serviceCreator, invokeDefinition.id, resolvedData) : createNullActor(invokeDefinition.id); // @ts-ignore\n\n  tempActor.meta = invokeDefinition;\n  return tempActor;\n}\nfunction createDeferredActor(entity, id, data) {\n  var tempActor = createNullActor(id); // @ts-ignore\n\n  tempActor.deferred = true;\n\n  if (isMachine(entity)) {\n    // \"mute\" the existing service scope so potential spawned actors within the `.initialState` stay deferred here\n    var initialState_1 = tempActor.state = provide(undefined, function () {\n      return (data ? entity.withContext(data) : entity).initialState;\n    });\n\n    tempActor.getSnapshot = function () {\n      return initialState_1;\n    };\n  }\n\n  return tempActor;\n}\nfunction isActor(item) {\n  try {\n    return typeof item.send === 'function';\n  } catch (e) {\n    return false;\n  }\n}\nfunction isSpawnedActor(item) {\n  return isActor(item) && 'id' in item;\n}\nfunction toActorRef(actorRefLike) {\n  return __assign({\n    subscribe: function () {\n      return {\n        unsubscribe: function () {\n          return void 0;\n        }\n      };\n    },\n    id: 'anonymous',\n    getSnapshot: function () {\n      return undefined;\n    }\n  }, actorRefLike);\n}\n\nexport { createDeferredActor, createInvocableActor, createNullActor, isActor, isSpawnedActor, toActorRef };\n","import { __assign, __rest } from './_virtual/_tslib.js';\nimport './environment.js';\nimport './utils.js';\nimport './types.js';\nimport { invoke } from './actionTypes.js';\n\nfunction toInvokeSource(src) {\n  if (typeof src === 'string') {\n    var simpleSrc = {\n      type: src\n    };\n\n    simpleSrc.toString = function () {\n      return src;\n    }; // v4 compat - TODO: remove in v5\n\n\n    return simpleSrc;\n  }\n\n  return src;\n}\nfunction toInvokeDefinition(invokeConfig) {\n  return __assign(__assign({\n    type: invoke\n  }, invokeConfig), {\n    toJSON: function () {\n      var onDone = invokeConfig.onDone,\n          onError = invokeConfig.onError,\n          invokeDef = __rest(invokeConfig, [\"onDone\", \"onError\"]);\n\n      return __assign(__assign({}, invokeDef), {\n        type: invoke,\n        src: toInvokeSource(invokeConfig.src)\n      });\n    }\n  });\n}\n\nexport { toInvokeDefinition, toInvokeSource };\n","import { __assign, __values, __spreadArray, __read, __rest } from './_virtual/_tslib.js';\nimport { STATE_DELIMITER } from './constants.js';\nimport { IS_PRODUCTION } from './environment.js';\nimport { isFunction, mapValues, isArray, flatten, keys, toArray, toStateValue, isString, getEventType, matchesState, path, evaluateGuard, mapContext, toSCXMLEvent, pathToStateValue, isBuiltInEvent, partition, updateHistoryValue, toStatePath, mapFilterValues, warn, toStatePaths, nestedPath, normalizeTarget, toGuard, toTransitionConfigArray, isMachine } from './utils.js';\nimport { SpecialTargets } from './types.js';\nimport { getAllStateNodes, getConfiguration, isInFinalState, has, getChildren, getValue, isLeafNode } from './stateUtils.js';\nimport { start as start$1, stop as stop$1, invoke, update, nullEvent, raise as raise$1, send as send$1 } from './actionTypes.js';\nimport { done, start, raise, stop, toActionObjects, resolveActions, doneInvoke, error, toActionObject, toActivityDefinition, after, send, cancel, initEvent } from './actions.js';\nimport { State, stateValuesEqual } from './State.js';\nimport { createInvocableActor } from './Actor.js';\nimport { toInvokeDefinition } from './invokeUtils.js';\n\nvar NULL_EVENT = '';\nvar STATE_IDENTIFIER = '#';\nvar WILDCARD = '*';\nvar EMPTY_OBJECT = {};\n\nvar isStateId = function (str) {\n  return str[0] === STATE_IDENTIFIER;\n};\n\nvar createDefaultOptions = function () {\n  return {\n    actions: {},\n    guards: {},\n    services: {},\n    activities: {},\n    delays: {}\n  };\n};\n\nvar validateArrayifiedTransitions = function (stateNode, event, transitions) {\n  var hasNonLastUnguardedTarget = transitions.slice(0, -1).some(function (transition) {\n    return !('cond' in transition) && !('in' in transition) && (isString(transition.target) || isMachine(transition.target));\n  });\n  var eventText = event === NULL_EVENT ? 'the transient event' : \"event '\" + event + \"'\";\n  warn(!hasNonLastUnguardedTarget, \"One or more transitions for \" + eventText + \" on state '\" + stateNode.id + \"' are unreachable. \" + \"Make sure that the default transition is the last one defined.\");\n};\n\nvar StateNode =\n/*#__PURE__*/\n\n/** @class */\nfunction () {\n  function StateNode(\n  /**\r\n   * The raw config used to create the machine.\r\n   */\n  config, options,\n  /**\r\n   * The initial extended state\r\n   */\n  _context // TODO: this is unsafe, but we're removing it in v5 anyway\n  ) {\n    var _this = this;\n\n    if (_context === void 0) {\n      _context = 'context' in config ? config.context : undefined;\n    }\n\n    var _a;\n\n    this.config = config;\n    this._context = _context;\n    /**\r\n     * The order this state node appears. Corresponds to the implicit SCXML document order.\r\n     */\n\n    this.order = -1;\n    this.__xstatenode = true;\n    this.__cache = {\n      events: undefined,\n      relativeValue: new Map(),\n      initialStateValue: undefined,\n      initialState: undefined,\n      on: undefined,\n      transitions: undefined,\n      candidates: {},\n      delayedTransitions: undefined\n    };\n    this.idMap = {};\n    this.tags = [];\n    this.options = Object.assign(createDefaultOptions(), options);\n    this.parent = this.options._parent;\n    this.key = this.config.key || this.options._key || this.config.id || '(machine)';\n    this.machine = this.parent ? this.parent.machine : this;\n    this.path = this.parent ? this.parent.path.concat(this.key) : [];\n    this.delimiter = this.config.delimiter || (this.parent ? this.parent.delimiter : STATE_DELIMITER);\n    this.id = this.config.id || __spreadArray([this.machine.key], __read(this.path)).join(this.delimiter);\n    this.version = this.parent ? this.parent.version : this.config.version;\n    this.type = this.config.type || (this.config.parallel ? 'parallel' : this.config.states && keys(this.config.states).length ? 'compound' : this.config.history ? 'history' : 'atomic');\n    this.schema = this.parent ? this.machine.schema : (_a = this.config.schema) !== null && _a !== void 0 ? _a : {};\n\n    if (!IS_PRODUCTION) {\n      warn(!('parallel' in this.config), \"The \\\"parallel\\\" property is deprecated and will be removed in version 4.1. \" + (this.config.parallel ? \"Replace with `type: 'parallel'`\" : \"Use `type: '\" + this.type + \"'`\") + \" in the config for state node '\" + this.id + \"' instead.\");\n    }\n\n    this.initial = this.config.initial;\n    this.states = this.config.states ? mapValues(this.config.states, function (stateConfig, key) {\n      var _a;\n\n      var stateNode = new StateNode(stateConfig, {\n        _parent: _this,\n        _key: key\n      });\n      Object.assign(_this.idMap, __assign((_a = {}, _a[stateNode.id] = stateNode, _a), stateNode.idMap));\n      return stateNode;\n    }) : EMPTY_OBJECT; // Document order\n\n    var order = 0;\n\n    function dfs(stateNode) {\n      var e_1, _a;\n\n      stateNode.order = order++;\n\n      try {\n        for (var _b = __values(getChildren(stateNode)), _c = _b.next(); !_c.done; _c = _b.next()) {\n          var child = _c.value;\n          dfs(child);\n        }\n      } catch (e_1_1) {\n        e_1 = {\n          error: e_1_1\n        };\n      } finally {\n        try {\n          if (_c && !_c.done && (_a = _b.return)) _a.call(_b);\n        } finally {\n          if (e_1) throw e_1.error;\n        }\n      }\n    }\n\n    dfs(this); // History config\n\n    this.history = this.config.history === true ? 'shallow' : this.config.history || false;\n    this._transient = !!this.config.always || (!this.config.on ? false : Array.isArray(this.config.on) ? this.config.on.some(function (_a) {\n      var event = _a.event;\n      return event === NULL_EVENT;\n    }) : NULL_EVENT in this.config.on);\n    this.strict = !!this.config.strict; // TODO: deprecate (entry)\n\n    this.onEntry = toArray(this.config.entry || this.config.onEntry).map(function (action) {\n      return toActionObject(action);\n    }); // TODO: deprecate (exit)\n\n    this.onExit = toArray(this.config.exit || this.config.onExit).map(function (action) {\n      return toActionObject(action);\n    });\n    this.meta = this.config.meta;\n    this.doneData = this.type === 'final' ? this.config.data : undefined;\n    this.invoke = toArray(this.config.invoke).map(function (invokeConfig, i) {\n      var _a, _b;\n\n      if (isMachine(invokeConfig)) {\n        _this.machine.options.services = __assign((_a = {}, _a[invokeConfig.id] = invokeConfig, _a), _this.machine.options.services);\n        return toInvokeDefinition({\n          src: invokeConfig.id,\n          id: invokeConfig.id\n        });\n      } else if (isString(invokeConfig.src)) {\n        return toInvokeDefinition(__assign(__assign({}, invokeConfig), {\n          id: invokeConfig.id || invokeConfig.src,\n          src: invokeConfig.src\n        }));\n      } else if (isMachine(invokeConfig.src) || isFunction(invokeConfig.src)) {\n        var invokeSrc = _this.id + \":invocation[\" + i + \"]\"; // TODO: util function\n\n        _this.machine.options.services = __assign((_b = {}, _b[invokeSrc] = invokeConfig.src, _b), _this.machine.options.services);\n        return toInvokeDefinition(__assign(__assign({\n          id: invokeSrc\n        }, invokeConfig), {\n          src: invokeSrc\n        }));\n      } else {\n        var invokeSource = invokeConfig.src;\n        return toInvokeDefinition(__assign(__assign({\n          id: invokeSource.type\n        }, invokeConfig), {\n          src: invokeSource\n        }));\n      }\n    });\n    this.activities = toArray(this.config.activities).concat(this.invoke).map(function (activity) {\n      return toActivityDefinition(activity);\n    });\n    this.transition = this.transition.bind(this);\n    this.tags = toArray(this.config.tags); // TODO: this is the real fix for initialization once\n    // state node getters are deprecated\n    // if (!this.parent) {\n    //   this._init();\n    // }\n  }\n\n  StateNode.prototype._init = function () {\n    if (this.__cache.transitions) {\n      return;\n    }\n\n    getAllStateNodes(this).forEach(function (stateNode) {\n      return stateNode.on;\n    });\n  };\n  /**\r\n   * Clones this state machine with custom options and context.\r\n   *\r\n   * @param options Options (actions, guards, activities, services) to recursively merge with the existing options.\r\n   * @param context Custom context (will override predefined context)\r\n   */\n\n\n  StateNode.prototype.withConfig = function (options, context) {\n    var _a = this.options,\n        actions = _a.actions,\n        activities = _a.activities,\n        guards = _a.guards,\n        services = _a.services,\n        delays = _a.delays;\n    return new StateNode(this.config, {\n      actions: __assign(__assign({}, actions), options.actions),\n      activities: __assign(__assign({}, activities), options.activities),\n      guards: __assign(__assign({}, guards), options.guards),\n      services: __assign(__assign({}, services), options.services),\n      delays: __assign(__assign({}, delays), options.delays)\n    }, context !== null && context !== void 0 ? context : this.context);\n  };\n  /**\r\n   * Clones this state machine with custom context.\r\n   *\r\n   * @param context Custom context (will override predefined context, not recursive)\r\n   */\n\n\n  StateNode.prototype.withContext = function (context) {\n    return new StateNode(this.config, this.options, context);\n  };\n\n  Object.defineProperty(StateNode.prototype, \"context\", {\n    get: function () {\n      return isFunction(this._context) ? this._context() : this._context;\n    },\n    enumerable: false,\n    configurable: true\n  });\n  Object.defineProperty(StateNode.prototype, \"definition\", {\n    /**\r\n     * The well-structured state node definition.\r\n     */\n    get: function () {\n      return {\n        id: this.id,\n        key: this.key,\n        version: this.version,\n        context: this.context,\n        type: this.type,\n        initial: this.initial,\n        history: this.history,\n        states: mapValues(this.states, function (state) {\n          return state.definition;\n        }),\n        on: this.on,\n        transitions: this.transitions,\n        entry: this.onEntry,\n        exit: this.onExit,\n        activities: this.activities || [],\n        meta: this.meta,\n        order: this.order || -1,\n        data: this.doneData,\n        invoke: this.invoke\n      };\n    },\n    enumerable: false,\n    configurable: true\n  });\n\n  StateNode.prototype.toJSON = function () {\n    return this.definition;\n  };\n\n  Object.defineProperty(StateNode.prototype, \"on\", {\n    /**\r\n     * The mapping of events to transitions.\r\n     */\n    get: function () {\n      if (this.__cache.on) {\n        return this.__cache.on;\n      }\n\n      var transitions = this.transitions;\n      return this.__cache.on = transitions.reduce(function (map, transition) {\n        map[transition.eventType] = map[transition.eventType] || [];\n        map[transition.eventType].push(transition);\n        return map;\n      }, {});\n    },\n    enumerable: false,\n    configurable: true\n  });\n  Object.defineProperty(StateNode.prototype, \"after\", {\n    get: function () {\n      return this.__cache.delayedTransitions || (this.__cache.delayedTransitions = this.getDelayedTransitions(), this.__cache.delayedTransitions);\n    },\n    enumerable: false,\n    configurable: true\n  });\n  Object.defineProperty(StateNode.prototype, \"transitions\", {\n    /**\r\n     * All the transitions that can be taken from this state node.\r\n     */\n    get: function () {\n      return this.__cache.transitions || (this.__cache.transitions = this.formatTransitions(), this.__cache.transitions);\n    },\n    enumerable: false,\n    configurable: true\n  });\n\n  StateNode.prototype.getCandidates = function (eventName) {\n    if (this.__cache.candidates[eventName]) {\n      return this.__cache.candidates[eventName];\n    }\n\n    var transient = eventName === NULL_EVENT;\n    var candidates = this.transitions.filter(function (transition) {\n      var sameEventType = transition.eventType === eventName; // null events should only match against eventless transitions\n\n      return transient ? sameEventType : sameEventType || transition.eventType === WILDCARD;\n    });\n    this.__cache.candidates[eventName] = candidates;\n    return candidates;\n  };\n  /**\r\n   * All delayed transitions from the config.\r\n   */\n\n\n  StateNode.prototype.getDelayedTransitions = function () {\n    var _this = this;\n\n    var afterConfig = this.config.after;\n\n    if (!afterConfig) {\n      return [];\n    }\n\n    var mutateEntryExit = function (delay, i) {\n      var delayRef = isFunction(delay) ? _this.id + \":delay[\" + i + \"]\" : delay;\n      var eventType = after(delayRef, _this.id);\n\n      _this.onEntry.push(send(eventType, {\n        delay: delay\n      }));\n\n      _this.onExit.push(cancel(eventType));\n\n      return eventType;\n    };\n\n    var delayedTransitions = isArray(afterConfig) ? afterConfig.map(function (transition, i) {\n      var eventType = mutateEntryExit(transition.delay, i);\n      return __assign(__assign({}, transition), {\n        event: eventType\n      });\n    }) : flatten(keys(afterConfig).map(function (delay, i) {\n      var configTransition = afterConfig[delay];\n      var resolvedTransition = isString(configTransition) ? {\n        target: configTransition\n      } : configTransition;\n      var resolvedDelay = !isNaN(+delay) ? +delay : delay;\n      var eventType = mutateEntryExit(resolvedDelay, i);\n      return toArray(resolvedTransition).map(function (transition) {\n        return __assign(__assign({}, transition), {\n          event: eventType,\n          delay: resolvedDelay\n        });\n      });\n    }));\n    return delayedTransitions.map(function (delayedTransition) {\n      var delay = delayedTransition.delay;\n      return __assign(__assign({}, _this.formatTransition(delayedTransition)), {\n        delay: delay\n      });\n    });\n  };\n  /**\r\n   * Returns the state nodes represented by the current state value.\r\n   *\r\n   * @param state The state value or State instance\r\n   */\n\n\n  StateNode.prototype.getStateNodes = function (state) {\n    var _a;\n\n    var _this = this;\n\n    if (!state) {\n      return [];\n    }\n\n    var stateValue = state instanceof State ? state.value : toStateValue(state, this.delimiter);\n\n    if (isString(stateValue)) {\n      var initialStateValue = this.getStateNode(stateValue).initial;\n      return initialStateValue !== undefined ? this.getStateNodes((_a = {}, _a[stateValue] = initialStateValue, _a)) : [this, this.states[stateValue]];\n    }\n\n    var subStateKeys = keys(stateValue);\n    var subStateNodes = subStateKeys.map(function (subStateKey) {\n      return _this.getStateNode(subStateKey);\n    });\n    subStateNodes.push(this);\n    return subStateNodes.concat(subStateKeys.reduce(function (allSubStateNodes, subStateKey) {\n      var subStateNode = _this.getStateNode(subStateKey).getStateNodes(stateValue[subStateKey]);\n\n      return allSubStateNodes.concat(subStateNode);\n    }, []));\n  };\n  /**\r\n   * Returns `true` if this state node explicitly handles the given event.\r\n   *\r\n   * @param event The event in question\r\n   */\n\n\n  StateNode.prototype.handles = function (event) {\n    var eventType = getEventType(event);\n    return this.events.includes(eventType);\n  };\n  /**\r\n   * Resolves the given `state` to a new `State` instance relative to this machine.\r\n   *\r\n   * This ensures that `.events` and `.nextEvents` represent the correct values.\r\n   *\r\n   * @param state The state to resolve\r\n   */\n\n\n  StateNode.prototype.resolveState = function (state) {\n    var configuration = Array.from(getConfiguration([], this.getStateNodes(state.value)));\n    return new State(__assign(__assign({}, state), {\n      value: this.resolve(state.value),\n      configuration: configuration,\n      done: isInFinalState(configuration, this)\n    }));\n  };\n\n  StateNode.prototype.transitionLeafNode = function (stateValue, state, _event) {\n    var stateNode = this.getStateNode(stateValue);\n    var next = stateNode.next(state, _event);\n\n    if (!next || !next.transitions.length) {\n      return this.next(state, _event);\n    }\n\n    return next;\n  };\n\n  StateNode.prototype.transitionCompoundNode = function (stateValue, state, _event) {\n    var subStateKeys = keys(stateValue);\n    var stateNode = this.getStateNode(subStateKeys[0]);\n\n    var next = stateNode._transition(stateValue[subStateKeys[0]], state, _event);\n\n    if (!next || !next.transitions.length) {\n      return this.next(state, _event);\n    }\n\n    return next;\n  };\n\n  StateNode.prototype.transitionParallelNode = function (stateValue, state, _event) {\n    var e_2, _a;\n\n    var transitionMap = {};\n\n    try {\n      for (var _b = __values(keys(stateValue)), _c = _b.next(); !_c.done; _c = _b.next()) {\n        var subStateKey = _c.value;\n        var subStateValue = stateValue[subStateKey];\n\n        if (!subStateValue) {\n          continue;\n        }\n\n        var subStateNode = this.getStateNode(subStateKey);\n\n        var next = subStateNode._transition(subStateValue, state, _event);\n\n        if (next) {\n          transitionMap[subStateKey] = next;\n        }\n      }\n    } catch (e_2_1) {\n      e_2 = {\n        error: e_2_1\n      };\n    } finally {\n      try {\n        if (_c && !_c.done && (_a = _b.return)) _a.call(_b);\n      } finally {\n        if (e_2) throw e_2.error;\n      }\n    }\n\n    var stateTransitions = keys(transitionMap).map(function (key) {\n      return transitionMap[key];\n    });\n    var enabledTransitions = flatten(stateTransitions.map(function (st) {\n      return st.transitions;\n    }));\n    var willTransition = stateTransitions.some(function (st) {\n      return st.transitions.length > 0;\n    });\n\n    if (!willTransition) {\n      return this.next(state, _event);\n    }\n\n    var entryNodes = flatten(stateTransitions.map(function (t) {\n      return t.entrySet;\n    }));\n    var configuration = flatten(keys(transitionMap).map(function (key) {\n      return transitionMap[key].configuration;\n    }));\n    return {\n      transitions: enabledTransitions,\n      entrySet: entryNodes,\n      exitSet: flatten(stateTransitions.map(function (t) {\n        return t.exitSet;\n      })),\n      configuration: configuration,\n      source: state,\n      actions: flatten(keys(transitionMap).map(function (key) {\n        return transitionMap[key].actions;\n      }))\n    };\n  };\n\n  StateNode.prototype._transition = function (stateValue, state, _event) {\n    // leaf node\n    if (isString(stateValue)) {\n      return this.transitionLeafNode(stateValue, state, _event);\n    } // hierarchical node\n\n\n    if (keys(stateValue).length === 1) {\n      return this.transitionCompoundNode(stateValue, state, _event);\n    } // orthogonal node\n\n\n    return this.transitionParallelNode(stateValue, state, _event);\n  };\n\n  StateNode.prototype.next = function (state, _event) {\n    var e_3, _a;\n\n    var _this = this;\n\n    var eventName = _event.name;\n    var actions = [];\n    var nextStateNodes = [];\n    var selectedTransition;\n\n    try {\n      for (var _b = __values(this.getCandidates(eventName)), _c = _b.next(); !_c.done; _c = _b.next()) {\n        var candidate = _c.value;\n        var cond = candidate.cond,\n            stateIn = candidate.in;\n        var resolvedContext = state.context;\n        var isInState = stateIn ? isString(stateIn) && isStateId(stateIn) ? // Check if in state by ID\n        state.matches(toStateValue(this.getStateNodeById(stateIn).path, this.delimiter)) : // Check if in state by relative grandparent\n        matchesState(toStateValue(stateIn, this.delimiter), path(this.path.slice(0, -2))(state.value)) : true;\n        var guardPassed = false;\n\n        try {\n          guardPassed = !cond || evaluateGuard(this.machine, cond, resolvedContext, _event, state);\n        } catch (err) {\n          throw new Error(\"Unable to evaluate guard '\" + (cond.name || cond.type) + \"' in transition for event '\" + eventName + \"' in state node '\" + this.id + \"':\\n\" + err.message);\n        }\n\n        if (guardPassed && isInState) {\n          if (candidate.target !== undefined) {\n            nextStateNodes = candidate.target;\n          }\n\n          actions.push.apply(actions, __spreadArray([], __read(candidate.actions)));\n          selectedTransition = candidate;\n          break;\n        }\n      }\n    } catch (e_3_1) {\n      e_3 = {\n        error: e_3_1\n      };\n    } finally {\n      try {\n        if (_c && !_c.done && (_a = _b.return)) _a.call(_b);\n      } finally {\n        if (e_3) throw e_3.error;\n      }\n    }\n\n    if (!selectedTransition) {\n      return undefined;\n    }\n\n    if (!nextStateNodes.length) {\n      return {\n        transitions: [selectedTransition],\n        entrySet: [],\n        exitSet: [],\n        configuration: state.value ? [this] : [],\n        source: state,\n        actions: actions\n      };\n    }\n\n    var allNextStateNodes = flatten(nextStateNodes.map(function (stateNode) {\n      return _this.getRelativeStateNodes(stateNode, state.historyValue);\n    }));\n    var isInternal = !!selectedTransition.internal;\n    var reentryNodes = isInternal ? [] : flatten(allNextStateNodes.map(function (n) {\n      return _this.nodesFromChild(n);\n    }));\n    return {\n      transitions: [selectedTransition],\n      entrySet: reentryNodes,\n      exitSet: isInternal ? [] : [this],\n      configuration: allNextStateNodes,\n      source: state,\n      actions: actions\n    };\n  };\n\n  StateNode.prototype.nodesFromChild = function (childStateNode) {\n    if (childStateNode.escapes(this)) {\n      return [];\n    }\n\n    var nodes = [];\n    var marker = childStateNode;\n\n    while (marker && marker !== this) {\n      nodes.push(marker);\n      marker = marker.parent;\n    }\n\n    nodes.push(this); // inclusive\n\n    return nodes;\n  };\n  /**\r\n   * Whether the given state node \"escapes\" this state node. If the `stateNode` is equal to or the parent of\r\n   * this state node, it does not escape.\r\n   */\n\n\n  StateNode.prototype.escapes = function (stateNode) {\n    if (this === stateNode) {\n      return false;\n    }\n\n    var parent = this.parent;\n\n    while (parent) {\n      if (parent === stateNode) {\n        return false;\n      }\n\n      parent = parent.parent;\n    }\n\n    return true;\n  };\n\n  StateNode.prototype.getActions = function (transition, currentContext, _event, prevState) {\n    var e_4, _a, e_5, _b;\n\n    var prevConfig = getConfiguration([], prevState ? this.getStateNodes(prevState.value) : [this]);\n    var resolvedConfig = transition.configuration.length ? getConfiguration(prevConfig, transition.configuration) : prevConfig;\n\n    try {\n      for (var resolvedConfig_1 = __values(resolvedConfig), resolvedConfig_1_1 = resolvedConfig_1.next(); !resolvedConfig_1_1.done; resolvedConfig_1_1 = resolvedConfig_1.next()) {\n        var sn = resolvedConfig_1_1.value;\n\n        if (!has(prevConfig, sn)) {\n          transition.entrySet.push(sn);\n        }\n      }\n    } catch (e_4_1) {\n      e_4 = {\n        error: e_4_1\n      };\n    } finally {\n      try {\n        if (resolvedConfig_1_1 && !resolvedConfig_1_1.done && (_a = resolvedConfig_1.return)) _a.call(resolvedConfig_1);\n      } finally {\n        if (e_4) throw e_4.error;\n      }\n    }\n\n    try {\n      for (var prevConfig_1 = __values(prevConfig), prevConfig_1_1 = prevConfig_1.next(); !prevConfig_1_1.done; prevConfig_1_1 = prevConfig_1.next()) {\n        var sn = prevConfig_1_1.value;\n\n        if (!has(resolvedConfig, sn) || has(transition.exitSet, sn.parent)) {\n          transition.exitSet.push(sn);\n        }\n      }\n    } catch (e_5_1) {\n      e_5 = {\n        error: e_5_1\n      };\n    } finally {\n      try {\n        if (prevConfig_1_1 && !prevConfig_1_1.done && (_b = prevConfig_1.return)) _b.call(prevConfig_1);\n      } finally {\n        if (e_5) throw e_5.error;\n      }\n    }\n\n    if (!transition.source) {\n      transition.exitSet = []; // Ensure that root StateNode (machine) is entered\n\n      transition.entrySet.push(this);\n    }\n\n    var doneEvents = flatten(transition.entrySet.map(function (sn) {\n      var events = [];\n\n      if (sn.type !== 'final') {\n        return events;\n      }\n\n      var parent = sn.parent;\n\n      if (!parent.parent) {\n        return events;\n      }\n\n      events.push(done(sn.id, sn.doneData), // TODO: deprecate - final states should not emit done events for their own state.\n      done(parent.id, sn.doneData ? mapContext(sn.doneData, currentContext, _event) : undefined));\n      var grandparent = parent.parent;\n\n      if (grandparent.type === 'parallel') {\n        if (getChildren(grandparent).every(function (parentNode) {\n          return isInFinalState(transition.configuration, parentNode);\n        })) {\n          events.push(done(grandparent.id));\n        }\n      }\n\n      return events;\n    }));\n    transition.exitSet.sort(function (a, b) {\n      return b.order - a.order;\n    });\n    transition.entrySet.sort(function (a, b) {\n      return a.order - b.order;\n    });\n    var entryStates = new Set(transition.entrySet);\n    var exitStates = new Set(transition.exitSet);\n\n    var _c = __read([flatten(Array.from(entryStates).map(function (stateNode) {\n      return __spreadArray(__spreadArray([], __read(stateNode.activities.map(function (activity) {\n        return start(activity);\n      }))), __read(stateNode.onEntry));\n    })).concat(doneEvents.map(raise)), flatten(Array.from(exitStates).map(function (stateNode) {\n      return __spreadArray(__spreadArray([], __read(stateNode.onExit)), __read(stateNode.activities.map(function (activity) {\n        return stop(activity);\n      })));\n    }))], 2),\n        entryActions = _c[0],\n        exitActions = _c[1];\n\n    var actions = toActionObjects(exitActions.concat(transition.actions).concat(entryActions), this.machine.options.actions);\n    return actions;\n  };\n  /**\r\n   * Determines the next state given the current `state` and sent `event`.\r\n   *\r\n   * @param state The current State instance or state value\r\n   * @param event The event that was sent at the current state\r\n   * @param context The current context (extended state) of the current state\r\n   */\n\n\n  StateNode.prototype.transition = function (state, event, context) {\n    if (state === void 0) {\n      state = this.initialState;\n    }\n\n    var _event = toSCXMLEvent(event);\n\n    var currentState;\n\n    if (state instanceof State) {\n      currentState = context === undefined ? state : this.resolveState(State.from(state, context));\n    } else {\n      var resolvedStateValue = isString(state) ? this.resolve(pathToStateValue(this.getResolvedPath(state))) : this.resolve(state);\n      var resolvedContext = context !== null && context !== void 0 ? context : this.machine.context;\n      currentState = this.resolveState(State.from(resolvedStateValue, resolvedContext));\n    }\n\n    if (!IS_PRODUCTION && _event.name === WILDCARD) {\n      throw new Error(\"An event cannot have the wildcard type ('\" + WILDCARD + \"')\");\n    }\n\n    if (this.strict) {\n      if (!this.events.includes(_event.name) && !isBuiltInEvent(_event.name)) {\n        throw new Error(\"Machine '\" + this.id + \"' does not accept event '\" + _event.name + \"'\");\n      }\n    }\n\n    var stateTransition = this._transition(currentState.value, currentState, _event) || {\n      transitions: [],\n      configuration: [],\n      entrySet: [],\n      exitSet: [],\n      source: currentState,\n      actions: []\n    };\n    var prevConfig = getConfiguration([], this.getStateNodes(currentState.value));\n    var resolvedConfig = stateTransition.configuration.length ? getConfiguration(prevConfig, stateTransition.configuration) : prevConfig;\n    stateTransition.configuration = __spreadArray([], __read(resolvedConfig));\n    return this.resolveTransition(stateTransition, currentState, _event);\n  };\n\n  StateNode.prototype.resolveRaisedTransition = function (state, _event, originalEvent) {\n    var _a;\n\n    var currentActions = state.actions;\n    state = this.transition(state, _event); // Save original event to state\n    // TODO: this should be the raised event! Delete in V5 (breaking)\n\n    state._event = originalEvent;\n    state.event = originalEvent.data;\n\n    (_a = state.actions).unshift.apply(_a, __spreadArray([], __read(currentActions)));\n\n    return state;\n  };\n\n  StateNode.prototype.resolveTransition = function (stateTransition, currentState, _event, context) {\n    var e_6, _a;\n\n    var _this = this;\n\n    if (_event === void 0) {\n      _event = initEvent;\n    }\n\n    if (context === void 0) {\n      context = this.machine.context;\n    }\n\n    var configuration = stateTransition.configuration; // Transition will \"apply\" if:\n    // - this is the initial state (there is no current state)\n    // - OR there are transitions\n\n    var willTransition = !currentState || stateTransition.transitions.length > 0;\n    var resolvedStateValue = willTransition ? getValue(this.machine, configuration) : undefined;\n    var historyValue = currentState ? currentState.historyValue ? currentState.historyValue : stateTransition.source ? this.machine.historyValue(currentState.value) : undefined : undefined;\n    var currentContext = currentState ? currentState.context : context;\n    var actions = this.getActions(stateTransition, currentContext, _event, currentState);\n    var activities = currentState ? __assign({}, currentState.activities) : {};\n\n    try {\n      for (var actions_1 = __values(actions), actions_1_1 = actions_1.next(); !actions_1_1.done; actions_1_1 = actions_1.next()) {\n        var action = actions_1_1.value;\n\n        if (action.type === start$1) {\n          activities[action.activity.id || action.activity.type] = action;\n        } else if (action.type === stop$1) {\n          activities[action.activity.id || action.activity.type] = false;\n        }\n      }\n    } catch (e_6_1) {\n      e_6 = {\n        error: e_6_1\n      };\n    } finally {\n      try {\n        if (actions_1_1 && !actions_1_1.done && (_a = actions_1.return)) _a.call(actions_1);\n      } finally {\n        if (e_6) throw e_6.error;\n      }\n    }\n\n    var _b = __read(resolveActions(this, currentState, currentContext, _event, actions, this.machine.config.preserveActionOrder), 2),\n        resolvedActions = _b[0],\n        updatedContext = _b[1];\n\n    var _c = __read(partition(resolvedActions, function (action) {\n      return action.type === raise$1 || action.type === send$1 && action.to === SpecialTargets.Internal;\n    }), 2),\n        raisedEvents = _c[0],\n        nonRaisedActions = _c[1];\n\n    var invokeActions = resolvedActions.filter(function (action) {\n      var _a;\n\n      return action.type === start$1 && ((_a = action.activity) === null || _a === void 0 ? void 0 : _a.type) === invoke;\n    });\n    var children = invokeActions.reduce(function (acc, action) {\n      acc[action.activity.id] = createInvocableActor(action.activity, _this.machine, updatedContext, _event);\n      return acc;\n    }, currentState ? __assign({}, currentState.children) : {});\n    var resolvedConfiguration = resolvedStateValue ? stateTransition.configuration : currentState ? currentState.configuration : [];\n    var isDone = isInFinalState(resolvedConfiguration, this);\n    var nextState = new State({\n      value: resolvedStateValue || currentState.value,\n      context: updatedContext,\n      _event: _event,\n      // Persist _sessionid between states\n      _sessionid: currentState ? currentState._sessionid : null,\n      historyValue: resolvedStateValue ? historyValue ? updateHistoryValue(historyValue, resolvedStateValue) : undefined : currentState ? currentState.historyValue : undefined,\n      history: !resolvedStateValue || stateTransition.source ? currentState : undefined,\n      actions: resolvedStateValue ? nonRaisedActions : [],\n      activities: resolvedStateValue ? activities : currentState ? currentState.activities : {},\n      events: [],\n      configuration: resolvedConfiguration,\n      transitions: stateTransition.transitions,\n      children: children,\n      done: isDone,\n      tags: currentState === null || currentState === void 0 ? void 0 : currentState.tags,\n      machine: this\n    });\n    var didUpdateContext = currentContext !== updatedContext;\n    nextState.changed = _event.name === update || didUpdateContext; // Dispose of penultimate histories to prevent memory leaks\n\n    var history = nextState.history;\n\n    if (history) {\n      delete history.history;\n    } // There are transient transitions if the machine is not in a final state\n    // and if some of the state nodes have transient (\"always\") transitions.\n\n\n    var isTransient = !isDone && (this._transient || configuration.some(function (stateNode) {\n      return stateNode._transient;\n    })); // If there are no enabled transitions, check if there are transient transitions.\n    // If there are transient transitions, continue checking for more transitions\n    // because an transient transition should be triggered even if there are no\n    // enabled transitions.\n    //\n    // If we're already working on an transient transition (by checking\n    // if the event is a NULL_EVENT), then stop to prevent an infinite loop.\n    //\n    // Otherwise, if there are no enabled nor transient transitions, we are done.\n\n    if (!willTransition && (!isTransient || _event.name === NULL_EVENT)) {\n      return nextState;\n    }\n\n    var maybeNextState = nextState;\n\n    if (!isDone) {\n      if (isTransient) {\n        maybeNextState = this.resolveRaisedTransition(maybeNextState, {\n          type: nullEvent\n        }, _event);\n      }\n\n      while (raisedEvents.length) {\n        var raisedEvent = raisedEvents.shift();\n        maybeNextState = this.resolveRaisedTransition(maybeNextState, raisedEvent._event, _event);\n      }\n    } // Detect if state changed\n\n\n    var changed = maybeNextState.changed || (history ? !!maybeNextState.actions.length || didUpdateContext || typeof history.value !== typeof maybeNextState.value || !stateValuesEqual(maybeNextState.value, history.value) : undefined);\n    maybeNextState.changed = changed; // Preserve original history after raised events\n\n    maybeNextState.history = history;\n    maybeNextState.tags = new Set(flatten(maybeNextState.configuration.map(function (sn) {\n      return sn.tags;\n    })));\n    return maybeNextState;\n  };\n  /**\r\n   * Returns the child state node from its relative `stateKey`, or throws.\r\n   */\n\n\n  StateNode.prototype.getStateNode = function (stateKey) {\n    if (isStateId(stateKey)) {\n      return this.machine.getStateNodeById(stateKey);\n    }\n\n    if (!this.states) {\n      throw new Error(\"Unable to retrieve child state '\" + stateKey + \"' from '\" + this.id + \"'; no child states exist.\");\n    }\n\n    var result = this.states[stateKey];\n\n    if (!result) {\n      throw new Error(\"Child state '\" + stateKey + \"' does not exist on '\" + this.id + \"'\");\n    }\n\n    return result;\n  };\n  /**\r\n   * Returns the state node with the given `stateId`, or throws.\r\n   *\r\n   * @param stateId The state ID. The prefix \"#\" is removed.\r\n   */\n\n\n  StateNode.prototype.getStateNodeById = function (stateId) {\n    var resolvedStateId = isStateId(stateId) ? stateId.slice(STATE_IDENTIFIER.length) : stateId;\n\n    if (resolvedStateId === this.id) {\n      return this;\n    }\n\n    var stateNode = this.machine.idMap[resolvedStateId];\n\n    if (!stateNode) {\n      throw new Error(\"Child state node '#\" + resolvedStateId + \"' does not exist on machine '\" + this.id + \"'\");\n    }\n\n    return stateNode;\n  };\n  /**\r\n   * Returns the relative state node from the given `statePath`, or throws.\r\n   *\r\n   * @param statePath The string or string array relative path to the state node.\r\n   */\n\n\n  StateNode.prototype.getStateNodeByPath = function (statePath) {\n    if (typeof statePath === 'string' && isStateId(statePath)) {\n      try {\n        return this.getStateNodeById(statePath.slice(1));\n      } catch (e) {// try individual paths\n        // throw e;\n      }\n    }\n\n    var arrayStatePath = toStatePath(statePath, this.delimiter).slice();\n    var currentStateNode = this;\n\n    while (arrayStatePath.length) {\n      var key = arrayStatePath.shift();\n\n      if (!key.length) {\n        break;\n      }\n\n      currentStateNode = currentStateNode.getStateNode(key);\n    }\n\n    return currentStateNode;\n  };\n  /**\r\n   * Resolves a partial state value with its full representation in this machine.\r\n   *\r\n   * @param stateValue The partial state value to resolve.\r\n   */\n\n\n  StateNode.prototype.resolve = function (stateValue) {\n    var _a;\n\n    var _this = this;\n\n    if (!stateValue) {\n      return this.initialStateValue || EMPTY_OBJECT; // TODO: type-specific properties\n    }\n\n    switch (this.type) {\n      case 'parallel':\n        return mapValues(this.initialStateValue, function (subStateValue, subStateKey) {\n          return subStateValue ? _this.getStateNode(subStateKey).resolve(stateValue[subStateKey] || subStateValue) : EMPTY_OBJECT;\n        });\n\n      case 'compound':\n        if (isString(stateValue)) {\n          var subStateNode = this.getStateNode(stateValue);\n\n          if (subStateNode.type === 'parallel' || subStateNode.type === 'compound') {\n            return _a = {}, _a[stateValue] = subStateNode.initialStateValue, _a;\n          }\n\n          return stateValue;\n        }\n\n        if (!keys(stateValue).length) {\n          return this.initialStateValue || {};\n        }\n\n        return mapValues(stateValue, function (subStateValue, subStateKey) {\n          return subStateValue ? _this.getStateNode(subStateKey).resolve(subStateValue) : EMPTY_OBJECT;\n        });\n\n      default:\n        return stateValue || EMPTY_OBJECT;\n    }\n  };\n\n  StateNode.prototype.getResolvedPath = function (stateIdentifier) {\n    if (isStateId(stateIdentifier)) {\n      var stateNode = this.machine.idMap[stateIdentifier.slice(STATE_IDENTIFIER.length)];\n\n      if (!stateNode) {\n        throw new Error(\"Unable to find state node '\" + stateIdentifier + \"'\");\n      }\n\n      return stateNode.path;\n    }\n\n    return toStatePath(stateIdentifier, this.delimiter);\n  };\n\n  Object.defineProperty(StateNode.prototype, \"initialStateValue\", {\n    get: function () {\n      var _a;\n\n      if (this.__cache.initialStateValue) {\n        return this.__cache.initialStateValue;\n      }\n\n      var initialStateValue;\n\n      if (this.type === 'parallel') {\n        initialStateValue = mapFilterValues(this.states, function (state) {\n          return state.initialStateValue || EMPTY_OBJECT;\n        }, function (stateNode) {\n          return !(stateNode.type === 'history');\n        });\n      } else if (this.initial !== undefined) {\n        if (!this.states[this.initial]) {\n          throw new Error(\"Initial state '\" + this.initial + \"' not found on '\" + this.key + \"'\");\n        }\n\n        initialStateValue = isLeafNode(this.states[this.initial]) ? this.initial : (_a = {}, _a[this.initial] = this.states[this.initial].initialStateValue, _a);\n      } else {\n        // The finite state value of a machine without child states is just an empty object\n        initialStateValue = {};\n      }\n\n      this.__cache.initialStateValue = initialStateValue;\n      return this.__cache.initialStateValue;\n    },\n    enumerable: false,\n    configurable: true\n  });\n\n  StateNode.prototype.getInitialState = function (stateValue, context) {\n    var configuration = this.getStateNodes(stateValue);\n    return this.resolveTransition({\n      configuration: configuration,\n      entrySet: configuration,\n      exitSet: [],\n      transitions: [],\n      source: undefined,\n      actions: []\n    }, undefined, undefined, context);\n  };\n\n  Object.defineProperty(StateNode.prototype, \"initialState\", {\n    /**\r\n     * The initial State instance, which includes all actions to be executed from\r\n     * entering the initial state.\r\n     */\n    get: function () {\n      this._init(); // TODO: this should be in the constructor (see note in constructor)\n\n\n      var initialStateValue = this.initialStateValue;\n\n      if (!initialStateValue) {\n        throw new Error(\"Cannot retrieve initial state from simple state '\" + this.id + \"'.\");\n      }\n\n      return this.getInitialState(initialStateValue);\n    },\n    enumerable: false,\n    configurable: true\n  });\n  Object.defineProperty(StateNode.prototype, \"target\", {\n    /**\r\n     * The target state value of the history state node, if it exists. This represents the\r\n     * default state value to transition to if no history value exists yet.\r\n     */\n    get: function () {\n      var target;\n\n      if (this.type === 'history') {\n        var historyConfig = this.config;\n\n        if (isString(historyConfig.target)) {\n          target = isStateId(historyConfig.target) ? pathToStateValue(this.machine.getStateNodeById(historyConfig.target).path.slice(this.path.length - 1)) : historyConfig.target;\n        } else {\n          target = historyConfig.target;\n        }\n      }\n\n      return target;\n    },\n    enumerable: false,\n    configurable: true\n  });\n  /**\r\n   * Returns the leaf nodes from a state path relative to this state node.\r\n   *\r\n   * @param relativeStateId The relative state path to retrieve the state nodes\r\n   * @param history The previous state to retrieve history\r\n   * @param resolve Whether state nodes should resolve to initial child state nodes\r\n   */\n\n  StateNode.prototype.getRelativeStateNodes = function (relativeStateId, historyValue, resolve) {\n    if (resolve === void 0) {\n      resolve = true;\n    }\n\n    return resolve ? relativeStateId.type === 'history' ? relativeStateId.resolveHistory(historyValue) : relativeStateId.initialStateNodes : [relativeStateId];\n  };\n\n  Object.defineProperty(StateNode.prototype, \"initialStateNodes\", {\n    get: function () {\n      var _this = this;\n\n      if (isLeafNode(this)) {\n        return [this];\n      } // Case when state node is compound but no initial state is defined\n\n\n      if (this.type === 'compound' && !this.initial) {\n        if (!IS_PRODUCTION) {\n          warn(false, \"Compound state node '\" + this.id + \"' has no initial state.\");\n        }\n\n        return [this];\n      }\n\n      var initialStateNodePaths = toStatePaths(this.initialStateValue);\n      return flatten(initialStateNodePaths.map(function (initialPath) {\n        return _this.getFromRelativePath(initialPath);\n      }));\n    },\n    enumerable: false,\n    configurable: true\n  });\n  /**\r\n   * Retrieves state nodes from a relative path to this state node.\r\n   *\r\n   * @param relativePath The relative path from this state node\r\n   * @param historyValue\r\n   */\n\n  StateNode.prototype.getFromRelativePath = function (relativePath) {\n    if (!relativePath.length) {\n      return [this];\n    }\n\n    var _a = __read(relativePath),\n        stateKey = _a[0],\n        childStatePath = _a.slice(1);\n\n    if (!this.states) {\n      throw new Error(\"Cannot retrieve subPath '\" + stateKey + \"' from node with no states\");\n    }\n\n    var childStateNode = this.getStateNode(stateKey);\n\n    if (childStateNode.type === 'history') {\n      return childStateNode.resolveHistory();\n    }\n\n    if (!this.states[stateKey]) {\n      throw new Error(\"Child state '\" + stateKey + \"' does not exist on '\" + this.id + \"'\");\n    }\n\n    return this.states[stateKey].getFromRelativePath(childStatePath);\n  };\n\n  StateNode.prototype.historyValue = function (relativeStateValue) {\n    if (!keys(this.states).length) {\n      return undefined;\n    }\n\n    return {\n      current: relativeStateValue || this.initialStateValue,\n      states: mapFilterValues(this.states, function (stateNode, key) {\n        if (!relativeStateValue) {\n          return stateNode.historyValue();\n        }\n\n        var subStateValue = isString(relativeStateValue) ? undefined : relativeStateValue[key];\n        return stateNode.historyValue(subStateValue || stateNode.initialStateValue);\n      }, function (stateNode) {\n        return !stateNode.history;\n      })\n    };\n  };\n  /**\r\n   * Resolves to the historical value(s) of the parent state node,\r\n   * represented by state nodes.\r\n   *\r\n   * @param historyValue\r\n   */\n\n\n  StateNode.prototype.resolveHistory = function (historyValue) {\n    var _this = this;\n\n    if (this.type !== 'history') {\n      return [this];\n    }\n\n    var parent = this.parent;\n\n    if (!historyValue) {\n      var historyTarget = this.target;\n      return historyTarget ? flatten(toStatePaths(historyTarget).map(function (relativeChildPath) {\n        return parent.getFromRelativePath(relativeChildPath);\n      })) : parent.initialStateNodes;\n    }\n\n    var subHistoryValue = nestedPath(parent.path, 'states')(historyValue).current;\n\n    if (isString(subHistoryValue)) {\n      return [parent.getStateNode(subHistoryValue)];\n    }\n\n    return flatten(toStatePaths(subHistoryValue).map(function (subStatePath) {\n      return _this.history === 'deep' ? parent.getFromRelativePath(subStatePath) : [parent.states[subStatePath[0]]];\n    }));\n  };\n\n  Object.defineProperty(StateNode.prototype, \"stateIds\", {\n    /**\r\n     * All the state node IDs of this state node and its descendant state nodes.\r\n     */\n    get: function () {\n      var _this = this;\n\n      var childStateIds = flatten(keys(this.states).map(function (stateKey) {\n        return _this.states[stateKey].stateIds;\n      }));\n      return [this.id].concat(childStateIds);\n    },\n    enumerable: false,\n    configurable: true\n  });\n  Object.defineProperty(StateNode.prototype, \"events\", {\n    /**\r\n     * All the event types accepted by this state node and its descendants.\r\n     */\n    get: function () {\n      var e_7, _a, e_8, _b;\n\n      if (this.__cache.events) {\n        return this.__cache.events;\n      }\n\n      var states = this.states;\n      var events = new Set(this.ownEvents);\n\n      if (states) {\n        try {\n          for (var _c = __values(keys(states)), _d = _c.next(); !_d.done; _d = _c.next()) {\n            var stateId = _d.value;\n            var state = states[stateId];\n\n            if (state.states) {\n              try {\n                for (var _e = (e_8 = void 0, __values(state.events)), _f = _e.next(); !_f.done; _f = _e.next()) {\n                  var event_1 = _f.value;\n                  events.add(\"\" + event_1);\n                }\n              } catch (e_8_1) {\n                e_8 = {\n                  error: e_8_1\n                };\n              } finally {\n                try {\n                  if (_f && !_f.done && (_b = _e.return)) _b.call(_e);\n                } finally {\n                  if (e_8) throw e_8.error;\n                }\n              }\n            }\n          }\n        } catch (e_7_1) {\n          e_7 = {\n            error: e_7_1\n          };\n        } finally {\n          try {\n            if (_d && !_d.done && (_a = _c.return)) _a.call(_c);\n          } finally {\n            if (e_7) throw e_7.error;\n          }\n        }\n      }\n\n      return this.__cache.events = Array.from(events);\n    },\n    enumerable: false,\n    configurable: true\n  });\n  Object.defineProperty(StateNode.prototype, \"ownEvents\", {\n    /**\r\n     * All the events that have transitions directly from this state node.\r\n     *\r\n     * Excludes any inert events.\r\n     */\n    get: function () {\n      var events = new Set(this.transitions.filter(function (transition) {\n        return !(!transition.target && !transition.actions.length && transition.internal);\n      }).map(function (transition) {\n        return transition.eventType;\n      }));\n      return Array.from(events);\n    },\n    enumerable: false,\n    configurable: true\n  });\n\n  StateNode.prototype.resolveTarget = function (_target) {\n    var _this = this;\n\n    if (_target === undefined) {\n      // an undefined target signals that the state node should not transition from that state when receiving that event\n      return undefined;\n    }\n\n    return _target.map(function (target) {\n      if (!isString(target)) {\n        return target;\n      }\n\n      var isInternalTarget = target[0] === _this.delimiter; // If internal target is defined on machine,\n      // do not include machine key on target\n\n      if (isInternalTarget && !_this.parent) {\n        return _this.getStateNodeByPath(target.slice(1));\n      }\n\n      var resolvedTarget = isInternalTarget ? _this.key + target : target;\n\n      if (_this.parent) {\n        try {\n          var targetStateNode = _this.parent.getStateNodeByPath(resolvedTarget);\n\n          return targetStateNode;\n        } catch (err) {\n          throw new Error(\"Invalid transition definition for state node '\" + _this.id + \"':\\n\" + err.message);\n        }\n      } else {\n        return _this.getStateNodeByPath(resolvedTarget);\n      }\n    });\n  };\n\n  StateNode.prototype.formatTransition = function (transitionConfig) {\n    var _this = this;\n\n    var normalizedTarget = normalizeTarget(transitionConfig.target);\n    var internal = 'internal' in transitionConfig ? transitionConfig.internal : normalizedTarget ? normalizedTarget.some(function (_target) {\n      return isString(_target) && _target[0] === _this.delimiter;\n    }) : true;\n    var guards = this.machine.options.guards;\n    var target = this.resolveTarget(normalizedTarget);\n\n    var transition = __assign(__assign({}, transitionConfig), {\n      actions: toActionObjects(toArray(transitionConfig.actions)),\n      cond: toGuard(transitionConfig.cond, guards),\n      target: target,\n      source: this,\n      internal: internal,\n      eventType: transitionConfig.event,\n      toJSON: function () {\n        return __assign(__assign({}, transition), {\n          target: transition.target ? transition.target.map(function (t) {\n            return \"#\" + t.id;\n          }) : undefined,\n          source: \"#\" + _this.id\n        });\n      }\n    });\n\n    return transition;\n  };\n\n  StateNode.prototype.formatTransitions = function () {\n    var e_9, _a;\n\n    var _this = this;\n\n    var onConfig;\n\n    if (!this.config.on) {\n      onConfig = [];\n    } else if (Array.isArray(this.config.on)) {\n      onConfig = this.config.on;\n    } else {\n      var _b = this.config.on,\n          _c = WILDCARD,\n          _d = _b[_c],\n          wildcardConfigs = _d === void 0 ? [] : _d,\n          strictTransitionConfigs_1 = __rest(_b, [typeof _c === \"symbol\" ? _c : _c + \"\"]);\n\n      onConfig = flatten(keys(strictTransitionConfigs_1).map(function (key) {\n        if (!IS_PRODUCTION && key === NULL_EVENT) {\n          warn(false, \"Empty string transition configs (e.g., `{ on: { '': ... }}`) for transient transitions are deprecated. Specify the transition in the `{ always: ... }` property instead. \" + (\"Please check the `on` configuration for \\\"#\" + _this.id + \"\\\".\"));\n        }\n\n        var transitionConfigArray = toTransitionConfigArray(key, strictTransitionConfigs_1[key]);\n\n        if (!IS_PRODUCTION) {\n          validateArrayifiedTransitions(_this, key, transitionConfigArray);\n        }\n\n        return transitionConfigArray;\n      }).concat(toTransitionConfigArray(WILDCARD, wildcardConfigs)));\n    }\n\n    var eventlessConfig = this.config.always ? toTransitionConfigArray('', this.config.always) : [];\n    var doneConfig = this.config.onDone ? toTransitionConfigArray(String(done(this.id)), this.config.onDone) : [];\n\n    if (!IS_PRODUCTION) {\n      warn(!(this.config.onDone && !this.parent), \"Root nodes cannot have an \\\".onDone\\\" transition. Please check the config of \\\"\" + this.id + \"\\\".\");\n    }\n\n    var invokeConfig = flatten(this.invoke.map(function (invokeDef) {\n      var settleTransitions = [];\n\n      if (invokeDef.onDone) {\n        settleTransitions.push.apply(settleTransitions, __spreadArray([], __read(toTransitionConfigArray(String(doneInvoke(invokeDef.id)), invokeDef.onDone))));\n      }\n\n      if (invokeDef.onError) {\n        settleTransitions.push.apply(settleTransitions, __spreadArray([], __read(toTransitionConfigArray(String(error(invokeDef.id)), invokeDef.onError))));\n      }\n\n      return settleTransitions;\n    }));\n    var delayedTransitions = this.after;\n    var formattedTransitions = flatten(__spreadArray(__spreadArray(__spreadArray(__spreadArray([], __read(doneConfig)), __read(invokeConfig)), __read(onConfig)), __read(eventlessConfig)).map(function (transitionConfig) {\n      return toArray(transitionConfig).map(function (transition) {\n        return _this.formatTransition(transition);\n      });\n    }));\n\n    try {\n      for (var delayedTransitions_1 = __values(delayedTransitions), delayedTransitions_1_1 = delayedTransitions_1.next(); !delayedTransitions_1_1.done; delayedTransitions_1_1 = delayedTransitions_1.next()) {\n        var delayedTransition = delayedTransitions_1_1.value;\n        formattedTransitions.push(delayedTransition);\n      }\n    } catch (e_9_1) {\n      e_9 = {\n        error: e_9_1\n      };\n    } finally {\n      try {\n        if (delayedTransitions_1_1 && !delayedTransitions_1_1.done && (_a = delayedTransitions_1.return)) _a.call(delayedTransitions_1);\n      } finally {\n        if (e_9) throw e_9.error;\n      }\n    }\n\n    return formattedTransitions;\n  };\n\n  return StateNode;\n}();\n\nexport { StateNode };\n","import { StateNode } from './StateNode.js';\n\nfunction Machine(config, options, initialContext) {\n  if (initialContext === void 0) {\n    initialContext = config.context;\n  }\n\n  return new StateNode(config, options, initialContext);\n}\nfunction createMachine(config, options) {\n  return new StateNode(config, options);\n}\n\nexport { Machine, createMachine };\n","import { __assign } from './_virtual/_tslib.js';\n\nvar defaultOptions = {\n  deferEvents: false\n};\n\nvar Scheduler =\n/*#__PURE__*/\n\n/** @class */\nfunction () {\n  function Scheduler(options) {\n    this.processingEvent = false;\n    this.queue = [];\n    this.initialized = false;\n    this.options = __assign(__assign({}, defaultOptions), options);\n  }\n\n  Scheduler.prototype.initialize = function (callback) {\n    this.initialized = true;\n\n    if (callback) {\n      if (!this.options.deferEvents) {\n        this.schedule(callback);\n        return;\n      }\n\n      this.process(callback);\n    }\n\n    this.flushEvents();\n  };\n\n  Scheduler.prototype.schedule = function (task) {\n    if (!this.initialized || this.processingEvent) {\n      this.queue.push(task);\n      return;\n    }\n\n    if (this.queue.length !== 0) {\n      throw new Error('Event queue should be empty when it is not processing events');\n    }\n\n    this.process(task);\n    this.flushEvents();\n  };\n\n  Scheduler.prototype.clear = function () {\n    this.queue = [];\n  };\n\n  Scheduler.prototype.flushEvents = function () {\n    var nextCallback = this.queue.shift();\n\n    while (nextCallback) {\n      this.process(nextCallback);\n      nextCallback = this.queue.shift();\n    }\n  };\n\n  Scheduler.prototype.process = function (callback) {\n    this.processingEvent = true;\n\n    try {\n      callback();\n    } catch (e) {\n      // there is no use to keep the future events\n      // as the situation is not anymore the same\n      this.clear();\n      throw e;\n    } finally {\n      this.processingEvent = false;\n    }\n  };\n\n  return Scheduler;\n}();\n\nexport { Scheduler };\n","var children = /*#__PURE__*/new Map();\nvar sessionIdIndex = 0;\nvar registry = {\n  bookId: function () {\n    return \"x:\" + sessionIdIndex++;\n  },\n  register: function (id, actor) {\n    children.set(id, actor);\n    return id;\n  },\n  get: function (id) {\n    return children.get(id);\n  },\n  free: function (id) {\n    children.delete(id);\n  }\n};\n\nexport { registry };\n","// From https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/globalThis\nfunction getGlobal() {\n  if (typeof self !== 'undefined') {\n    return self;\n  }\n\n  if (typeof window !== 'undefined') {\n    return window;\n  }\n\n  if (typeof global !== 'undefined') {\n    return global;\n  }\n\n  return undefined;\n}\n\nfunction getDevTools() {\n  var global = getGlobal();\n\n  if (global && '__xstate__' in global) {\n    return global.__xstate__;\n  }\n\n  return undefined;\n}\n\nfunction registerService(service) {\n  if (!getGlobal()) {\n    return;\n  }\n\n  var devTools = getDevTools();\n\n  if (devTools) {\n    devTools.register(service);\n  }\n}\n\nexport { getGlobal, registerService };\n","import './environment.js';\nimport { toObserver } from './utils.js';\nimport './types.js';\nimport './actionTypes.js';\nimport { toActorRef } from './Actor.js';\n\nfunction spawnBehavior(behavior, options) {\n  if (options === void 0) {\n    options = {};\n  }\n\n  var state = behavior.initialState;\n  var observers = new Set();\n  var mailbox = [];\n  var flushing = false;\n\n  var flush = function () {\n    if (flushing) {\n      return;\n    }\n\n    flushing = true;\n\n    while (mailbox.length > 0) {\n      var event_1 = mailbox.shift();\n      state = behavior.transition(state, event_1, actorCtx);\n      observers.forEach(function (observer) {\n        return observer.next(state);\n      });\n    }\n\n    flushing = false;\n  };\n\n  var actor = toActorRef({\n    id: options.id,\n    send: function (event) {\n      mailbox.push(event);\n      flush();\n    },\n    getSnapshot: function () {\n      return state;\n    },\n    subscribe: function (next, handleError, complete) {\n      var observer = toObserver(next, handleError, complete);\n      observers.add(observer);\n      observer.next(state);\n      return {\n        unsubscribe: function () {\n          observers.delete(observer);\n        }\n      };\n    }\n  });\n  var actorCtx = {\n    parent: options.parent,\n    self: actor,\n    id: options.id || 'anonymous',\n    observers: observers\n  };\n  state = behavior.start ? behavior.start(actorCtx) : state;\n  return actor;\n}\n\nexport { spawnBehavior };\n","import { __values, __assign, __spreadArray, __read } from './_virtual/_tslib.js';\nimport { IS_PRODUCTION } from './environment.js';\nimport { warn, mapContext, isFunction, keys, toSCXMLEvent, toInvokeSource, isMachine, isPromiseLike, isObservable, isBehavior, reportUnhandledExceptionOnInvocation, symbolObservable, isArray, toEventObject, isString, isActor, uniqueId, toObserver } from './utils.js';\nimport { ActionTypes, SpecialTargets } from './types.js';\nimport { isInFinalState } from './stateUtils.js';\nimport { errorPlatform, log, stop, start, cancel, send, update, error as error$1 } from './actionTypes.js';\nimport { doneInvoke, initEvent, getActionFunction, error } from './actions.js';\nimport { isState, State, bindActionToState } from './State.js';\nimport { provide, consume } from './serviceScope.js';\nimport { isSpawnedActor, createDeferredActor } from './Actor.js';\nimport { Scheduler } from './scheduler.js';\nimport { registry } from './registry.js';\nimport { registerService, getGlobal } from './devTools.js';\nimport { spawnBehavior } from './behaviors.js';\n\nvar DEFAULT_SPAWN_OPTIONS = {\n  sync: false,\n  autoForward: false\n};\nvar InterpreterStatus;\n\n(function (InterpreterStatus) {\n  InterpreterStatus[InterpreterStatus[\"NotStarted\"] = 0] = \"NotStarted\";\n  InterpreterStatus[InterpreterStatus[\"Running\"] = 1] = \"Running\";\n  InterpreterStatus[InterpreterStatus[\"Stopped\"] = 2] = \"Stopped\";\n})(InterpreterStatus || (InterpreterStatus = {}));\n\nvar Interpreter =\n/*#__PURE__*/\n\n/** @class */\nfunction () {\n  /**\r\n   * Creates a new Interpreter instance (i.e., service) for the given machine with the provided options, if any.\r\n   *\r\n   * @param machine The machine to be interpreted\r\n   * @param options Interpreter options\r\n   */\n  function Interpreter(machine, options) {\n    var _this = this;\n\n    if (options === void 0) {\n      options = Interpreter.defaultOptions;\n    }\n\n    this.machine = machine;\n    this.scheduler = new Scheduler();\n    this.delayedEventsMap = {};\n    this.listeners = new Set();\n    this.contextListeners = new Set();\n    this.stopListeners = new Set();\n    this.doneListeners = new Set();\n    this.eventListeners = new Set();\n    this.sendListeners = new Set();\n    /**\r\n     * Whether the service is started.\r\n     */\n\n    this.initialized = false;\n    this.status = InterpreterStatus.NotStarted;\n    this.children = new Map();\n    this.forwardTo = new Set();\n    /**\r\n     * Alias for Interpreter.prototype.start\r\n     */\n\n    this.init = this.start;\n    /**\r\n     * Sends an event to the running interpreter to trigger a transition.\r\n     *\r\n     * An array of events (batched) can be sent as well, which will send all\r\n     * batched events to the running interpreter. The listeners will be\r\n     * notified only **once** when all events are processed.\r\n     *\r\n     * @param event The event(s) to send\r\n     */\n\n    this.send = function (event, payload) {\n      if (isArray(event)) {\n        _this.batch(event);\n\n        return _this.state;\n      }\n\n      var _event = toSCXMLEvent(toEventObject(event, payload));\n\n      if (_this.status === InterpreterStatus.Stopped) {\n        // do nothing\n        if (!IS_PRODUCTION) {\n          warn(false, \"Event \\\"\" + _event.name + \"\\\" was sent to stopped service \\\"\" + _this.machine.id + \"\\\". This service has already reached its final state, and will not transition.\\nEvent: \" + JSON.stringify(_event.data));\n        }\n\n        return _this.state;\n      }\n\n      if (_this.status !== InterpreterStatus.Running && !_this.options.deferEvents) {\n        throw new Error(\"Event \\\"\" + _event.name + \"\\\" was sent to uninitialized service \\\"\" + _this.machine.id + \"\\\". Make sure .start() is called for this service, or set { deferEvents: true } in the service options.\\nEvent: \" + JSON.stringify(_event.data));\n      }\n\n      _this.scheduler.schedule(function () {\n        // Forward copy of event to child actors\n        _this.forward(_event);\n\n        var nextState = _this.nextState(_event);\n\n        _this.update(nextState, _event);\n      });\n\n      return _this._state; // TODO: deprecate (should return void)\n      // tslint:disable-next-line:semicolon\n    };\n\n    this.sendTo = function (event, to) {\n      var isParent = _this.parent && (to === SpecialTargets.Parent || _this.parent.id === to);\n      var target = isParent ? _this.parent : isString(to) ? _this.children.get(to) || registry.get(to) : isActor(to) ? to : undefined;\n\n      if (!target) {\n        if (!isParent) {\n          throw new Error(\"Unable to send event to child '\" + to + \"' from service '\" + _this.id + \"'.\");\n        } // tslint:disable-next-line:no-console\n\n\n        if (!IS_PRODUCTION) {\n          warn(false, \"Service '\" + _this.id + \"' has no parent: unable to send event \" + event.type);\n        }\n\n        return;\n      }\n\n      if ('machine' in target) {\n        // Send SCXML events to machines\n        target.send(__assign(__assign({}, event), {\n          name: event.name === error$1 ? \"\" + error(_this.id) : event.name,\n          origin: _this.sessionId\n        }));\n      } else {\n        // Send normal events to other targets\n        target.send(event.data);\n      }\n    };\n\n    var resolvedOptions = __assign(__assign({}, Interpreter.defaultOptions), options);\n\n    var clock = resolvedOptions.clock,\n        logger = resolvedOptions.logger,\n        parent = resolvedOptions.parent,\n        id = resolvedOptions.id;\n    var resolvedId = id !== undefined ? id : machine.id;\n    this.id = resolvedId;\n    this.logger = logger;\n    this.clock = clock;\n    this.parent = parent;\n    this.options = resolvedOptions;\n    this.scheduler = new Scheduler({\n      deferEvents: this.options.deferEvents\n    });\n    this.sessionId = registry.bookId();\n  }\n\n  Object.defineProperty(Interpreter.prototype, \"initialState\", {\n    get: function () {\n      var _this = this;\n\n      if (this._initialState) {\n        return this._initialState;\n      }\n\n      return provide(this, function () {\n        _this._initialState = _this.machine.initialState;\n        return _this._initialState;\n      });\n    },\n    enumerable: false,\n    configurable: true\n  });\n  Object.defineProperty(Interpreter.prototype, \"state\", {\n    get: function () {\n      if (!IS_PRODUCTION) {\n        warn(this.status !== InterpreterStatus.NotStarted, \"Attempted to read state from uninitialized service '\" + this.id + \"'. Make sure the service is started first.\");\n      }\n\n      return this._state;\n    },\n    enumerable: false,\n    configurable: true\n  });\n  /**\r\n   * Executes the actions of the given state, with that state's `context` and `event`.\r\n   *\r\n   * @param state The state whose actions will be executed\r\n   * @param actionsConfig The action implementations to use\r\n   */\n\n  Interpreter.prototype.execute = function (state, actionsConfig) {\n    var e_1, _a;\n\n    try {\n      for (var _b = __values(state.actions), _c = _b.next(); !_c.done; _c = _b.next()) {\n        var action = _c.value;\n        this.exec(action, state, actionsConfig);\n      }\n    } catch (e_1_1) {\n      e_1 = {\n        error: e_1_1\n      };\n    } finally {\n      try {\n        if (_c && !_c.done && (_a = _b.return)) _a.call(_b);\n      } finally {\n        if (e_1) throw e_1.error;\n      }\n    }\n  };\n\n  Interpreter.prototype.update = function (state, _event) {\n    var e_2, _a, e_3, _b, e_4, _c, e_5, _d;\n\n    var _this = this; // Attach session ID to state\n\n\n    state._sessionid = this.sessionId; // Update state\n\n    this._state = state; // Execute actions\n\n    if (this.options.execute) {\n      this.execute(this.state);\n    } // Update children\n\n\n    this.children.forEach(function (child) {\n      _this.state.children[child.id] = child;\n    }); // Dev tools\n\n    if (this.devTools) {\n      this.devTools.send(_event.data, state);\n    } // Execute listeners\n\n\n    if (state.event) {\n      try {\n        for (var _e = __values(this.eventListeners), _f = _e.next(); !_f.done; _f = _e.next()) {\n          var listener = _f.value;\n          listener(state.event);\n        }\n      } catch (e_2_1) {\n        e_2 = {\n          error: e_2_1\n        };\n      } finally {\n        try {\n          if (_f && !_f.done && (_a = _e.return)) _a.call(_e);\n        } finally {\n          if (e_2) throw e_2.error;\n        }\n      }\n    }\n\n    try {\n      for (var _g = __values(this.listeners), _h = _g.next(); !_h.done; _h = _g.next()) {\n        var listener = _h.value;\n        listener(state, state.event);\n      }\n    } catch (e_3_1) {\n      e_3 = {\n        error: e_3_1\n      };\n    } finally {\n      try {\n        if (_h && !_h.done && (_b = _g.return)) _b.call(_g);\n      } finally {\n        if (e_3) throw e_3.error;\n      }\n    }\n\n    try {\n      for (var _j = __values(this.contextListeners), _k = _j.next(); !_k.done; _k = _j.next()) {\n        var contextListener = _k.value;\n        contextListener(this.state.context, this.state.history ? this.state.history.context : undefined);\n      }\n    } catch (e_4_1) {\n      e_4 = {\n        error: e_4_1\n      };\n    } finally {\n      try {\n        if (_k && !_k.done && (_c = _j.return)) _c.call(_j);\n      } finally {\n        if (e_4) throw e_4.error;\n      }\n    }\n\n    var isDone = isInFinalState(state.configuration || [], this.machine);\n\n    if (this.state.configuration && isDone) {\n      // get final child state node\n      var finalChildStateNode = state.configuration.find(function (sn) {\n        return sn.type === 'final' && sn.parent === _this.machine;\n      });\n      var doneData = finalChildStateNode && finalChildStateNode.doneData ? mapContext(finalChildStateNode.doneData, state.context, _event) : undefined;\n\n      try {\n        for (var _l = __values(this.doneListeners), _m = _l.next(); !_m.done; _m = _l.next()) {\n          var listener = _m.value;\n          listener(doneInvoke(this.id, doneData));\n        }\n      } catch (e_5_1) {\n        e_5 = {\n          error: e_5_1\n        };\n      } finally {\n        try {\n          if (_m && !_m.done && (_d = _l.return)) _d.call(_l);\n        } finally {\n          if (e_5) throw e_5.error;\n        }\n      }\n\n      this.stop();\n    }\n  };\n  /*\r\n   * Adds a listener that is notified whenever a state transition happens. The listener is called with\r\n   * the next state and the event object that caused the state transition.\r\n   *\r\n   * @param listener The state listener\r\n   */\n\n\n  Interpreter.prototype.onTransition = function (listener) {\n    this.listeners.add(listener); // Send current state to listener\n\n    if (this.status === InterpreterStatus.Running) {\n      listener(this.state, this.state.event);\n    }\n\n    return this;\n  };\n\n  Interpreter.prototype.subscribe = function (nextListenerOrObserver, _, // TODO: error listener\n  completeListener) {\n    var _this = this;\n\n    if (!nextListenerOrObserver) {\n      return {\n        unsubscribe: function () {\n          return void 0;\n        }\n      };\n    }\n\n    var listener;\n    var resolvedCompleteListener = completeListener;\n\n    if (typeof nextListenerOrObserver === 'function') {\n      listener = nextListenerOrObserver;\n    } else {\n      listener = nextListenerOrObserver.next.bind(nextListenerOrObserver);\n      resolvedCompleteListener = nextListenerOrObserver.complete.bind(nextListenerOrObserver);\n    }\n\n    this.listeners.add(listener); // Send current state to listener\n\n    if (this.status === InterpreterStatus.Running) {\n      listener(this.state);\n    }\n\n    if (resolvedCompleteListener) {\n      this.onDone(resolvedCompleteListener);\n    }\n\n    return {\n      unsubscribe: function () {\n        listener && _this.listeners.delete(listener);\n        resolvedCompleteListener && _this.doneListeners.delete(resolvedCompleteListener);\n      }\n    };\n  };\n  /**\r\n   * Adds an event listener that is notified whenever an event is sent to the running interpreter.\r\n   * @param listener The event listener\r\n   */\n\n\n  Interpreter.prototype.onEvent = function (listener) {\n    this.eventListeners.add(listener);\n    return this;\n  };\n  /**\r\n   * Adds an event listener that is notified whenever a `send` event occurs.\r\n   * @param listener The event listener\r\n   */\n\n\n  Interpreter.prototype.onSend = function (listener) {\n    this.sendListeners.add(listener);\n    return this;\n  };\n  /**\r\n   * Adds a context listener that is notified whenever the state context changes.\r\n   * @param listener The context listener\r\n   */\n\n\n  Interpreter.prototype.onChange = function (listener) {\n    this.contextListeners.add(listener);\n    return this;\n  };\n  /**\r\n   * Adds a listener that is notified when the machine is stopped.\r\n   * @param listener The listener\r\n   */\n\n\n  Interpreter.prototype.onStop = function (listener) {\n    this.stopListeners.add(listener);\n    return this;\n  };\n  /**\r\n   * Adds a state listener that is notified when the statechart has reached its final state.\r\n   * @param listener The state listener\r\n   */\n\n\n  Interpreter.prototype.onDone = function (listener) {\n    this.doneListeners.add(listener);\n    return this;\n  };\n  /**\r\n   * Removes a listener.\r\n   * @param listener The listener to remove\r\n   */\n\n\n  Interpreter.prototype.off = function (listener) {\n    this.listeners.delete(listener);\n    this.eventListeners.delete(listener);\n    this.sendListeners.delete(listener);\n    this.stopListeners.delete(listener);\n    this.doneListeners.delete(listener);\n    this.contextListeners.delete(listener);\n    return this;\n  };\n  /**\r\n   * Starts the interpreter from the given state, or the initial state.\r\n   * @param initialState The state to start the statechart from\r\n   */\n\n\n  Interpreter.prototype.start = function (initialState) {\n    var _this = this;\n\n    if (this.status === InterpreterStatus.Running) {\n      // Do not restart the service if it is already started\n      return this;\n    }\n\n    registry.register(this.sessionId, this);\n    this.initialized = true;\n    this.status = InterpreterStatus.Running;\n    var resolvedState = initialState === undefined ? this.initialState : provide(this, function () {\n      return isState(initialState) ? _this.machine.resolveState(initialState) : _this.machine.resolveState(State.from(initialState, _this.machine.context));\n    });\n\n    if (this.options.devTools) {\n      this.attachDev();\n    }\n\n    this.scheduler.initialize(function () {\n      _this.update(resolvedState, initEvent);\n    });\n    return this;\n  };\n  /**\r\n   * Stops the interpreter and unsubscribe all listeners.\r\n   *\r\n   * This will also notify the `onStop` listeners.\r\n   */\n\n\n  Interpreter.prototype.stop = function () {\n    var e_6, _a, e_7, _b, e_8, _c, e_9, _d, e_10, _e;\n\n    var _this = this;\n\n    try {\n      for (var _f = __values(this.listeners), _g = _f.next(); !_g.done; _g = _f.next()) {\n        var listener = _g.value;\n        this.listeners.delete(listener);\n      }\n    } catch (e_6_1) {\n      e_6 = {\n        error: e_6_1\n      };\n    } finally {\n      try {\n        if (_g && !_g.done && (_a = _f.return)) _a.call(_f);\n      } finally {\n        if (e_6) throw e_6.error;\n      }\n    }\n\n    try {\n      for (var _h = __values(this.stopListeners), _j = _h.next(); !_j.done; _j = _h.next()) {\n        var listener = _j.value; // call listener, then remove\n\n        listener();\n        this.stopListeners.delete(listener);\n      }\n    } catch (e_7_1) {\n      e_7 = {\n        error: e_7_1\n      };\n    } finally {\n      try {\n        if (_j && !_j.done && (_b = _h.return)) _b.call(_h);\n      } finally {\n        if (e_7) throw e_7.error;\n      }\n    }\n\n    try {\n      for (var _k = __values(this.contextListeners), _l = _k.next(); !_l.done; _l = _k.next()) {\n        var listener = _l.value;\n        this.contextListeners.delete(listener);\n      }\n    } catch (e_8_1) {\n      e_8 = {\n        error: e_8_1\n      };\n    } finally {\n      try {\n        if (_l && !_l.done && (_c = _k.return)) _c.call(_k);\n      } finally {\n        if (e_8) throw e_8.error;\n      }\n    }\n\n    try {\n      for (var _m = __values(this.doneListeners), _o = _m.next(); !_o.done; _o = _m.next()) {\n        var listener = _o.value;\n        this.doneListeners.delete(listener);\n      }\n    } catch (e_9_1) {\n      e_9 = {\n        error: e_9_1\n      };\n    } finally {\n      try {\n        if (_o && !_o.done && (_d = _m.return)) _d.call(_m);\n      } finally {\n        if (e_9) throw e_9.error;\n      }\n    }\n\n    if (!this.initialized) {\n      // Interpreter already stopped; do nothing\n      return this;\n    }\n\n    this.state.configuration.forEach(function (stateNode) {\n      var e_11, _a;\n\n      try {\n        for (var _b = __values(stateNode.definition.exit), _c = _b.next(); !_c.done; _c = _b.next()) {\n          var action = _c.value;\n\n          _this.exec(action, _this.state);\n        }\n      } catch (e_11_1) {\n        e_11 = {\n          error: e_11_1\n        };\n      } finally {\n        try {\n          if (_c && !_c.done && (_a = _b.return)) _a.call(_b);\n        } finally {\n          if (e_11) throw e_11.error;\n        }\n      }\n    }); // Stop all children\n\n    this.children.forEach(function (child) {\n      if (isFunction(child.stop)) {\n        child.stop();\n      }\n    });\n\n    try {\n      // Cancel all delayed events\n      for (var _p = __values(keys(this.delayedEventsMap)), _q = _p.next(); !_q.done; _q = _p.next()) {\n        var key = _q.value;\n        this.clock.clearTimeout(this.delayedEventsMap[key]);\n      }\n    } catch (e_10_1) {\n      e_10 = {\n        error: e_10_1\n      };\n    } finally {\n      try {\n        if (_q && !_q.done && (_e = _p.return)) _e.call(_p);\n      } finally {\n        if (e_10) throw e_10.error;\n      }\n    }\n\n    this.scheduler.clear();\n    this.initialized = false;\n    this.status = InterpreterStatus.Stopped;\n    registry.free(this.sessionId);\n    return this;\n  };\n\n  Interpreter.prototype.batch = function (events) {\n    var _this = this;\n\n    if (this.status === InterpreterStatus.NotStarted && this.options.deferEvents) {\n      // tslint:disable-next-line:no-console\n      if (!IS_PRODUCTION) {\n        warn(false, events.length + \" event(s) were sent to uninitialized service \\\"\" + this.machine.id + \"\\\" and are deferred. Make sure .start() is called for this service.\\nEvent: \" + JSON.stringify(event));\n      }\n    } else if (this.status !== InterpreterStatus.Running) {\n      throw new Error( // tslint:disable-next-line:max-line-length\n      events.length + \" event(s) were sent to uninitialized service \\\"\" + this.machine.id + \"\\\". Make sure .start() is called for this service, or set { deferEvents: true } in the service options.\");\n    }\n\n    this.scheduler.schedule(function () {\n      var e_12, _a;\n\n      var nextState = _this.state;\n      var batchChanged = false;\n      var batchedActions = [];\n\n      var _loop_1 = function (event_1) {\n        var _event = toSCXMLEvent(event_1);\n\n        _this.forward(_event);\n\n        nextState = provide(_this, function () {\n          return _this.machine.transition(nextState, _event);\n        });\n        batchedActions.push.apply(batchedActions, __spreadArray([], __read(nextState.actions.map(function (a) {\n          return bindActionToState(a, nextState);\n        }))));\n        batchChanged = batchChanged || !!nextState.changed;\n      };\n\n      try {\n        for (var events_1 = __values(events), events_1_1 = events_1.next(); !events_1_1.done; events_1_1 = events_1.next()) {\n          var event_1 = events_1_1.value;\n\n          _loop_1(event_1);\n        }\n      } catch (e_12_1) {\n        e_12 = {\n          error: e_12_1\n        };\n      } finally {\n        try {\n          if (events_1_1 && !events_1_1.done && (_a = events_1.return)) _a.call(events_1);\n        } finally {\n          if (e_12) throw e_12.error;\n        }\n      }\n\n      nextState.changed = batchChanged;\n      nextState.actions = batchedActions;\n\n      _this.update(nextState, toSCXMLEvent(events[events.length - 1]));\n    });\n  };\n  /**\r\n   * Returns a send function bound to this interpreter instance.\r\n   *\r\n   * @param event The event to be sent by the sender.\r\n   */\n\n\n  Interpreter.prototype.sender = function (event) {\n    return this.send.bind(this, event);\n  };\n  /**\r\n   * Returns the next state given the interpreter's current state and the event.\r\n   *\r\n   * This is a pure method that does _not_ update the interpreter's state.\r\n   *\r\n   * @param event The event to determine the next state\r\n   */\n\n\n  Interpreter.prototype.nextState = function (event) {\n    var _this = this;\n\n    var _event = toSCXMLEvent(event);\n\n    if (_event.name.indexOf(errorPlatform) === 0 && !this.state.nextEvents.some(function (nextEvent) {\n      return nextEvent.indexOf(errorPlatform) === 0;\n    })) {\n      throw _event.data.data;\n    }\n\n    var nextState = provide(this, function () {\n      return _this.machine.transition(_this.state, _event);\n    });\n    return nextState;\n  };\n\n  Interpreter.prototype.forward = function (event) {\n    var e_13, _a;\n\n    try {\n      for (var _b = __values(this.forwardTo), _c = _b.next(); !_c.done; _c = _b.next()) {\n        var id = _c.value;\n        var child = this.children.get(id);\n\n        if (!child) {\n          throw new Error(\"Unable to forward event '\" + event + \"' from interpreter '\" + this.id + \"' to nonexistant child '\" + id + \"'.\");\n        }\n\n        child.send(event);\n      }\n    } catch (e_13_1) {\n      e_13 = {\n        error: e_13_1\n      };\n    } finally {\n      try {\n        if (_c && !_c.done && (_a = _b.return)) _a.call(_b);\n      } finally {\n        if (e_13) throw e_13.error;\n      }\n    }\n  };\n\n  Interpreter.prototype.defer = function (sendAction) {\n    var _this = this;\n\n    this.delayedEventsMap[sendAction.id] = this.clock.setTimeout(function () {\n      if (sendAction.to) {\n        _this.sendTo(sendAction._event, sendAction.to);\n      } else {\n        _this.send(sendAction._event);\n      }\n    }, sendAction.delay);\n  };\n\n  Interpreter.prototype.cancel = function (sendId) {\n    this.clock.clearTimeout(this.delayedEventsMap[sendId]);\n    delete this.delayedEventsMap[sendId];\n  };\n\n  Interpreter.prototype.exec = function (action, state, actionFunctionMap) {\n    if (actionFunctionMap === void 0) {\n      actionFunctionMap = this.machine.options.actions;\n    }\n\n    var context = state.context,\n        _event = state._event;\n    var actionOrExec = action.exec || getActionFunction(action.type, actionFunctionMap);\n    var exec = isFunction(actionOrExec) ? actionOrExec : actionOrExec ? actionOrExec.exec : action.exec;\n\n    if (exec) {\n      try {\n        return exec(context, _event.data, {\n          action: action,\n          state: this.state,\n          _event: _event\n        });\n      } catch (err) {\n        if (this.parent) {\n          this.parent.send({\n            type: 'xstate.error',\n            data: err\n          });\n        }\n\n        throw err;\n      }\n    }\n\n    switch (action.type) {\n      case send:\n        var sendAction = action;\n\n        if (typeof sendAction.delay === 'number') {\n          this.defer(sendAction);\n          return;\n        } else {\n          if (sendAction.to) {\n            this.sendTo(sendAction._event, sendAction.to);\n          } else {\n            this.send(sendAction._event);\n          }\n        }\n\n        break;\n\n      case cancel:\n        this.cancel(action.sendId);\n        break;\n\n      case start:\n        {\n          var activity = action.activity; // If the activity will be stopped right after it's started\n          // (such as in transient states)\n          // don't bother starting the activity.\n\n          if (!this.state.activities[activity.id || activity.type]) {\n            break;\n          } // Invoked services\n\n\n          if (activity.type === ActionTypes.Invoke) {\n            var invokeSource = toInvokeSource(activity.src);\n            var serviceCreator = this.machine.options.services ? this.machine.options.services[invokeSource.type] : undefined;\n            var id = activity.id,\n                data = activity.data;\n\n            if (!IS_PRODUCTION) {\n              warn(!('forward' in activity), // tslint:disable-next-line:max-line-length\n              \"`forward` property is deprecated (found in invocation of '\" + activity.src + \"' in in machine '\" + this.machine.id + \"'). \" + \"Please use `autoForward` instead.\");\n            }\n\n            var autoForward = 'autoForward' in activity ? activity.autoForward : !!activity.forward;\n\n            if (!serviceCreator) {\n              // tslint:disable-next-line:no-console\n              if (!IS_PRODUCTION) {\n                warn(false, \"No service found for invocation '\" + activity.src + \"' in machine '\" + this.machine.id + \"'.\");\n              }\n\n              return;\n            }\n\n            var resolvedData = data ? mapContext(data, context, _event) : undefined;\n\n            if (typeof serviceCreator === 'string') {\n              // TODO: warn\n              return;\n            }\n\n            var source = isFunction(serviceCreator) ? serviceCreator(context, _event.data, {\n              data: resolvedData,\n              src: invokeSource\n            }) : serviceCreator;\n\n            if (!source) {\n              // TODO: warn?\n              return;\n            }\n\n            var options = void 0;\n\n            if (isMachine(source)) {\n              source = resolvedData ? source.withContext(resolvedData) : source;\n              options = {\n                autoForward: autoForward\n              };\n            }\n\n            this.spawn(source, id, options);\n          } else {\n            this.spawnActivity(activity);\n          }\n\n          break;\n        }\n\n      case stop:\n        {\n          this.stopChild(action.activity.id);\n          break;\n        }\n\n      case log:\n        var label = action.label,\n            value = action.value;\n\n        if (label) {\n          this.logger(label, value);\n        } else {\n          this.logger(value);\n        }\n\n        break;\n\n      default:\n        if (!IS_PRODUCTION) {\n          warn(false, \"No implementation found for action type '\" + action.type + \"'\");\n        }\n\n        break;\n    }\n\n    return undefined;\n  };\n\n  Interpreter.prototype.removeChild = function (childId) {\n    var _a;\n\n    this.children.delete(childId);\n    this.forwardTo.delete(childId); // this.state might not exist at the time this is called,\n    // such as when a child is added then removed while initializing the state\n\n    (_a = this.state) === null || _a === void 0 ? true : delete _a.children[childId];\n  };\n\n  Interpreter.prototype.stopChild = function (childId) {\n    var child = this.children.get(childId);\n\n    if (!child) {\n      return;\n    }\n\n    this.removeChild(childId);\n\n    if (isFunction(child.stop)) {\n      child.stop();\n    }\n  };\n\n  Interpreter.prototype.spawn = function (entity, name, options) {\n    if (isPromiseLike(entity)) {\n      return this.spawnPromise(Promise.resolve(entity), name);\n    } else if (isFunction(entity)) {\n      return this.spawnCallback(entity, name);\n    } else if (isSpawnedActor(entity)) {\n      return this.spawnActor(entity, name);\n    } else if (isObservable(entity)) {\n      return this.spawnObservable(entity, name);\n    } else if (isMachine(entity)) {\n      return this.spawnMachine(entity, __assign(__assign({}, options), {\n        id: name\n      }));\n    } else if (isBehavior(entity)) {\n      return this.spawnBehavior(entity, name);\n    } else {\n      throw new Error(\"Unable to spawn entity \\\"\" + name + \"\\\" of type \\\"\" + typeof entity + \"\\\".\");\n    }\n  };\n\n  Interpreter.prototype.spawnMachine = function (machine, options) {\n    var _this = this;\n\n    if (options === void 0) {\n      options = {};\n    }\n\n    var childService = new Interpreter(machine, __assign(__assign({}, this.options), {\n      parent: this,\n      id: options.id || machine.id\n    }));\n\n    var resolvedOptions = __assign(__assign({}, DEFAULT_SPAWN_OPTIONS), options);\n\n    if (resolvedOptions.sync) {\n      childService.onTransition(function (state) {\n        _this.send(update, {\n          state: state,\n          id: childService.id\n        });\n      });\n    }\n\n    var actor = childService;\n    this.children.set(childService.id, actor);\n\n    if (resolvedOptions.autoForward) {\n      this.forwardTo.add(childService.id);\n    }\n\n    childService.onDone(function (doneEvent) {\n      _this.removeChild(childService.id);\n\n      _this.send(toSCXMLEvent(doneEvent, {\n        origin: childService.id\n      }));\n    }).start();\n    return actor;\n  };\n\n  Interpreter.prototype.spawnBehavior = function (behavior, id) {\n    var actorRef = spawnBehavior(behavior, {\n      id: id,\n      parent: this\n    });\n    this.children.set(id, actorRef);\n    return actorRef;\n  };\n\n  Interpreter.prototype.spawnPromise = function (promise, id) {\n    var _this = this;\n\n    var canceled = false;\n    var resolvedData;\n    promise.then(function (response) {\n      if (!canceled) {\n        resolvedData = response;\n\n        _this.removeChild(id);\n\n        _this.send(toSCXMLEvent(doneInvoke(id, response), {\n          origin: id\n        }));\n      }\n    }, function (errorData) {\n      if (!canceled) {\n        _this.removeChild(id);\n\n        var errorEvent = error(id, errorData);\n\n        try {\n          // Send \"error.platform.id\" to this (parent).\n          _this.send(toSCXMLEvent(errorEvent, {\n            origin: id\n          }));\n        } catch (error) {\n          reportUnhandledExceptionOnInvocation(errorData, error, id);\n\n          if (_this.devTools) {\n            _this.devTools.send(errorEvent, _this.state);\n          }\n\n          if (_this.machine.strict) {\n            // it would be better to always stop the state machine if unhandled\n            // exception/promise rejection happens but because we don't want to\n            // break existing code so enforce it on strict mode only especially so\n            // because documentation says that onError is optional\n            _this.stop();\n          }\n        }\n      }\n    });\n    var actor = {\n      id: id,\n      send: function () {\n        return void 0;\n      },\n      subscribe: function (next, handleError, complete) {\n        var observer = toObserver(next, handleError, complete);\n        var unsubscribed = false;\n        promise.then(function (response) {\n          if (unsubscribed) {\n            return;\n          }\n\n          observer.next(response);\n\n          if (unsubscribed) {\n            return;\n          }\n\n          observer.complete();\n        }, function (err) {\n          if (unsubscribed) {\n            return;\n          }\n\n          observer.error(err);\n        });\n        return {\n          unsubscribe: function () {\n            return unsubscribed = true;\n          }\n        };\n      },\n      stop: function () {\n        canceled = true;\n      },\n      toJSON: function () {\n        return {\n          id: id\n        };\n      },\n      getSnapshot: function () {\n        return resolvedData;\n      }\n    };\n    this.children.set(id, actor);\n    return actor;\n  };\n\n  Interpreter.prototype.spawnCallback = function (callback, id) {\n    var _this = this;\n\n    var canceled = false;\n    var receivers = new Set();\n    var listeners = new Set();\n    var emitted;\n\n    var receive = function (e) {\n      emitted = e;\n      listeners.forEach(function (listener) {\n        return listener(e);\n      });\n\n      if (canceled) {\n        return;\n      }\n\n      _this.send(toSCXMLEvent(e, {\n        origin: id\n      }));\n    };\n\n    var callbackStop;\n\n    try {\n      callbackStop = callback(receive, function (newListener) {\n        receivers.add(newListener);\n      });\n    } catch (err) {\n      this.send(error(id, err));\n    }\n\n    if (isPromiseLike(callbackStop)) {\n      // it turned out to be an async function, can't reliably check this before calling `callback`\n      // because transpiled async functions are not recognizable\n      return this.spawnPromise(callbackStop, id);\n    }\n\n    var actor = {\n      id: id,\n      send: function (event) {\n        return receivers.forEach(function (receiver) {\n          return receiver(event);\n        });\n      },\n      subscribe: function (next) {\n        listeners.add(next);\n        return {\n          unsubscribe: function () {\n            listeners.delete(next);\n          }\n        };\n      },\n      stop: function () {\n        canceled = true;\n\n        if (isFunction(callbackStop)) {\n          callbackStop();\n        }\n      },\n      toJSON: function () {\n        return {\n          id: id\n        };\n      },\n      getSnapshot: function () {\n        return emitted;\n      }\n    };\n    this.children.set(id, actor);\n    return actor;\n  };\n\n  Interpreter.prototype.spawnObservable = function (source, id) {\n    var _this = this;\n\n    var emitted;\n    var subscription = source.subscribe(function (value) {\n      emitted = value;\n\n      _this.send(toSCXMLEvent(value, {\n        origin: id\n      }));\n    }, function (err) {\n      _this.removeChild(id);\n\n      _this.send(toSCXMLEvent(error(id, err), {\n        origin: id\n      }));\n    }, function () {\n      _this.removeChild(id);\n\n      _this.send(toSCXMLEvent(doneInvoke(id), {\n        origin: id\n      }));\n    });\n    var actor = {\n      id: id,\n      send: function () {\n        return void 0;\n      },\n      subscribe: function (next, handleError, complete) {\n        return source.subscribe(next, handleError, complete);\n      },\n      stop: function () {\n        return subscription.unsubscribe();\n      },\n      getSnapshot: function () {\n        return emitted;\n      },\n      toJSON: function () {\n        return {\n          id: id\n        };\n      }\n    };\n    this.children.set(id, actor);\n    return actor;\n  };\n\n  Interpreter.prototype.spawnActor = function (actor, name) {\n    this.children.set(name, actor);\n    return actor;\n  };\n\n  Interpreter.prototype.spawnActivity = function (activity) {\n    var implementation = this.machine.options && this.machine.options.activities ? this.machine.options.activities[activity.type] : undefined;\n\n    if (!implementation) {\n      if (!IS_PRODUCTION) {\n        warn(false, \"No implementation found for activity '\" + activity.type + \"'\");\n      } // tslint:disable-next-line:no-console\n\n\n      return;\n    } // Start implementation\n\n\n    var dispose = implementation(this.state.context, activity);\n    this.spawnEffect(activity.id, dispose);\n  };\n\n  Interpreter.prototype.spawnEffect = function (id, dispose) {\n    this.children.set(id, {\n      id: id,\n      send: function () {\n        return void 0;\n      },\n      subscribe: function () {\n        return {\n          unsubscribe: function () {\n            return void 0;\n          }\n        };\n      },\n      stop: dispose || undefined,\n      getSnapshot: function () {\n        return undefined;\n      },\n      toJSON: function () {\n        return {\n          id: id\n        };\n      }\n    });\n  };\n\n  Interpreter.prototype.attachDev = function () {\n    var global = getGlobal();\n\n    if (this.options.devTools && global) {\n      if (global.__REDUX_DEVTOOLS_EXTENSION__) {\n        var devToolsOptions = typeof this.options.devTools === 'object' ? this.options.devTools : undefined;\n        this.devTools = global.__REDUX_DEVTOOLS_EXTENSION__.connect(__assign(__assign({\n          name: this.id,\n          autoPause: true,\n          stateSanitizer: function (state) {\n            return {\n              value: state.value,\n              context: state.context,\n              actions: state.actions\n            };\n          }\n        }, devToolsOptions), {\n          features: __assign({\n            jump: false,\n            skip: false\n          }, devToolsOptions ? devToolsOptions.features : undefined)\n        }), this.machine);\n        this.devTools.init(this.state);\n      } // add XState-specific dev tooling hook\n\n\n      registerService(this);\n    }\n  };\n\n  Interpreter.prototype.toJSON = function () {\n    return {\n      id: this.id\n    };\n  };\n\n  Interpreter.prototype[symbolObservable] = function () {\n    return this;\n  }; // this gets stripped by Babel to avoid having \"undefined\" property in environments without this non-standard Symbol\n  // it has to be here to be included in the generated .d.ts\n\n\n  Interpreter.prototype.getSnapshot = function () {\n    if (this.status === InterpreterStatus.NotStarted) {\n      return this.initialState;\n    }\n\n    return this._state;\n  };\n  /**\r\n   * The default interpreter options:\r\n   *\r\n   * - `clock` uses the global `setTimeout` and `clearTimeout` functions\r\n   * - `logger` uses the global `console.log()` method\r\n   */\n\n\n  Interpreter.defaultOptions = /*#__PURE__*/function (global) {\n    return {\n      execute: true,\n      deferEvents: true,\n      clock: {\n        setTimeout: function (fn, ms) {\n          return setTimeout(fn, ms);\n        },\n        clearTimeout: function (id) {\n          return clearTimeout(id);\n        }\n      },\n      logger: global.console.log.bind(console),\n      devTools: false\n    };\n  }(typeof self !== 'undefined' ? self : global);\n\n  Interpreter.interpret = interpret;\n  return Interpreter;\n}();\n\nvar resolveSpawnOptions = function (nameOrOptions) {\n  if (isString(nameOrOptions)) {\n    return __assign(__assign({}, DEFAULT_SPAWN_OPTIONS), {\n      name: nameOrOptions\n    });\n  }\n\n  return __assign(__assign(__assign({}, DEFAULT_SPAWN_OPTIONS), {\n    name: uniqueId()\n  }), nameOrOptions);\n};\n\nfunction spawn(entity, nameOrOptions) {\n  var resolvedOptions = resolveSpawnOptions(nameOrOptions);\n  return consume(function (service) {\n    if (!IS_PRODUCTION) {\n      var isLazyEntity = isMachine(entity) || isFunction(entity);\n      warn(!!service || isLazyEntity, \"Attempted to spawn an Actor (ID: \\\"\" + (isMachine(entity) ? entity.id : 'undefined') + \"\\\") outside of a service. This will have no effect.\");\n    }\n\n    if (service) {\n      return service.spawn(entity, resolvedOptions.name, resolvedOptions);\n    } else {\n      return createDeferredActor(entity, resolvedOptions.name);\n    }\n  });\n}\n/**\r\n * Creates a new Interpreter instance for the given machine with the provided options, if any.\r\n *\r\n * @param machine The machine to interpret\r\n * @param options Interpreter options\r\n */\n\nfunction interpret(machine, options) {\n  var interpreter = new Interpreter(machine, options);\n  return interpreter;\n}\n\nexport { Interpreter, InterpreterStatus, interpret, spawn };\n","import { __values, __read } from './_virtual/_tslib.js';\nimport { State } from './State.js';\n\nfunction matchState(state, patterns, defaultValue) {\n  var e_1, _a;\n\n  var resolvedState = State.from(state, state instanceof State ? state.context : undefined);\n\n  try {\n    for (var patterns_1 = __values(patterns), patterns_1_1 = patterns_1.next(); !patterns_1_1.done; patterns_1_1 = patterns_1.next()) {\n      var _b = __read(patterns_1_1.value, 2),\n          stateValue = _b[0],\n          getValue = _b[1];\n\n      if (resolvedState.matches(stateValue)) {\n        return getValue(resolvedState);\n      }\n    }\n  } catch (e_1_1) {\n    e_1 = {\n      error: e_1_1\n    };\n  } finally {\n    try {\n      if (patterns_1_1 && !patterns_1_1.done && (_a = patterns_1.return)) _a.call(patterns_1);\n    } finally {\n      if (e_1) throw e_1.error;\n    }\n  }\n\n  return defaultValue(resolvedState);\n}\n\nexport { matchState };\n","function createSchema(schema) {\n  return schema;\n}\n\nexport { createSchema };\n","export { matchesState } from './utils.js';\nexport { mapState } from './mapState.js';\nexport { ActionTypes, SpecialTargets } from './types.js';\nimport { raise, send, sendParent, sendUpdate, log, cancel, start, stop, assign, after, done, respond, forwardTo, escalate, choose, pure } from './actions.js';\nexport { assign, doneInvoke, forwardTo, send, sendParent, sendUpdate } from './actions.js';\nexport { State } from './State.js';\nexport { StateNode } from './StateNode.js';\nexport { Machine, createMachine } from './Machine.js';\nexport { Interpreter, InterpreterStatus, interpret, spawn } from './interpreter.js';\nexport { matchState } from './match.js';\nexport { createSchema } from './schema.js';\n\nvar actions = {\n  raise: raise,\n  send: send,\n  sendParent: sendParent,\n  sendUpdate: sendUpdate,\n  log: log,\n  cancel: cancel,\n  start: start,\n  stop: stop,\n  assign: assign,\n  after: after,\n  done: done,\n  respond: respond,\n  forwardTo: forwardTo,\n  escalate: escalate,\n  choose: choose,\n  pure: pure\n};\n\nexport { actions };\n","import { createMachine } from 'xstate'\r\n\r\n\r\ntype ToggleEvent = {\r\n    type: 'TOGGLE';\r\n};\r\n\r\n//State Machine\r\nexport const toggleMachine = createMachine<ToggleEvent>({\r\n    id: 'toggleButton',\r\n    initial: 'idle',\r\n    states: {\r\n        idle: {\r\n            on: {TOGGLE: 'active'},\r\n        },\r\n        inactive: {\r\n            on: {TOGGLE: 'active'},\r\n        },\r\n        active: {\r\n            on: {TOGGLE: 'inactive'},\r\n        },\r\n    },\r\n});","/*\n * anime.js v3.2.1\n * (c) 2020 Julian Garnier\n * Released under the MIT license\n * animejs.com\n */\n\n// Defaults\n\nvar defaultInstanceSettings = {\n  update: null,\n  begin: null,\n  loopBegin: null,\n  changeBegin: null,\n  change: null,\n  changeComplete: null,\n  loopComplete: null,\n  complete: null,\n  loop: 1,\n  direction: 'normal',\n  autoplay: true,\n  timelineOffset: 0\n};\n\nvar defaultTweenSettings = {\n  duration: 1000,\n  delay: 0,\n  endDelay: 0,\n  easing: 'easeOutElastic(1, .5)',\n  round: 0\n};\n\nvar validTransforms = ['translateX', 'translateY', 'translateZ', 'rotate', 'rotateX', 'rotateY', 'rotateZ', 'scale', 'scaleX', 'scaleY', 'scaleZ', 'skew', 'skewX', 'skewY', 'perspective', 'matrix', 'matrix3d'];\n\n// Caching\n\nvar cache = {\n  CSS: {},\n  springs: {}\n};\n\n// Utils\n\nfunction minMax(val, min, max) {\n  return Math.min(Math.max(val, min), max);\n}\n\nfunction stringContains(str, text) {\n  return str.indexOf(text) > -1;\n}\n\nfunction applyArguments(func, args) {\n  return func.apply(null, args);\n}\n\nvar is = {\n  arr: function (a) { return Array.isArray(a); },\n  obj: function (a) { return stringContains(Object.prototype.toString.call(a), 'Object'); },\n  pth: function (a) { return is.obj(a) && a.hasOwnProperty('totalLength'); },\n  svg: function (a) { return a instanceof SVGElement; },\n  inp: function (a) { return a instanceof HTMLInputElement; },\n  dom: function (a) { return a.nodeType || is.svg(a); },\n  str: function (a) { return typeof a === 'string'; },\n  fnc: function (a) { return typeof a === 'function'; },\n  und: function (a) { return typeof a === 'undefined'; },\n  nil: function (a) { return is.und(a) || a === null; },\n  hex: function (a) { return /(^#[0-9A-F]{6}$)|(^#[0-9A-F]{3}$)/i.test(a); },\n  rgb: function (a) { return /^rgb/.test(a); },\n  hsl: function (a) { return /^hsl/.test(a); },\n  col: function (a) { return (is.hex(a) || is.rgb(a) || is.hsl(a)); },\n  key: function (a) { return !defaultInstanceSettings.hasOwnProperty(a) && !defaultTweenSettings.hasOwnProperty(a) && a !== 'targets' && a !== 'keyframes'; },\n};\n\n// Easings\n\nfunction parseEasingParameters(string) {\n  var match = /\\(([^)]+)\\)/.exec(string);\n  return match ? match[1].split(',').map(function (p) { return parseFloat(p); }) : [];\n}\n\n// Spring solver inspired by Webkit Copyright  2016 Apple Inc. All rights reserved. https://webkit.org/demos/spring/spring.js\n\nfunction spring(string, duration) {\n\n  var params = parseEasingParameters(string);\n  var mass = minMax(is.und(params[0]) ? 1 : params[0], .1, 100);\n  var stiffness = minMax(is.und(params[1]) ? 100 : params[1], .1, 100);\n  var damping = minMax(is.und(params[2]) ? 10 : params[2], .1, 100);\n  var velocity =  minMax(is.und(params[3]) ? 0 : params[3], .1, 100);\n  var w0 = Math.sqrt(stiffness / mass);\n  var zeta = damping / (2 * Math.sqrt(stiffness * mass));\n  var wd = zeta < 1 ? w0 * Math.sqrt(1 - zeta * zeta) : 0;\n  var a = 1;\n  var b = zeta < 1 ? (zeta * w0 + -velocity) / wd : -velocity + w0;\n\n  function solver(t) {\n    var progress = duration ? (duration * t) / 1000 : t;\n    if (zeta < 1) {\n      progress = Math.exp(-progress * zeta * w0) * (a * Math.cos(wd * progress) + b * Math.sin(wd * progress));\n    } else {\n      progress = (a + b * progress) * Math.exp(-progress * w0);\n    }\n    if (t === 0 || t === 1) { return t; }\n    return 1 - progress;\n  }\n\n  function getDuration() {\n    var cached = cache.springs[string];\n    if (cached) { return cached; }\n    var frame = 1/6;\n    var elapsed = 0;\n    var rest = 0;\n    while(true) {\n      elapsed += frame;\n      if (solver(elapsed) === 1) {\n        rest++;\n        if (rest >= 16) { break; }\n      } else {\n        rest = 0;\n      }\n    }\n    var duration = elapsed * frame * 1000;\n    cache.springs[string] = duration;\n    return duration;\n  }\n\n  return duration ? solver : getDuration;\n\n}\n\n// Basic steps easing implementation https://developer.mozilla.org/fr/docs/Web/CSS/transition-timing-function\n\nfunction steps(steps) {\n  if ( steps === void 0 ) steps = 10;\n\n  return function (t) { return Math.ceil((minMax(t, 0.000001, 1)) * steps) * (1 / steps); };\n}\n\n// BezierEasing https://github.com/gre/bezier-easing\n\nvar bezier = (function () {\n\n  var kSplineTableSize = 11;\n  var kSampleStepSize = 1.0 / (kSplineTableSize - 1.0);\n\n  function A(aA1, aA2) { return 1.0 - 3.0 * aA2 + 3.0 * aA1 }\n  function B(aA1, aA2) { return 3.0 * aA2 - 6.0 * aA1 }\n  function C(aA1)      { return 3.0 * aA1 }\n\n  function calcBezier(aT, aA1, aA2) { return ((A(aA1, aA2) * aT + B(aA1, aA2)) * aT + C(aA1)) * aT }\n  function getSlope(aT, aA1, aA2) { return 3.0 * A(aA1, aA2) * aT * aT + 2.0 * B(aA1, aA2) * aT + C(aA1) }\n\n  function binarySubdivide(aX, aA, aB, mX1, mX2) {\n    var currentX, currentT, i = 0;\n    do {\n      currentT = aA + (aB - aA) / 2.0;\n      currentX = calcBezier(currentT, mX1, mX2) - aX;\n      if (currentX > 0.0) { aB = currentT; } else { aA = currentT; }\n    } while (Math.abs(currentX) > 0.0000001 && ++i < 10);\n    return currentT;\n  }\n\n  function newtonRaphsonIterate(aX, aGuessT, mX1, mX2) {\n    for (var i = 0; i < 4; ++i) {\n      var currentSlope = getSlope(aGuessT, mX1, mX2);\n      if (currentSlope === 0.0) { return aGuessT; }\n      var currentX = calcBezier(aGuessT, mX1, mX2) - aX;\n      aGuessT -= currentX / currentSlope;\n    }\n    return aGuessT;\n  }\n\n  function bezier(mX1, mY1, mX2, mY2) {\n\n    if (!(0 <= mX1 && mX1 <= 1 && 0 <= mX2 && mX2 <= 1)) { return; }\n    var sampleValues = new Float32Array(kSplineTableSize);\n\n    if (mX1 !== mY1 || mX2 !== mY2) {\n      for (var i = 0; i < kSplineTableSize; ++i) {\n        sampleValues[i] = calcBezier(i * kSampleStepSize, mX1, mX2);\n      }\n    }\n\n    function getTForX(aX) {\n\n      var intervalStart = 0;\n      var currentSample = 1;\n      var lastSample = kSplineTableSize - 1;\n\n      for (; currentSample !== lastSample && sampleValues[currentSample] <= aX; ++currentSample) {\n        intervalStart += kSampleStepSize;\n      }\n\n      --currentSample;\n\n      var dist = (aX - sampleValues[currentSample]) / (sampleValues[currentSample + 1] - sampleValues[currentSample]);\n      var guessForT = intervalStart + dist * kSampleStepSize;\n      var initialSlope = getSlope(guessForT, mX1, mX2);\n\n      if (initialSlope >= 0.001) {\n        return newtonRaphsonIterate(aX, guessForT, mX1, mX2);\n      } else if (initialSlope === 0.0) {\n        return guessForT;\n      } else {\n        return binarySubdivide(aX, intervalStart, intervalStart + kSampleStepSize, mX1, mX2);\n      }\n\n    }\n\n    return function (x) {\n      if (mX1 === mY1 && mX2 === mY2) { return x; }\n      if (x === 0 || x === 1) { return x; }\n      return calcBezier(getTForX(x), mY1, mY2);\n    }\n\n  }\n\n  return bezier;\n\n})();\n\nvar penner = (function () {\n\n  // Based on jQuery UI's implemenation of easing equations from Robert Penner (http://www.robertpenner.com/easing)\n\n  var eases = { linear: function () { return function (t) { return t; }; } };\n\n  var functionEasings = {\n    Sine: function () { return function (t) { return 1 - Math.cos(t * Math.PI / 2); }; },\n    Circ: function () { return function (t) { return 1 - Math.sqrt(1 - t * t); }; },\n    Back: function () { return function (t) { return t * t * (3 * t - 2); }; },\n    Bounce: function () { return function (t) {\n      var pow2, b = 4;\n      while (t < (( pow2 = Math.pow(2, --b)) - 1) / 11) {}\n      return 1 / Math.pow(4, 3 - b) - 7.5625 * Math.pow(( pow2 * 3 - 2 ) / 22 - t, 2)\n    }; },\n    Elastic: function (amplitude, period) {\n      if ( amplitude === void 0 ) amplitude = 1;\n      if ( period === void 0 ) period = .5;\n\n      var a = minMax(amplitude, 1, 10);\n      var p = minMax(period, .1, 2);\n      return function (t) {\n        return (t === 0 || t === 1) ? t : \n          -a * Math.pow(2, 10 * (t - 1)) * Math.sin((((t - 1) - (p / (Math.PI * 2) * Math.asin(1 / a))) * (Math.PI * 2)) / p);\n      }\n    }\n  };\n\n  var baseEasings = ['Quad', 'Cubic', 'Quart', 'Quint', 'Expo'];\n\n  baseEasings.forEach(function (name, i) {\n    functionEasings[name] = function () { return function (t) { return Math.pow(t, i + 2); }; };\n  });\n\n  Object.keys(functionEasings).forEach(function (name) {\n    var easeIn = functionEasings[name];\n    eases['easeIn' + name] = easeIn;\n    eases['easeOut' + name] = function (a, b) { return function (t) { return 1 - easeIn(a, b)(1 - t); }; };\n    eases['easeInOut' + name] = function (a, b) { return function (t) { return t < 0.5 ? easeIn(a, b)(t * 2) / 2 : \n      1 - easeIn(a, b)(t * -2 + 2) / 2; }; };\n    eases['easeOutIn' + name] = function (a, b) { return function (t) { return t < 0.5 ? (1 - easeIn(a, b)(1 - t * 2)) / 2 : \n      (easeIn(a, b)(t * 2 - 1) + 1) / 2; }; };\n  });\n\n  return eases;\n\n})();\n\nfunction parseEasings(easing, duration) {\n  if (is.fnc(easing)) { return easing; }\n  var name = easing.split('(')[0];\n  var ease = penner[name];\n  var args = parseEasingParameters(easing);\n  switch (name) {\n    case 'spring' : return spring(easing, duration);\n    case 'cubicBezier' : return applyArguments(bezier, args);\n    case 'steps' : return applyArguments(steps, args);\n    default : return applyArguments(ease, args);\n  }\n}\n\n// Strings\n\nfunction selectString(str) {\n  try {\n    var nodes = document.querySelectorAll(str);\n    return nodes;\n  } catch(e) {\n    return;\n  }\n}\n\n// Arrays\n\nfunction filterArray(arr, callback) {\n  var len = arr.length;\n  var thisArg = arguments.length >= 2 ? arguments[1] : void 0;\n  var result = [];\n  for (var i = 0; i < len; i++) {\n    if (i in arr) {\n      var val = arr[i];\n      if (callback.call(thisArg, val, i, arr)) {\n        result.push(val);\n      }\n    }\n  }\n  return result;\n}\n\nfunction flattenArray(arr) {\n  return arr.reduce(function (a, b) { return a.concat(is.arr(b) ? flattenArray(b) : b); }, []);\n}\n\nfunction toArray(o) {\n  if (is.arr(o)) { return o; }\n  if (is.str(o)) { o = selectString(o) || o; }\n  if (o instanceof NodeList || o instanceof HTMLCollection) { return [].slice.call(o); }\n  return [o];\n}\n\nfunction arrayContains(arr, val) {\n  return arr.some(function (a) { return a === val; });\n}\n\n// Objects\n\nfunction cloneObject(o) {\n  var clone = {};\n  for (var p in o) { clone[p] = o[p]; }\n  return clone;\n}\n\nfunction replaceObjectProps(o1, o2) {\n  var o = cloneObject(o1);\n  for (var p in o1) { o[p] = o2.hasOwnProperty(p) ? o2[p] : o1[p]; }\n  return o;\n}\n\nfunction mergeObjects(o1, o2) {\n  var o = cloneObject(o1);\n  for (var p in o2) { o[p] = is.und(o1[p]) ? o2[p] : o1[p]; }\n  return o;\n}\n\n// Colors\n\nfunction rgbToRgba(rgbValue) {\n  var rgb = /rgb\\((\\d+,\\s*[\\d]+,\\s*[\\d]+)\\)/g.exec(rgbValue);\n  return rgb ? (\"rgba(\" + (rgb[1]) + \",1)\") : rgbValue;\n}\n\nfunction hexToRgba(hexValue) {\n  var rgx = /^#?([a-f\\d])([a-f\\d])([a-f\\d])$/i;\n  var hex = hexValue.replace(rgx, function (m, r, g, b) { return r + r + g + g + b + b; } );\n  var rgb = /^#?([a-f\\d]{2})([a-f\\d]{2})([a-f\\d]{2})$/i.exec(hex);\n  var r = parseInt(rgb[1], 16);\n  var g = parseInt(rgb[2], 16);\n  var b = parseInt(rgb[3], 16);\n  return (\"rgba(\" + r + \",\" + g + \",\" + b + \",1)\");\n}\n\nfunction hslToRgba(hslValue) {\n  var hsl = /hsl\\((\\d+),\\s*([\\d.]+)%,\\s*([\\d.]+)%\\)/g.exec(hslValue) || /hsla\\((\\d+),\\s*([\\d.]+)%,\\s*([\\d.]+)%,\\s*([\\d.]+)\\)/g.exec(hslValue);\n  var h = parseInt(hsl[1], 10) / 360;\n  var s = parseInt(hsl[2], 10) / 100;\n  var l = parseInt(hsl[3], 10) / 100;\n  var a = hsl[4] || 1;\n  function hue2rgb(p, q, t) {\n    if (t < 0) { t += 1; }\n    if (t > 1) { t -= 1; }\n    if (t < 1/6) { return p + (q - p) * 6 * t; }\n    if (t < 1/2) { return q; }\n    if (t < 2/3) { return p + (q - p) * (2/3 - t) * 6; }\n    return p;\n  }\n  var r, g, b;\n  if (s == 0) {\n    r = g = b = l;\n  } else {\n    var q = l < 0.5 ? l * (1 + s) : l + s - l * s;\n    var p = 2 * l - q;\n    r = hue2rgb(p, q, h + 1/3);\n    g = hue2rgb(p, q, h);\n    b = hue2rgb(p, q, h - 1/3);\n  }\n  return (\"rgba(\" + (r * 255) + \",\" + (g * 255) + \",\" + (b * 255) + \",\" + a + \")\");\n}\n\nfunction colorToRgb(val) {\n  if (is.rgb(val)) { return rgbToRgba(val); }\n  if (is.hex(val)) { return hexToRgba(val); }\n  if (is.hsl(val)) { return hslToRgba(val); }\n}\n\n// Units\n\nfunction getUnit(val) {\n  var split = /[+-]?\\d*\\.?\\d+(?:\\.\\d+)?(?:[eE][+-]?\\d+)?(%|px|pt|em|rem|in|cm|mm|ex|ch|pc|vw|vh|vmin|vmax|deg|rad|turn)?$/.exec(val);\n  if (split) { return split[1]; }\n}\n\nfunction getTransformUnit(propName) {\n  if (stringContains(propName, 'translate') || propName === 'perspective') { return 'px'; }\n  if (stringContains(propName, 'rotate') || stringContains(propName, 'skew')) { return 'deg'; }\n}\n\n// Values\n\nfunction getFunctionValue(val, animatable) {\n  if (!is.fnc(val)) { return val; }\n  return val(animatable.target, animatable.id, animatable.total);\n}\n\nfunction getAttribute(el, prop) {\n  return el.getAttribute(prop);\n}\n\nfunction convertPxToUnit(el, value, unit) {\n  var valueUnit = getUnit(value);\n  if (arrayContains([unit, 'deg', 'rad', 'turn'], valueUnit)) { return value; }\n  var cached = cache.CSS[value + unit];\n  if (!is.und(cached)) { return cached; }\n  var baseline = 100;\n  var tempEl = document.createElement(el.tagName);\n  var parentEl = (el.parentNode && (el.parentNode !== document)) ? el.parentNode : document.body;\n  parentEl.appendChild(tempEl);\n  tempEl.style.position = 'absolute';\n  tempEl.style.width = baseline + unit;\n  var factor = baseline / tempEl.offsetWidth;\n  parentEl.removeChild(tempEl);\n  var convertedUnit = factor * parseFloat(value);\n  cache.CSS[value + unit] = convertedUnit;\n  return convertedUnit;\n}\n\nfunction getCSSValue(el, prop, unit) {\n  if (prop in el.style) {\n    var uppercasePropName = prop.replace(/([a-z])([A-Z])/g, '$1-$2').toLowerCase();\n    var value = el.style[prop] || getComputedStyle(el).getPropertyValue(uppercasePropName) || '0';\n    return unit ? convertPxToUnit(el, value, unit) : value;\n  }\n}\n\nfunction getAnimationType(el, prop) {\n  if (is.dom(el) && !is.inp(el) && (!is.nil(getAttribute(el, prop)) || (is.svg(el) && el[prop]))) { return 'attribute'; }\n  if (is.dom(el) && arrayContains(validTransforms, prop)) { return 'transform'; }\n  if (is.dom(el) && (prop !== 'transform' && getCSSValue(el, prop))) { return 'css'; }\n  if (el[prop] != null) { return 'object'; }\n}\n\nfunction getElementTransforms(el) {\n  if (!is.dom(el)) { return; }\n  var str = el.style.transform || '';\n  var reg  = /(\\w+)\\(([^)]*)\\)/g;\n  var transforms = new Map();\n  var m; while (m = reg.exec(str)) { transforms.set(m[1], m[2]); }\n  return transforms;\n}\n\nfunction getTransformValue(el, propName, animatable, unit) {\n  var defaultVal = stringContains(propName, 'scale') ? 1 : 0 + getTransformUnit(propName);\n  var value = getElementTransforms(el).get(propName) || defaultVal;\n  if (animatable) {\n    animatable.transforms.list.set(propName, value);\n    animatable.transforms['last'] = propName;\n  }\n  return unit ? convertPxToUnit(el, value, unit) : value;\n}\n\nfunction getOriginalTargetValue(target, propName, unit, animatable) {\n  switch (getAnimationType(target, propName)) {\n    case 'transform': return getTransformValue(target, propName, animatable, unit);\n    case 'css': return getCSSValue(target, propName, unit);\n    case 'attribute': return getAttribute(target, propName);\n    default: return target[propName] || 0;\n  }\n}\n\nfunction getRelativeValue(to, from) {\n  var operator = /^(\\*=|\\+=|-=)/.exec(to);\n  if (!operator) { return to; }\n  var u = getUnit(to) || 0;\n  var x = parseFloat(from);\n  var y = parseFloat(to.replace(operator[0], ''));\n  switch (operator[0][0]) {\n    case '+': return x + y + u;\n    case '-': return x - y + u;\n    case '*': return x * y + u;\n  }\n}\n\nfunction validateValue(val, unit) {\n  if (is.col(val)) { return colorToRgb(val); }\n  if (/\\s/g.test(val)) { return val; }\n  var originalUnit = getUnit(val);\n  var unitLess = originalUnit ? val.substr(0, val.length - originalUnit.length) : val;\n  if (unit) { return unitLess + unit; }\n  return unitLess;\n}\n\n// getTotalLength() equivalent for circle, rect, polyline, polygon and line shapes\n// adapted from https://gist.github.com/SebLambla/3e0550c496c236709744\n\nfunction getDistance(p1, p2) {\n  return Math.sqrt(Math.pow(p2.x - p1.x, 2) + Math.pow(p2.y - p1.y, 2));\n}\n\nfunction getCircleLength(el) {\n  return Math.PI * 2 * getAttribute(el, 'r');\n}\n\nfunction getRectLength(el) {\n  return (getAttribute(el, 'width') * 2) + (getAttribute(el, 'height') * 2);\n}\n\nfunction getLineLength(el) {\n  return getDistance(\n    {x: getAttribute(el, 'x1'), y: getAttribute(el, 'y1')}, \n    {x: getAttribute(el, 'x2'), y: getAttribute(el, 'y2')}\n  );\n}\n\nfunction getPolylineLength(el) {\n  var points = el.points;\n  var totalLength = 0;\n  var previousPos;\n  for (var i = 0 ; i < points.numberOfItems; i++) {\n    var currentPos = points.getItem(i);\n    if (i > 0) { totalLength += getDistance(previousPos, currentPos); }\n    previousPos = currentPos;\n  }\n  return totalLength;\n}\n\nfunction getPolygonLength(el) {\n  var points = el.points;\n  return getPolylineLength(el) + getDistance(points.getItem(points.numberOfItems - 1), points.getItem(0));\n}\n\n// Path animation\n\nfunction getTotalLength(el) {\n  if (el.getTotalLength) { return el.getTotalLength(); }\n  switch(el.tagName.toLowerCase()) {\n    case 'circle': return getCircleLength(el);\n    case 'rect': return getRectLength(el);\n    case 'line': return getLineLength(el);\n    case 'polyline': return getPolylineLength(el);\n    case 'polygon': return getPolygonLength(el);\n  }\n}\n\nfunction setDashoffset(el) {\n  var pathLength = getTotalLength(el);\n  el.setAttribute('stroke-dasharray', pathLength);\n  return pathLength;\n}\n\n// Motion path\n\nfunction getParentSvgEl(el) {\n  var parentEl = el.parentNode;\n  while (is.svg(parentEl)) {\n    if (!is.svg(parentEl.parentNode)) { break; }\n    parentEl = parentEl.parentNode;\n  }\n  return parentEl;\n}\n\nfunction getParentSvg(pathEl, svgData) {\n  var svg = svgData || {};\n  var parentSvgEl = svg.el || getParentSvgEl(pathEl);\n  var rect = parentSvgEl.getBoundingClientRect();\n  var viewBoxAttr = getAttribute(parentSvgEl, 'viewBox');\n  var width = rect.width;\n  var height = rect.height;\n  var viewBox = svg.viewBox || (viewBoxAttr ? viewBoxAttr.split(' ') : [0, 0, width, height]);\n  return {\n    el: parentSvgEl,\n    viewBox: viewBox,\n    x: viewBox[0] / 1,\n    y: viewBox[1] / 1,\n    w: width,\n    h: height,\n    vW: viewBox[2],\n    vH: viewBox[3]\n  }\n}\n\nfunction getPath(path, percent) {\n  var pathEl = is.str(path) ? selectString(path)[0] : path;\n  var p = percent || 100;\n  return function(property) {\n    return {\n      property: property,\n      el: pathEl,\n      svg: getParentSvg(pathEl),\n      totalLength: getTotalLength(pathEl) * (p / 100)\n    }\n  }\n}\n\nfunction getPathProgress(path, progress, isPathTargetInsideSVG) {\n  function point(offset) {\n    if ( offset === void 0 ) offset = 0;\n\n    var l = progress + offset >= 1 ? progress + offset : 0;\n    return path.el.getPointAtLength(l);\n  }\n  var svg = getParentSvg(path.el, path.svg);\n  var p = point();\n  var p0 = point(-1);\n  var p1 = point(+1);\n  var scaleX = isPathTargetInsideSVG ? 1 : svg.w / svg.vW;\n  var scaleY = isPathTargetInsideSVG ? 1 : svg.h / svg.vH;\n  switch (path.property) {\n    case 'x': return (p.x - svg.x) * scaleX;\n    case 'y': return (p.y - svg.y) * scaleY;\n    case 'angle': return Math.atan2(p1.y - p0.y, p1.x - p0.x) * 180 / Math.PI;\n  }\n}\n\n// Decompose value\n\nfunction decomposeValue(val, unit) {\n  // const rgx = /-?\\d*\\.?\\d+/g; // handles basic numbers\n  // const rgx = /[+-]?\\d+(?:\\.\\d+)?(?:[eE][+-]?\\d+)?/g; // handles exponents notation\n  var rgx = /[+-]?\\d*\\.?\\d+(?:\\.\\d+)?(?:[eE][+-]?\\d+)?/g; // handles exponents notation\n  var value = validateValue((is.pth(val) ? val.totalLength : val), unit) + '';\n  return {\n    original: value,\n    numbers: value.match(rgx) ? value.match(rgx).map(Number) : [0],\n    strings: (is.str(val) || unit) ? value.split(rgx) : []\n  }\n}\n\n// Animatables\n\nfunction parseTargets(targets) {\n  var targetsArray = targets ? (flattenArray(is.arr(targets) ? targets.map(toArray) : toArray(targets))) : [];\n  return filterArray(targetsArray, function (item, pos, self) { return self.indexOf(item) === pos; });\n}\n\nfunction getAnimatables(targets) {\n  var parsed = parseTargets(targets);\n  return parsed.map(function (t, i) {\n    return {target: t, id: i, total: parsed.length, transforms: { list: getElementTransforms(t) } };\n  });\n}\n\n// Properties\n\nfunction normalizePropertyTweens(prop, tweenSettings) {\n  var settings = cloneObject(tweenSettings);\n  // Override duration if easing is a spring\n  if (/^spring/.test(settings.easing)) { settings.duration = spring(settings.easing); }\n  if (is.arr(prop)) {\n    var l = prop.length;\n    var isFromTo = (l === 2 && !is.obj(prop[0]));\n    if (!isFromTo) {\n      // Duration divided by the number of tweens\n      if (!is.fnc(tweenSettings.duration)) { settings.duration = tweenSettings.duration / l; }\n    } else {\n      // Transform [from, to] values shorthand to a valid tween value\n      prop = {value: prop};\n    }\n  }\n  var propArray = is.arr(prop) ? prop : [prop];\n  return propArray.map(function (v, i) {\n    var obj = (is.obj(v) && !is.pth(v)) ? v : {value: v};\n    // Default delay value should only be applied to the first tween\n    if (is.und(obj.delay)) { obj.delay = !i ? tweenSettings.delay : 0; }\n    // Default endDelay value should only be applied to the last tween\n    if (is.und(obj.endDelay)) { obj.endDelay = i === propArray.length - 1 ? tweenSettings.endDelay : 0; }\n    return obj;\n  }).map(function (k) { return mergeObjects(k, settings); });\n}\n\n\nfunction flattenKeyframes(keyframes) {\n  var propertyNames = filterArray(flattenArray(keyframes.map(function (key) { return Object.keys(key); })), function (p) { return is.key(p); })\n  .reduce(function (a,b) { if (a.indexOf(b) < 0) { a.push(b); } return a; }, []);\n  var properties = {};\n  var loop = function ( i ) {\n    var propName = propertyNames[i];\n    properties[propName] = keyframes.map(function (key) {\n      var newKey = {};\n      for (var p in key) {\n        if (is.key(p)) {\n          if (p == propName) { newKey.value = key[p]; }\n        } else {\n          newKey[p] = key[p];\n        }\n      }\n      return newKey;\n    });\n  };\n\n  for (var i = 0; i < propertyNames.length; i++) loop( i );\n  return properties;\n}\n\nfunction getProperties(tweenSettings, params) {\n  var properties = [];\n  var keyframes = params.keyframes;\n  if (keyframes) { params = mergeObjects(flattenKeyframes(keyframes), params); }\n  for (var p in params) {\n    if (is.key(p)) {\n      properties.push({\n        name: p,\n        tweens: normalizePropertyTweens(params[p], tweenSettings)\n      });\n    }\n  }\n  return properties;\n}\n\n// Tweens\n\nfunction normalizeTweenValues(tween, animatable) {\n  var t = {};\n  for (var p in tween) {\n    var value = getFunctionValue(tween[p], animatable);\n    if (is.arr(value)) {\n      value = value.map(function (v) { return getFunctionValue(v, animatable); });\n      if (value.length === 1) { value = value[0]; }\n    }\n    t[p] = value;\n  }\n  t.duration = parseFloat(t.duration);\n  t.delay = parseFloat(t.delay);\n  return t;\n}\n\nfunction normalizeTweens(prop, animatable) {\n  var previousTween;\n  return prop.tweens.map(function (t) {\n    var tween = normalizeTweenValues(t, animatable);\n    var tweenValue = tween.value;\n    var to = is.arr(tweenValue) ? tweenValue[1] : tweenValue;\n    var toUnit = getUnit(to);\n    var originalValue = getOriginalTargetValue(animatable.target, prop.name, toUnit, animatable);\n    var previousValue = previousTween ? previousTween.to.original : originalValue;\n    var from = is.arr(tweenValue) ? tweenValue[0] : previousValue;\n    var fromUnit = getUnit(from) || getUnit(originalValue);\n    var unit = toUnit || fromUnit;\n    if (is.und(to)) { to = previousValue; }\n    tween.from = decomposeValue(from, unit);\n    tween.to = decomposeValue(getRelativeValue(to, from), unit);\n    tween.start = previousTween ? previousTween.end : 0;\n    tween.end = tween.start + tween.delay + tween.duration + tween.endDelay;\n    tween.easing = parseEasings(tween.easing, tween.duration);\n    tween.isPath = is.pth(tweenValue);\n    tween.isPathTargetInsideSVG = tween.isPath && is.svg(animatable.target);\n    tween.isColor = is.col(tween.from.original);\n    if (tween.isColor) { tween.round = 1; }\n    previousTween = tween;\n    return tween;\n  });\n}\n\n// Tween progress\n\nvar setProgressValue = {\n  css: function (t, p, v) { return t.style[p] = v; },\n  attribute: function (t, p, v) { return t.setAttribute(p, v); },\n  object: function (t, p, v) { return t[p] = v; },\n  transform: function (t, p, v, transforms, manual) {\n    transforms.list.set(p, v);\n    if (p === transforms.last || manual) {\n      var str = '';\n      transforms.list.forEach(function (value, prop) { str += prop + \"(\" + value + \") \"; });\n      t.style.transform = str;\n    }\n  }\n};\n\n// Set Value helper\n\nfunction setTargetsValue(targets, properties) {\n  var animatables = getAnimatables(targets);\n  animatables.forEach(function (animatable) {\n    for (var property in properties) {\n      var value = getFunctionValue(properties[property], animatable);\n      var target = animatable.target;\n      var valueUnit = getUnit(value);\n      var originalValue = getOriginalTargetValue(target, property, valueUnit, animatable);\n      var unit = valueUnit || getUnit(originalValue);\n      var to = getRelativeValue(validateValue(value, unit), originalValue);\n      var animType = getAnimationType(target, property);\n      setProgressValue[animType](target, property, to, animatable.transforms, true);\n    }\n  });\n}\n\n// Animations\n\nfunction createAnimation(animatable, prop) {\n  var animType = getAnimationType(animatable.target, prop.name);\n  if (animType) {\n    var tweens = normalizeTweens(prop, animatable);\n    var lastTween = tweens[tweens.length - 1];\n    return {\n      type: animType,\n      property: prop.name,\n      animatable: animatable,\n      tweens: tweens,\n      duration: lastTween.end,\n      delay: tweens[0].delay,\n      endDelay: lastTween.endDelay\n    }\n  }\n}\n\nfunction getAnimations(animatables, properties) {\n  return filterArray(flattenArray(animatables.map(function (animatable) {\n    return properties.map(function (prop) {\n      return createAnimation(animatable, prop);\n    });\n  })), function (a) { return !is.und(a); });\n}\n\n// Create Instance\n\nfunction getInstanceTimings(animations, tweenSettings) {\n  var animLength = animations.length;\n  var getTlOffset = function (anim) { return anim.timelineOffset ? anim.timelineOffset : 0; };\n  var timings = {};\n  timings.duration = animLength ? Math.max.apply(Math, animations.map(function (anim) { return getTlOffset(anim) + anim.duration; })) : tweenSettings.duration;\n  timings.delay = animLength ? Math.min.apply(Math, animations.map(function (anim) { return getTlOffset(anim) + anim.delay; })) : tweenSettings.delay;\n  timings.endDelay = animLength ? timings.duration - Math.max.apply(Math, animations.map(function (anim) { return getTlOffset(anim) + anim.duration - anim.endDelay; })) : tweenSettings.endDelay;\n  return timings;\n}\n\nvar instanceID = 0;\n\nfunction createNewInstance(params) {\n  var instanceSettings = replaceObjectProps(defaultInstanceSettings, params);\n  var tweenSettings = replaceObjectProps(defaultTweenSettings, params);\n  var properties = getProperties(tweenSettings, params);\n  var animatables = getAnimatables(params.targets);\n  var animations = getAnimations(animatables, properties);\n  var timings = getInstanceTimings(animations, tweenSettings);\n  var id = instanceID;\n  instanceID++;\n  return mergeObjects(instanceSettings, {\n    id: id,\n    children: [],\n    animatables: animatables,\n    animations: animations,\n    duration: timings.duration,\n    delay: timings.delay,\n    endDelay: timings.endDelay\n  });\n}\n\n// Core\n\nvar activeInstances = [];\n\nvar engine = (function () {\n  var raf;\n\n  function play() {\n    if (!raf && (!isDocumentHidden() || !anime.suspendWhenDocumentHidden) && activeInstances.length > 0) {\n      raf = requestAnimationFrame(step);\n    }\n  }\n  function step(t) {\n    // memo on algorithm issue:\n    // dangerous iteration over mutable `activeInstances`\n    // (that collection may be updated from within callbacks of `tick`-ed animation instances)\n    var activeInstancesLength = activeInstances.length;\n    var i = 0;\n    while (i < activeInstancesLength) {\n      var activeInstance = activeInstances[i];\n      if (!activeInstance.paused) {\n        activeInstance.tick(t);\n        i++;\n      } else {\n        activeInstances.splice(i, 1);\n        activeInstancesLength--;\n      }\n    }\n    raf = i > 0 ? requestAnimationFrame(step) : undefined;\n  }\n\n  function handleVisibilityChange() {\n    if (!anime.suspendWhenDocumentHidden) { return; }\n\n    if (isDocumentHidden()) {\n      // suspend ticks\n      raf = cancelAnimationFrame(raf);\n    } else { // is back to active tab\n      // first adjust animations to consider the time that ticks were suspended\n      activeInstances.forEach(\n        function (instance) { return instance ._onDocumentVisibility(); }\n      );\n      engine();\n    }\n  }\n  if (typeof document !== 'undefined') {\n    document.addEventListener('visibilitychange', handleVisibilityChange);\n  }\n\n  return play;\n})();\n\nfunction isDocumentHidden() {\n  return !!document && document.hidden;\n}\n\n// Public Instance\n\nfunction anime(params) {\n  if ( params === void 0 ) params = {};\n\n\n  var startTime = 0, lastTime = 0, now = 0;\n  var children, childrenLength = 0;\n  var resolve = null;\n\n  function makePromise(instance) {\n    var promise = window.Promise && new Promise(function (_resolve) { return resolve = _resolve; });\n    instance.finished = promise;\n    return promise;\n  }\n\n  var instance = createNewInstance(params);\n  var promise = makePromise(instance);\n\n  function toggleInstanceDirection() {\n    var direction = instance.direction;\n    if (direction !== 'alternate') {\n      instance.direction = direction !== 'normal' ? 'normal' : 'reverse';\n    }\n    instance.reversed = !instance.reversed;\n    children.forEach(function (child) { return child.reversed = instance.reversed; });\n  }\n\n  function adjustTime(time) {\n    return instance.reversed ? instance.duration - time : time;\n  }\n\n  function resetTime() {\n    startTime = 0;\n    lastTime = adjustTime(instance.currentTime) * (1 / anime.speed);\n  }\n\n  function seekChild(time, child) {\n    if (child) { child.seek(time - child.timelineOffset); }\n  }\n\n  function syncInstanceChildren(time) {\n    if (!instance.reversePlayback) {\n      for (var i = 0; i < childrenLength; i++) { seekChild(time, children[i]); }\n    } else {\n      for (var i$1 = childrenLength; i$1--;) { seekChild(time, children[i$1]); }\n    }\n  }\n\n  function setAnimationsProgress(insTime) {\n    var i = 0;\n    var animations = instance.animations;\n    var animationsLength = animations.length;\n    while (i < animationsLength) {\n      var anim = animations[i];\n      var animatable = anim.animatable;\n      var tweens = anim.tweens;\n      var tweenLength = tweens.length - 1;\n      var tween = tweens[tweenLength];\n      // Only check for keyframes if there is more than one tween\n      if (tweenLength) { tween = filterArray(tweens, function (t) { return (insTime < t.end); })[0] || tween; }\n      var elapsed = minMax(insTime - tween.start - tween.delay, 0, tween.duration) / tween.duration;\n      var eased = isNaN(elapsed) ? 1 : tween.easing(elapsed);\n      var strings = tween.to.strings;\n      var round = tween.round;\n      var numbers = [];\n      var toNumbersLength = tween.to.numbers.length;\n      var progress = (void 0);\n      for (var n = 0; n < toNumbersLength; n++) {\n        var value = (void 0);\n        var toNumber = tween.to.numbers[n];\n        var fromNumber = tween.from.numbers[n] || 0;\n        if (!tween.isPath) {\n          value = fromNumber + (eased * (toNumber - fromNumber));\n        } else {\n          value = getPathProgress(tween.value, eased * toNumber, tween.isPathTargetInsideSVG);\n        }\n        if (round) {\n          if (!(tween.isColor && n > 2)) {\n            value = Math.round(value * round) / round;\n          }\n        }\n        numbers.push(value);\n      }\n      // Manual Array.reduce for better performances\n      var stringsLength = strings.length;\n      if (!stringsLength) {\n        progress = numbers[0];\n      } else {\n        progress = strings[0];\n        for (var s = 0; s < stringsLength; s++) {\n          var a = strings[s];\n          var b = strings[s + 1];\n          var n$1 = numbers[s];\n          if (!isNaN(n$1)) {\n            if (!b) {\n              progress += n$1 + ' ';\n            } else {\n              progress += n$1 + b;\n            }\n          }\n        }\n      }\n      setProgressValue[anim.type](animatable.target, anim.property, progress, animatable.transforms);\n      anim.currentValue = progress;\n      i++;\n    }\n  }\n\n  function setCallback(cb) {\n    if (instance[cb] && !instance.passThrough) { instance[cb](instance); }\n  }\n\n  function countIteration() {\n    if (instance.remaining && instance.remaining !== true) {\n      instance.remaining--;\n    }\n  }\n\n  function setInstanceProgress(engineTime) {\n    var insDuration = instance.duration;\n    var insDelay = instance.delay;\n    var insEndDelay = insDuration - instance.endDelay;\n    var insTime = adjustTime(engineTime);\n    instance.progress = minMax((insTime / insDuration) * 100, 0, 100);\n    instance.reversePlayback = insTime < instance.currentTime;\n    if (children) { syncInstanceChildren(insTime); }\n    if (!instance.began && instance.currentTime > 0) {\n      instance.began = true;\n      setCallback('begin');\n    }\n    if (!instance.loopBegan && instance.currentTime > 0) {\n      instance.loopBegan = true;\n      setCallback('loopBegin');\n    }\n    if (insTime <= insDelay && instance.currentTime !== 0) {\n      setAnimationsProgress(0);\n    }\n    if ((insTime >= insEndDelay && instance.currentTime !== insDuration) || !insDuration) {\n      setAnimationsProgress(insDuration);\n    }\n    if (insTime > insDelay && insTime < insEndDelay) {\n      if (!instance.changeBegan) {\n        instance.changeBegan = true;\n        instance.changeCompleted = false;\n        setCallback('changeBegin');\n      }\n      setCallback('change');\n      setAnimationsProgress(insTime);\n    } else {\n      if (instance.changeBegan) {\n        instance.changeCompleted = true;\n        instance.changeBegan = false;\n        setCallback('changeComplete');\n      }\n    }\n    instance.currentTime = minMax(insTime, 0, insDuration);\n    if (instance.began) { setCallback('update'); }\n    if (engineTime >= insDuration) {\n      lastTime = 0;\n      countIteration();\n      if (!instance.remaining) {\n        instance.paused = true;\n        if (!instance.completed) {\n          instance.completed = true;\n          setCallback('loopComplete');\n          setCallback('complete');\n          if (!instance.passThrough && 'Promise' in window) {\n            resolve();\n            promise = makePromise(instance);\n          }\n        }\n      } else {\n        startTime = now;\n        setCallback('loopComplete');\n        instance.loopBegan = false;\n        if (instance.direction === 'alternate') {\n          toggleInstanceDirection();\n        }\n      }\n    }\n  }\n\n  instance.reset = function() {\n    var direction = instance.direction;\n    instance.passThrough = false;\n    instance.currentTime = 0;\n    instance.progress = 0;\n    instance.paused = true;\n    instance.began = false;\n    instance.loopBegan = false;\n    instance.changeBegan = false;\n    instance.completed = false;\n    instance.changeCompleted = false;\n    instance.reversePlayback = false;\n    instance.reversed = direction === 'reverse';\n    instance.remaining = instance.loop;\n    children = instance.children;\n    childrenLength = children.length;\n    for (var i = childrenLength; i--;) { instance.children[i].reset(); }\n    if (instance.reversed && instance.loop !== true || (direction === 'alternate' && instance.loop === 1)) { instance.remaining++; }\n    setAnimationsProgress(instance.reversed ? instance.duration : 0);\n  };\n\n  // internal method (for engine) to adjust animation timings before restoring engine ticks (rAF)\n  instance._onDocumentVisibility = resetTime;\n\n  // Set Value helper\n\n  instance.set = function(targets, properties) {\n    setTargetsValue(targets, properties);\n    return instance;\n  };\n\n  instance.tick = function(t) {\n    now = t;\n    if (!startTime) { startTime = now; }\n    setInstanceProgress((now + (lastTime - startTime)) * anime.speed);\n  };\n\n  instance.seek = function(time) {\n    setInstanceProgress(adjustTime(time));\n  };\n\n  instance.pause = function() {\n    instance.paused = true;\n    resetTime();\n  };\n\n  instance.play = function() {\n    if (!instance.paused) { return; }\n    if (instance.completed) { instance.reset(); }\n    instance.paused = false;\n    activeInstances.push(instance);\n    resetTime();\n    engine();\n  };\n\n  instance.reverse = function() {\n    toggleInstanceDirection();\n    instance.completed = instance.reversed ? false : true;\n    resetTime();\n  };\n\n  instance.restart = function() {\n    instance.reset();\n    instance.play();\n  };\n\n  instance.remove = function(targets) {\n    var targetsArray = parseTargets(targets);\n    removeTargetsFromInstance(targetsArray, instance);\n  };\n\n  instance.reset();\n\n  if (instance.autoplay) { instance.play(); }\n\n  return instance;\n\n}\n\n// Remove targets from animation\n\nfunction removeTargetsFromAnimations(targetsArray, animations) {\n  for (var a = animations.length; a--;) {\n    if (arrayContains(targetsArray, animations[a].animatable.target)) {\n      animations.splice(a, 1);\n    }\n  }\n}\n\nfunction removeTargetsFromInstance(targetsArray, instance) {\n  var animations = instance.animations;\n  var children = instance.children;\n  removeTargetsFromAnimations(targetsArray, animations);\n  for (var c = children.length; c--;) {\n    var child = children[c];\n    var childAnimations = child.animations;\n    removeTargetsFromAnimations(targetsArray, childAnimations);\n    if (!childAnimations.length && !child.children.length) { children.splice(c, 1); }\n  }\n  if (!animations.length && !children.length) { instance.pause(); }\n}\n\nfunction removeTargetsFromActiveInstances(targets) {\n  var targetsArray = parseTargets(targets);\n  for (var i = activeInstances.length; i--;) {\n    var instance = activeInstances[i];\n    removeTargetsFromInstance(targetsArray, instance);\n  }\n}\n\n// Stagger helpers\n\nfunction stagger(val, params) {\n  if ( params === void 0 ) params = {};\n\n  var direction = params.direction || 'normal';\n  var easing = params.easing ? parseEasings(params.easing) : null;\n  var grid = params.grid;\n  var axis = params.axis;\n  var fromIndex = params.from || 0;\n  var fromFirst = fromIndex === 'first';\n  var fromCenter = fromIndex === 'center';\n  var fromLast = fromIndex === 'last';\n  var isRange = is.arr(val);\n  var val1 = isRange ? parseFloat(val[0]) : parseFloat(val);\n  var val2 = isRange ? parseFloat(val[1]) : 0;\n  var unit = getUnit(isRange ? val[1] : val) || 0;\n  var start = params.start || 0 + (isRange ? val1 : 0);\n  var values = [];\n  var maxValue = 0;\n  return function (el, i, t) {\n    if (fromFirst) { fromIndex = 0; }\n    if (fromCenter) { fromIndex = (t - 1) / 2; }\n    if (fromLast) { fromIndex = t - 1; }\n    if (!values.length) {\n      for (var index = 0; index < t; index++) {\n        if (!grid) {\n          values.push(Math.abs(fromIndex - index));\n        } else {\n          var fromX = !fromCenter ? fromIndex%grid[0] : (grid[0]-1)/2;\n          var fromY = !fromCenter ? Math.floor(fromIndex/grid[0]) : (grid[1]-1)/2;\n          var toX = index%grid[0];\n          var toY = Math.floor(index/grid[0]);\n          var distanceX = fromX - toX;\n          var distanceY = fromY - toY;\n          var value = Math.sqrt(distanceX * distanceX + distanceY * distanceY);\n          if (axis === 'x') { value = -distanceX; }\n          if (axis === 'y') { value = -distanceY; }\n          values.push(value);\n        }\n        maxValue = Math.max.apply(Math, values);\n      }\n      if (easing) { values = values.map(function (val) { return easing(val / maxValue) * maxValue; }); }\n      if (direction === 'reverse') { values = values.map(function (val) { return axis ? (val < 0) ? val * -1 : -val : Math.abs(maxValue - val); }); }\n    }\n    var spacing = isRange ? (val2 - val1) / maxValue : val1;\n    return start + (spacing * (Math.round(values[i] * 100) / 100)) + unit;\n  }\n}\n\n// Timeline\n\nfunction timeline(params) {\n  if ( params === void 0 ) params = {};\n\n  var tl = anime(params);\n  tl.duration = 0;\n  tl.add = function(instanceParams, timelineOffset) {\n    var tlIndex = activeInstances.indexOf(tl);\n    var children = tl.children;\n    if (tlIndex > -1) { activeInstances.splice(tlIndex, 1); }\n    function passThrough(ins) { ins.passThrough = true; }\n    for (var i = 0; i < children.length; i++) { passThrough(children[i]); }\n    var insParams = mergeObjects(instanceParams, replaceObjectProps(defaultTweenSettings, params));\n    insParams.targets = insParams.targets || params.targets;\n    var tlDuration = tl.duration;\n    insParams.autoplay = false;\n    insParams.direction = tl.direction;\n    insParams.timelineOffset = is.und(timelineOffset) ? tlDuration : getRelativeValue(timelineOffset, tlDuration);\n    passThrough(tl);\n    tl.seek(insParams.timelineOffset);\n    var ins = anime(insParams);\n    passThrough(ins);\n    children.push(ins);\n    var timings = getInstanceTimings(children, params);\n    tl.delay = timings.delay;\n    tl.endDelay = timings.endDelay;\n    tl.duration = timings.duration;\n    tl.seek(0);\n    tl.reset();\n    if (tl.autoplay) { tl.play(); }\n    return tl;\n  };\n  return tl;\n}\n\nanime.version = '3.2.1';\nanime.speed = 1;\n// TODO:#review: naming, documentation\nanime.suspendWhenDocumentHidden = true;\nanime.running = activeInstances;\nanime.remove = removeTargetsFromActiveInstances;\nanime.get = getOriginalTargetValue;\nanime.set = setTargetsValue;\nanime.convertPx = convertPxToUnit;\nanime.path = getPath;\nanime.setDashoffset = setDashoffset;\nanime.stagger = stagger;\nanime.timeline = timeline;\nanime.easing = parseEasings;\nanime.penner = penner;\nanime.random = function (min, max) { return Math.floor(Math.random() * (max - min + 1)) + min; };\n\nexport default anime;\n","import { toggleMachine } from \"./scripts/state\"\nimport { interpret } from \"xstate\"\n\n//Anime\nimport anime from \"animejs/lib/anime.es.js\"\n\n// Vars\nconst button: HTMLElement = document.querySelector('#addNote')\nconst toggleService = interpret(toggleMachine)\n\nconst toggle = () => {\n    button.addEventListener('click', () => {\n        toggleService.send('TOGGLE');\n    })\n}\n\nconst buttonDisabled = (btnStatus : boolean) => {\n    if(btnStatus) {\n        button.setAttribute('disabled', '')\n    } else {\n        button.removeAttribute('disabled')\n    }\n}\n\nconst animate = (status: any) => {\n    const tl = anime.timeline()\n    if(status === 'active') {\n        buttonDisabled(true);\n        tl.add({\n            targets: button,\n            translateY: [0,-12,0],\n            scale: [1,.85,1],\n            rotate: 316,\n            duration: 600,\n            easing: \"easeInOutSine\"\n        }).add({\n            targets: '.note-selectors .first',\n            translateY: [0, 80],\n            duration: 3200,\n            scaleY: [1.8, 1],\n            },\n            '-=400'\n        ).add({\n            targets: '.note-selectors .other',\n            translateY: function(el){\n                return [el.getAttribute('data-from'), el.getAttribute('data-to')]\n            },\n            duration: 1600,\n            scaleY: [0, 1],\n            opacity: {\n                value: 1,\n                duration: 10,\n            },\n            delay: anime.stagger(240), \n            complete: function(){\n                buttonDisabled(false);\n            }\n            },\n        '-=2600'\n        );\n    } else if (status === 'inactive') {\n        buttonDisabled(true);\n        tl.add({\n            targets: button,\n            rotate: 0,\n            duration: 600,\n            easing: 'easeInOutSine'\n        }).add({\n            targets: '.note-selectors .selector',\n            translateY: function (el) {\n                return [el.getAttribute('data-to'), 0]\n            },\n            duration: 400,\n            delay: anime.stagger(60),\n            easing: \"easeInOutSine\",\n        },\n        '-=400'\n        )\n    }\n}\n\nconst init = () => {\n    toggleService.onTransition((state) =>{\n        console.log(state.value)\n        animate(state.value);\n    }).start();\n    toggle();\n}\n\ninit();","var OVERLAY_ID = '__parcel__error__overlay__';\n\nvar OldModule = module.bundle.Module;\n\nfunction Module(moduleName) {\n  OldModule.call(this, moduleName);\n  this.hot = {\n    data: module.bundle.hotData,\n    _acceptCallbacks: [],\n    _disposeCallbacks: [],\n    accept: function (fn) {\n      this._acceptCallbacks.push(fn || function () {});\n    },\n    dispose: function (fn) {\n      this._disposeCallbacks.push(fn);\n    }\n  };\n\n  module.bundle.hotData = null;\n}\n\nmodule.bundle.Module = Module;\nvar checkedAssets, assetsToAccept;\n\nvar parent = module.bundle.parent;\nif ((!parent || !parent.isParcelRequire) && typeof WebSocket !== 'undefined') {\n  var hostname = process.env.HMR_HOSTNAME || location.hostname;\n  var protocol = location.protocol === 'https:' ? 'wss' : 'ws';\n  var ws = new WebSocket(protocol + '://' + hostname + ':' + process.env.HMR_PORT + '/');\n  ws.onmessage = function(event) {\n    checkedAssets = {};\n    assetsToAccept = [];\n\n    var data = JSON.parse(event.data);\n\n    if (data.type === 'update') {\n      var handled = false;\n      data.assets.forEach(function(asset) {\n        if (!asset.isNew) {\n          var didAccept = hmrAcceptCheck(global.parcelRequire, asset.id);\n          if (didAccept) {\n            handled = true;\n          }\n        }\n      });\n\n      // Enable HMR for CSS by default.\n      handled = handled || data.assets.every(function(asset) {\n        return asset.type === 'css' && asset.generated.js;\n      });\n\n      if (handled) {\n        console.clear();\n\n        data.assets.forEach(function (asset) {\n          hmrApply(global.parcelRequire, asset);\n        });\n\n        assetsToAccept.forEach(function (v) {\n          hmrAcceptRun(v[0], v[1]);\n        });\n      } else if (location.reload) { // `location` global exists in a web worker context but lacks `.reload()` function.\n        location.reload();\n      }\n    }\n\n    if (data.type === 'reload') {\n      ws.close();\n      ws.onclose = function () {\n        location.reload();\n      }\n    }\n\n    if (data.type === 'error-resolved') {\n      console.log('[parcel]  Error resolved');\n\n      removeErrorOverlay();\n    }\n\n    if (data.type === 'error') {\n      console.error('[parcel]   ' + data.error.message + '\\n' + data.error.stack);\n\n      removeErrorOverlay();\n\n      var overlay = createErrorOverlay(data);\n      document.body.appendChild(overlay);\n    }\n  };\n}\n\nfunction removeErrorOverlay() {\n  var overlay = document.getElementById(OVERLAY_ID);\n  if (overlay) {\n    overlay.remove();\n  }\n}\n\nfunction createErrorOverlay(data) {\n  var overlay = document.createElement('div');\n  overlay.id = OVERLAY_ID;\n\n  // html encode message and stack trace\n  var message = document.createElement('div');\n  var stackTrace = document.createElement('pre');\n  message.innerText = data.error.message;\n  stackTrace.innerText = data.error.stack;\n\n  overlay.innerHTML = (\n    '<div style=\"background: black; font-size: 16px; color: white; position: fixed; height: 100%; width: 100%; top: 0px; left: 0px; padding: 30px; opacity: 0.85; font-family: Menlo, Consolas, monospace; z-index: 9999;\">' +\n      '<span style=\"background: red; padding: 2px 4px; border-radius: 2px;\">ERROR</span>' +\n      '<span style=\"top: 2px; margin-left: 5px; position: relative;\"></span>' +\n      '<div style=\"font-size: 18px; font-weight: bold; margin-top: 20px;\">' + message.innerHTML + '</div>' +\n      '<pre>' + stackTrace.innerHTML + '</pre>' +\n    '</div>'\n  );\n\n  return overlay;\n\n}\n\nfunction getParents(bundle, id) {\n  var modules = bundle.modules;\n  if (!modules) {\n    return [];\n  }\n\n  var parents = [];\n  var k, d, dep;\n\n  for (k in modules) {\n    for (d in modules[k][1]) {\n      dep = modules[k][1][d];\n      if (dep === id || (Array.isArray(dep) && dep[dep.length - 1] === id)) {\n        parents.push(k);\n      }\n    }\n  }\n\n  if (bundle.parent) {\n    parents = parents.concat(getParents(bundle.parent, id));\n  }\n\n  return parents;\n}\n\nfunction hmrApply(bundle, asset) {\n  var modules = bundle.modules;\n  if (!modules) {\n    return;\n  }\n\n  if (modules[asset.id] || !bundle.parent) {\n    var fn = new Function('require', 'module', 'exports', asset.generated.js);\n    asset.isNew = !modules[asset.id];\n    modules[asset.id] = [fn, asset.deps];\n  } else if (bundle.parent) {\n    hmrApply(bundle.parent, asset);\n  }\n}\n\nfunction hmrAcceptCheck(bundle, id) {\n  var modules = bundle.modules;\n  if (!modules) {\n    return;\n  }\n\n  if (!modules[id] && bundle.parent) {\n    return hmrAcceptCheck(bundle.parent, id);\n  }\n\n  if (checkedAssets[id]) {\n    return;\n  }\n  checkedAssets[id] = true;\n\n  var cached = bundle.cache[id];\n\n  assetsToAccept.push([bundle, id]);\n\n  if (cached && cached.hot && cached.hot._acceptCallbacks.length) {\n    return true;\n  }\n\n  return getParents(global.parcelRequire, id).some(function (id) {\n    return hmrAcceptCheck(global.parcelRequire, id)\n  });\n}\n\nfunction hmrAcceptRun(bundle, id) {\n  var cached = bundle.cache[id];\n  bundle.hotData = {};\n  if (cached) {\n    cached.hot.data = bundle.hotData;\n  }\n\n  if (cached && cached.hot && cached.hot._disposeCallbacks.length) {\n    cached.hot._disposeCallbacks.forEach(function (cb) {\n      cb(bundle.hotData);\n    });\n  }\n\n  delete bundle.cache[id];\n  bundle(id);\n\n  cached = bundle.cache[id];\n  if (cached && cached.hot && cached.hot._acceptCallbacks.length) {\n    cached.hot._acceptCallbacks.forEach(function (cb) {\n      cb();\n    });\n    return true;\n  }\n}\n"]}